<div class="detail_content markdown-body editormd-preview-container" id="markdown-body">
<div id="app">
<h2 data-content="1" id="76dd5e6d3a328ab8f994b7f711b5c0f9">前言</h2>
<p>最近在尝试冲刺排名，恰好本次渗透中的东西可以拿来做一些分享，希望可以给大家提供一些思路，有什么不对不足的地方，希望各位师傅斧正，本文所涉及的漏洞均已提交至src平台</p>
<h2 data-content="1" id="ccf217334743851494b2bfc190ef1f7b">正文</h2>
<h3 data-content="1" id="fe7c87d7d5f61b905452e1464925c422">0x01 任意用户注册</h3>
<p>像这种注册页面没有验证码的，果断抓包尝试无限绑定任意电话号码和邮箱注册<br/>
<img src="https://cdn.nlark.com/yuque/0/2022/png/26950290/1656207247728-d3d1f28d-cf86-4270-89bc-e243f1a01846.png#clientId=u12189e17-1e42-4&amp;crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;from=paste&amp;height=545&amp;id=ubd6ea04f&amp;margin=%5Bobject%20Object%5D&amp;name=image.png&amp;originHeight=681&amp;originWidth=688&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=23473&amp;status=done&amp;style=none&amp;taskId=uad4c440b-eb55-4534-bfea-bdb549140d3&amp;title=&amp;width=550.4"/><br/>
<img src="https://cdn.nlark.com/yuque/0/2022/png/26950290/1656207442200-3d2f2c6c-a598-4a14-88f7-5701023fc66e.png#clientId=u12189e17-1e42-4&amp;crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;from=paste&amp;height=326&amp;id=uec420f8c&amp;margin=%5Bobject%20Object%5D&amp;name=image.png&amp;originHeight=408&amp;originWidth=921&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=319128&amp;status=done&amp;style=none&amp;taskId=uce158af5-1ee5-43bc-9968-93c63bcfd23&amp;title=&amp;width=736.8"/><br/>
<img src="https://cdn.nlark.com/yuque/0/2022/png/26950290/1656228063079-e5185d5f-be93-42d1-bfd8-0cd26d1d813d.png#clientId=u2851d9d9-9615-4&amp;crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;from=paste&amp;height=82&amp;id=u7e4676c9&amp;margin=%5Bobject%20Object%5D&amp;name=image.png&amp;originHeight=103&amp;originWidth=280&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=19291&amp;status=done&amp;style=none&amp;taskId=u44e94989-83f9-4af7-a217-9bc76fdb2ca&amp;title=&amp;width=224"/><img src="https://cdn.nlark.com/yuque/0/2022/png/26950290/1656228078759-2920739d-782c-4c0c-a0cb-1bf0af7e3913.png#clientId=u2851d9d9-9615-4&amp;crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;from=paste&amp;height=76&amp;id=u3cf8dc88&amp;margin=%5Bobject%20Object%5D&amp;name=image.png&amp;originHeight=95&amp;originWidth=279&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=19253&amp;status=done&amp;style=none&amp;taskId=u220d15ce-0562-43f2-bd25-dbaf84ebd4a&amp;title=&amp;width=223.2"/><br/>
验证之后成功注册并登录两个账户，果然可以批量注册，登陆，送上手的低危成功吃到</p>
<h3 data-content="1" id="47584295d3738cab48c818859929248e">0x02 任意用户密码重置</h3>
<p>登陆账户，进入修改资料界面，仔细观察，修改密码居然不用填旧密码？<br/>
<img src="https://cdn.nlark.com/yuque/0/2022/png/26950290/1656208126821-86afa88a-c7f9-4d82-bf4d-144db2dd007e.png#clientId=uff8cd7c6-a609-4&amp;crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;from=paste&amp;height=278&amp;id=u58bd5969&amp;margin=%5Bobject%20Object%5D&amp;name=image.png&amp;originHeight=347&amp;originWidth=357&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=38639&amp;status=done&amp;style=none&amp;taskId=u66e009d5-9843-4e3a-b6e0-7d2e7de411c&amp;title=&amp;width=285.6"/><br/>
果断抓包，这里的逻辑是用自己的用户名找回密码，在最后修改密码的时候抓包，改成其他用户名<br/>
<img src="https://cdn.nlark.com/yuque/0/2022/png/26950290/1656208300854-53b07d2e-9a32-4638-8cd5-c3263cae1eb8.png#clientId=u6e15877f-de72-4&amp;crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;from=paste&amp;height=393&amp;id=u61cff4b1&amp;margin=%5Bobject%20Object%5D&amp;name=image.png&amp;originHeight=491&amp;originWidth=931&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=226287&amp;status=done&amp;style=none&amp;taskId=u1793b3d4-5c5a-44f3-8e9f-1e48af8e7ad&amp;title=&amp;width=744.8"/><br/>
<img src="https://cdn.nlark.com/yuque/0/2022/png/26950290/1656226464900-d5ce25eb-46bd-4252-8648-31139606799f.png#clientId=u74c9a9d5-1b3b-4&amp;crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;from=paste&amp;height=360&amp;id=u2fc9dd06&amp;margin=%5Bobject%20Object%5D&amp;name=image.png&amp;originHeight=450&amp;originWidth=486&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=51999&amp;status=done&amp;style=none&amp;taskId=ude6be497-2e8f-4fdd-adfa-5b3d9f56495&amp;title=&amp;width=388.8"/><br/>
验证一下，成功更改另一用户密码登录，ok，又是一个低危+，(其实可以看到这里第一个和第二个漏洞都不难，因为是业务逻辑类型，这类型的漏洞其实只要我们细心，就一定能挖到的)</p>
<h3 data-content="1" id="c35bd7f2d969cd1367d25a4cdc2f41e7">0x03 水平越权+存储xss组合拳</h3>
<p>上面在找到任意密码重置后，便可以发现这个页面存在非常简单的越权漏洞，原理同上，他的逻辑是通过username参数来查询更改后端的数据。但是既然已经找到任意密码重置了，单单一个水平越权确实没什么看点了，但是没关系，虽然咱们菜，但是咱们能坚持，够细心<br/>
继续对资料修改处进行测试，发现下面有一自我介绍处，自我介绍这个功能一般来说长度和特殊字符限制比较少，因为这属于业务需要，所以测试的时候遇到了就不能忽略，<br/>
<img src="https://cdn.nlark.com/yuque/0/2022/png/26950290/1656209093691-96abf941-549a-427e-8a67-c6e359edb07b.png#clientId=u6e15877f-de72-4&amp;crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;from=paste&amp;height=409&amp;id=uff06d3a9&amp;margin=%5Bobject%20Object%5D&amp;name=image.png&amp;originHeight=511&amp;originWidth=981&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=49443&amp;status=done&amp;style=none&amp;taskId=u41f7940d-b4b3-4ea0-a2d5-418b799efe0&amp;title=&amp;width=784.8"/><br/>
果然这里有一存储型xss漏洞，抓包改payload，然后登陆另一账户进入修改资料页面验证成功<br/>
<img src="https://cdn.nlark.com/yuque/0/2022/png/26950290/1656209669433-135e6bb2-4ee4-4382-8268-2c1fe6055022.png#clientId=u251a7089-6781-4&amp;crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;from=paste&amp;height=318&amp;id=uac1ea524&amp;margin=%5Bobject%20Object%5D&amp;name=image.png&amp;originHeight=398&amp;originWidth=891&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=212205&amp;status=done&amp;style=none&amp;taskId=u49b78fa3-c903-4283-b94d-444b1e975db&amp;title=&amp;width=712.8"/><br/>
<img src="https://cdn.nlark.com/yuque/0/2022/png/26950290/1656210662501-110be627-36c8-4cbb-95d0-91a260066013.png#clientId=ud8d1f3f7-1bbf-4&amp;crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;from=paste&amp;height=81&amp;id=ub2edda28&amp;margin=%5Bobject%20Object%5D&amp;name=image.png&amp;originHeight=101&amp;originWidth=458&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=8785&amp;status=done&amp;style=none&amp;taskId=u89597f0d-8e4e-42e6-a8c3-335a62c39bb&amp;title=&amp;width=366.4"/><br/>
备注:其实这里也可以用存储型+csrf组合拳哦，不过我个人认为越权+存储型更实用(当然要是用img标签打csrf也很实用啦)</p>
<h3 data-content="1" id="7583d41c56c687c5032c50337aa64878">0x04 sql注入</h3>
<p>问题出该网站一信息查看处，看到url处存在?id=1<br/>
<img src="https://cdn.nlark.com/yuque/0/2022/png/26950290/1656212869681-6bd803f8-1ba3-446c-b994-a822ff8a2063.png#clientId=u8f5acd2b-8a62-4&amp;crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;from=paste&amp;height=42&amp;id=uec627e5b&amp;margin=%5Bobject%20Object%5D&amp;name=image.png&amp;originHeight=52&amp;originWidth=401&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=6282&amp;status=done&amp;style=none&amp;taskId=u333e6373-d39b-4358-a630-018971ac3e2&amp;title=&amp;width=320.8"/><br/>
多用几个payload找到更多信息，<br/>
首先是发现存在waf，<br/>
payload1:<code>www.xxx.com/xxx/?id=1+and+select</code><br/>
<img src="https://cdn.nlark.com/yuque/0/2022/png/26950290/1656213017908-78773e16-cb38-41e6-8e33-7f117998edcf.png#clientId=u8f5acd2b-8a62-4&amp;crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;from=paste&amp;height=57&amp;id=ikque&amp;margin=%5Bobject%20Object%5D&amp;name=image.png&amp;originHeight=71&amp;originWidth=302&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=3275&amp;status=done&amp;style=none&amp;taskId=u0f9652c8-bc0e-4690-8ddf-b58f204f159&amp;title=&amp;width=241.6"/><br/>
然后是存在报错信息，<br/>
payload2:<code>www.xxx.com/xxx/?id=abcd</code><br/>
虽然access数据库不支持报错注入，但是后面我们会利用是否报错来进行一个盲注<br/>
<img src="https://cdn.nlark.com/yuque/0/2022/png/26950290/1656227115056-133bab73-547b-4eaf-a383-4ac494c480ef.png#clientId=u74c9a9d5-1b3b-4&amp;crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;from=paste&amp;height=59&amp;id=u2443e24e&amp;margin=%5Bobject%20Object%5D&amp;name=image.png&amp;originHeight=74&amp;originWidth=384&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=5204&amp;status=done&amp;style=none&amp;taskId=ua4521876-bbf9-487b-92dc-134ce78d491&amp;title=&amp;width=307.2"/><br/>
于是手注一直尝试，找到了他这里的语句结构，非常难受，access数据库除了不能报错，也不能利用注释，但是别放弃,<br/>
payload3:<code>www.xxx.com/xxx/?id=1+and+exists(</code><br/>
<img src="https://cdn.nlark.com/yuque/0/2022/png/26950290/1656227349276-3af669e0-2df0-48c4-a05a-ff4be45fe64a.png#clientId=u74c9a9d5-1b3b-4&amp;crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;from=paste&amp;height=62&amp;id=u96734cd6&amp;margin=%5Bobject%20Object%5D&amp;name=image.png&amp;originHeight=77&amp;originWidth=847&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=10710&amp;status=done&amp;style=none&amp;taskId=uf90a3bc0-28bc-4dbf-9563-68f7af46d7f&amp;title=&amp;width=677.6"/><br/>
基于此语句结构去构造payload，虽然有waf但是可以绕过，具体绕过手法我想在后面的文章做详细汇总<br/>
这里说一下其中有一个逻辑，select后面不能直接跟任何占位空字符(%0d,%0a,%0c,%20,' ')，这个应该是他在后端自己又加的正则，用select(xxx)可以绕过这个逻辑<br/>
最终的payload:<code>www.xxx.com/xxx/?id=1+and+exists(查询数据的语句)</code><br/>
绕过waf后可以通过盲注暴力猜解数据,可以看到admin表不存在，会给到错误信息回显，而另一个表是存在的，则正常回显<br/>
<img src="https://cdn.nlark.com/yuque/0/2022/png/26950290/1656227874677-1a29f342-5051-4012-ae74-473e0cb4223c.png#clientId=u74c9a9d5-1b3b-4&amp;crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;from=paste&amp;height=486&amp;id=u13186980&amp;margin=%5Bobject%20Object%5D&amp;name=image.png&amp;originHeight=608&amp;originWidth=1479&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=46892&amp;status=done&amp;style=none&amp;taskId=ub9a87da0-c30b-4305-8885-b02d2d2ff72&amp;title=&amp;width=1183.2"/><br/>
<img src="https://cdn.nlark.com/yuque/0/2022/png/26950290/1656227783053-f7fd41a9-c2f9-4c58-99a8-7afcea9dffbb.png#clientId=u74c9a9d5-1b3b-4&amp;crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;from=paste&amp;height=622&amp;id=u87a85431&amp;margin=%5Bobject%20Object%5D&amp;name=image.png&amp;originHeight=777&amp;originWidth=1603&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=58997&amp;status=done&amp;style=none&amp;taskId=u0546f0c6-dea2-463e-a858-f4102903924&amp;title=&amp;width=1282.4"/></p>
<p>成功猜解出一表名，点到为止，拿下高危</p>
<h2 data-content="1" id="fa9273d414e4fd6bd5035d0af34bc7a8">结语</h2>
<p>最后分享自己的一个心得体会，如果想从基础慢慢进阶，那么一定不要着急，细心的去解决每一个问题，一定不要轻易放弃，有个大佬跟我说过，学习网络安全，一定要有自信，一定要坚持，我可能今天不会这个东西，但是我不可能永远都学不会。</p>
</div>
</div>