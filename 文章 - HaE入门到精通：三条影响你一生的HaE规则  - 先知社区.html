<div class="detail_content markdown-body editormd-preview-container" id="markdown-body">
<div id="app">
<h1 data-content="1" id="df2c6e78221cbc7ffbc552ddd88ab32b">0# 概述</h1>
<p>最近一段时间项目也比较多，再加上最近还在维护开源项目，所以挺忙的。<br/>
乘着国庆时间，好好放松一下，顺便借着国庆期间更新一下自己许久未更新的博客哈哈~<br/>
本篇文章，我们将深入学习著名BurpSuite工具的插件 <code>HaE</code> 的使用和拓展，希望这三条影响你一生的HaE规则能给你带来帮助~</p>
<p><img src="https://xzfile.aliyuncs.com/media/upload/picture/20240213091324-15b792ec-ca0d-1.jpg"/></p>
<p>在此，祝各位师傅们国庆节快乐！！！为国之安全而奋斗，为信息安全而发声！</p>
<h1 data-content="1" id="8aae0d5822931e1797c901ad428fb137">1# HaE介绍</h1>
<p><code>HaE</code> 是基于 BurpSuite Java插件API 开发的请求高亮标记与信息提取的辅助型框架式插件，该插件可以通过自定义正则的方式匹配响应报文或请求报文，并对满足正则匹配的报文进行信息高亮与提取。</p>
<p>现代化Web应用走上前后端分离开发模式，这就导致在日常测试时候会有许多的流量，如果你想要尽可能全面的对一个Web应用进行测试评估，将花费大量精力浪费在无用的报文上；HaE的出现正是为了解决这一类似场景，借助HaE你可以有效的减少测试的时间，将更多的精力放在有价值、有意义的报文上，提高漏洞挖掘效率。</p>
<p>开源地址：<a href="https://github.com/gh0stkey/HaE" target="_blank">https://github.com/gh0stkey/HaE</a></p>
<h2 data-content="1" id="8f30d7700d8e7cfd9767adf648d8bf3e">1.1# 如何装载HaE？</h2>
<p>首先，先访问Github开源项目地址，下载打包好的Release</p>
<p><img src="https://xzfile.aliyuncs.com/media/upload/picture/20240213091357-29547ec8-ca0d-1.jpg"/></p>
<p>然后打开BurpSuite，选择 <code>Extender</code> -&gt; <code>Extensions</code> -&gt; <code>Add</code> -&gt; <code>Select File</code></p>
<p><img src="https://xzfile.aliyuncs.com/media/upload/picture/20240213091404-2de0fef8-ca0d-1.jpg"/></p>
<p>选择你刚才下载的 <code>HaE.jar</code> 文件后，点击 <code>Next</code>，就安装成功了，接下来面板里面会多出来一个 <code>HaE</code> 的标签页</p>
<p><img src="https://xzfile.aliyuncs.com/media/upload/picture/20240213091413-33455632-ca0d-1.jpg"/></p>
<p>默认是会自带一条名为 <code>Email</code> 的正则匹配（用来匹配数据包中是否有符合Email格式的数据，如果有，自动给相应的数据包标记上颜色）</p>
<h2 data-content="1" id="6b6ad882a894eab632f4346d01f355d0">1.2# 如何使用HaE？</h2>
<p>我看很多人写 HaE 的使用，都是草草带过，包括我刚开始使用，也是对它的使用一脸懵逼，那今天我们就好好掰扯掰扯</p>
<p>HaE 主要由三块部分组成：</p>
<ul>
<li>Rules（规则信息管理）：管理匹配特定信息的正则表达式</li>
<li>Config（配置信息管理）：配置文件和忽略后缀名的管理</li>
<li>Databoard（数据集合面板）：对匹配到的信息进行集中查询和管理</li>
</ul>
<p>先说 <code>Rules</code> 规则信息管理，我们点击 <code>Add</code> ，界面如下：</p>
<p><img src="https://xzfile.aliyuncs.com/media/upload/picture/20240213091423-38d2164e-ca0d-1.jpg"/></p>
<p>通过左侧的三个按钮 <code>Add</code>/<code>Edit</code>/<code>Remove</code> 可以对正则条目进行添加、编辑、删除<br/>
在点击 <code>Add</code> 添加后，会弹出一个窗口，填写信息如下：</p>
<ul>
<li>Name：规则名字，建议啥规则就起啥名，后期不会搞混</li>
<li>Regex：正则匹配式，填入需要匹配数据的正则表达式【由于Java正则表达式的库并没有Python的优雅或方便，在使用正则的，HaE要求使用者必须使用 <code>()</code> 将所需提取的表达式内容包含；例如你要匹配一个Shiro应用的响应报文，正常匹配规则为 <code>rememberMe=delete</code>，如果你要提取这段内容的话就需要变成<code>(rememberMe=delete)</code>】</li>
<li>Color：颜色，选择匹配成功的数据包条目显示的颜色</li>
<li>Scope：匹配数据包的哪部分内容，<code>header</code> 就是数据包头部，<code>body</code> 就是数据包实体内容，<code>response</code> 就是响应数据包，<code>request</code> 就是请求数据包</li>
<li>Engine：正则引擎，<code>NFA</code> 和 <code>DFA</code>的具体信息可看这篇文章： <a href="https://blog.csdn.net/weixin_43541528/article/details/123790687" target="_blank">https://blog.csdn.net/weixin_43541528/article/details/123790687</a> </li>
<li>Sensitive：该正则匹配式是否对匹配的数据大小写敏感</li>
</ul>
<p>再说 <code>Config</code> 配置信息管理，界面如下：</p>
<p><img src="https://xzfile.aliyuncs.com/media/upload/picture/20240213091444-45ab9d22-ca0d-1.jpg"/></p>
<p>主要是两条内容：</p>
<ul>
<li>Config Path：配置文件的存储路径（一般不需要改）</li>
<li>Exclude Suffix：排除后缀，对相关后缀名的数据内容进行排除</li>
</ul>
<p>接着说 <code>Databoard</code> 数据集合面板，界面如下：</p>
<p><img src="https://xzfile.aliyuncs.com/media/upload/picture/20240213091453-4aeab0c0-ca0d-1.jpg"/></p>
<p>当 <code>HaE</code> 插件捕获到匹配正则表达式的数据包后，可以在 <code>Databoard</code> 数据集合面板里面直接查询捕获到的相关数据内容，省去一个个翻找数据包内容的烦恼</p>
<h1 data-content="1" id="7ec7a35ae506ec0ac2ca8a793af70918">2# 为AccessKey补充HaE规则</h1>
<p>之前我在 <code>TWiki</code> 上发表过一篇文章： <a href="https://wiki.teamssix.com/CloudService/more/" target="_blank">云业务 AccessKey 标识特征整理</a><br/>
该文章获得了不少朋友的关注，具体可以点击以上链接查看</p>
<p>但我在文章里面的正则表达式，无法直接用在 <code>HaE</code> 插件当中<br/>
和 <code>HaE</code> 插件的开发者 <code>@key</code> 师傅沟通过后，我明白了问题所在<br/>
和黑暗的大门内部群的 <code>@sky</code> 师傅研究了一下，把完善好的正则规则放出来：</p>
<h2 data-content="1" id="c4c9ccdff5df82158096db6a37e787c1">2.1# 亚马逊云</h2>
<div class="highlight"><pre><span></span><span class="p">(</span><span class="n">AKIA</span><span class="p">[</span><span class="n">A</span><span class="o">-</span><span class="n">Za</span><span class="o">-</span><span class="n">z0</span><span class="o">-</span><span class="mi">9</span><span class="p">]{</span><span class="mi">16</span><span class="p">})</span>
</pre></div>
<h2 data-content="1" id="416f97200c6c34c32adee7a7c52a5637">2.2# Google Cloud</h2>
<div class="highlight"><pre><span></span><span class="p">(</span><span class="n">GOOG</span><span class="p">[</span><span class="err">\</span><span class="n">w</span><span class="err">\</span><span class="n">W</span><span class="p">]{</span><span class="mi">10</span><span class="p">,</span><span class="mi">30</span><span class="p">})</span>
</pre></div>
<h2 data-content="1" id="2cb964d3fe1c62db1c2cb43c3e75d31b">2.3# Microsoft Azure</h2>
<div class="highlight"><pre><span></span><span class="p">(</span><span class="n">AZ</span><span class="p">[</span><span class="n">A</span><span class="o">-</span><span class="n">Za</span><span class="o">-</span><span class="n">z0</span><span class="o">-</span><span class="mi">9</span><span class="p">]{</span><span class="mi">34</span><span class="p">,</span><span class="mi">40</span><span class="p">}</span><span class="err">$</span><span class="p">)</span>
</pre></div>
<h2 data-content="1" id="6d49557c5f343b62b9e0d8a04cfda2cd">2.4# IBM Cloud</h2>
<div class="highlight"><pre><span></span><span class="p">(</span><span class="n">IBM</span><span class="p">[</span><span class="n">A</span><span class="o">-</span><span class="n">Za</span><span class="o">-</span><span class="n">z0</span><span class="o">-</span><span class="mi">9</span><span class="p">]{</span><span class="mi">10</span><span class="p">,</span><span class="mi">40</span><span class="p">})</span>
</pre></div>
<p>或者是以下规则：</p>
<div class="highlight"><pre><span></span><span class="p">([</span><span class="n">a</span><span class="o">-</span><span class="n">zA</span><span class="o">-</span><span class="n">Z0</span><span class="o">-</span><span class="mi">9</span><span class="p">]{</span><span class="mi">8</span><span class="p">}(</span><span class="o">-</span><span class="p">[</span><span class="n">a</span><span class="o">-</span><span class="n">zA</span><span class="o">-</span><span class="n">Z0</span><span class="o">-</span><span class="mi">9</span><span class="p">]{</span><span class="mi">4</span><span class="p">}){</span><span class="mi">3</span><span class="p">}</span><span class="o">-</span><span class="p">[</span><span class="n">a</span><span class="o">-</span><span class="n">zA</span><span class="o">-</span><span class="n">Z0</span><span class="o">-</span><span class="mi">9</span><span class="p">]{</span><span class="mi">12</span><span class="p">}</span><span class="err">$</span><span class="p">)</span>
</pre></div>
<h2 data-content="1" id="36e3473405c4a9e3f08c62c2bc8d122f">2.5# Oracle Cloud</h2>
<div class="highlight"><pre><span></span><span class="p">(</span><span class="n">OCID</span><span class="p">[</span><span class="n">A</span><span class="o">-</span><span class="n">Za</span><span class="o">-</span><span class="n">z0</span><span class="o">-</span><span class="mi">9</span><span class="p">]{</span><span class="mi">10</span><span class="p">,</span><span class="mi">40</span><span class="p">})</span>
</pre></div>
<h2 data-content="1" id="03eb8d12b0e9a16c98655bdb55389357">2.6# 阿里云</h2>
<div class="highlight"><pre><span></span><span class="p">(</span><span class="n">LTAI</span><span class="p">[</span><span class="n">A</span><span class="o">-</span><span class="n">Za</span><span class="o">-</span><span class="n">z0</span><span class="o">-</span><span class="mi">9</span><span class="p">]{</span><span class="mi">12</span><span class="p">,</span><span class="mi">20</span><span class="p">})</span>
</pre></div>
<h2 data-content="1" id="b19c03a5c799a4fafcd737da8a6b6886">2.7# 腾讯云</h2>
<div class="highlight"><pre><span></span><span class="p">(</span><span class="n">AKID</span><span class="p">[</span><span class="n">A</span><span class="o">-</span><span class="n">Za</span><span class="o">-</span><span class="n">z0</span><span class="o">-</span><span class="mi">9</span><span class="p">]{</span><span class="mi">13</span><span class="p">,</span><span class="mi">20</span><span class="p">})</span>
</pre></div>
<h2 data-content="1" id="ea3d08628f20fff96272cb5023dc6f35">2.8# 华为云</h2>
<div class="highlight"><pre><span></span><span class="p">(</span><span class="n">AK</span><span class="p">[</span><span class="err">\</span><span class="n">w</span><span class="err">\</span><span class="n">W</span><span class="p">]{</span><span class="mi">10</span><span class="p">,</span><span class="mi">62</span><span class="p">})</span>
</pre></div>
<p>或者是以下规则：</p>
<div class="highlight"><pre><span></span><span class="p">([</span><span class="n">A</span><span class="o">-</span><span class="n">Z0</span><span class="o">-</span><span class="mi">9</span><span class="p">]{</span><span class="mi">20</span><span class="p">}</span><span class="err">$</span><span class="p">)</span>
</pre></div>
<h2 data-content="1" id="881d89e798afb61c002fe33fce11437d">2.9# 百度云</h2>
<div class="highlight"><pre><span></span><span class="p">(</span><span class="n">AK</span><span class="p">[</span><span class="n">A</span><span class="o">-</span><span class="n">Za</span><span class="o">-</span><span class="n">z0</span><span class="o">-</span><span class="mi">9</span><span class="p">]{</span><span class="mi">10</span><span class="p">,</span><span class="mi">40</span><span class="p">})</span>
</pre></div>
<h2 data-content="1" id="6042ccf999d45639062eae263aaf594e">2.10# 京东云</h2>
<div class="highlight"><pre><span></span><span class="p">(</span><span class="n">JDC_</span><span class="p">[</span><span class="n">A</span><span class="o">-</span><span class="n">Z0</span><span class="o">-</span><span class="mi">9</span><span class="p">]{</span><span class="mi">28</span><span class="p">,</span><span class="mi">32</span><span class="p">})</span>
</pre></div>
<h2 data-content="1" id="6f653fef3324f870c4b11e841ed0efab">字节跳动火山引擎</h2>
<div class="highlight"><pre><span></span><span class="p">(</span><span class="n">AKLT</span><span class="p">[</span><span class="n">a</span><span class="o">-</span><span class="n">zA</span><span class="o">-</span><span class="n">Z0</span><span class="o">-</span><span class="mi">9</span><span class="o">-</span><span class="n">_</span><span class="p">]{</span><span class="mi">0</span><span class="p">,</span><span class="mi">252</span><span class="p">})</span>
</pre></div>
<h2 data-content="1" id="2306f6042fb33e9b8ede664cd453c983">2.11# UCloud</h2>
<div class="highlight"><pre><span></span><span class="p">(</span><span class="n">UC</span><span class="p">[</span><span class="n">A</span><span class="o">-</span><span class="n">Za</span><span class="o">-</span><span class="n">z0</span><span class="o">-</span><span class="mi">9</span><span class="p">]{</span><span class="mi">10</span><span class="p">,</span><span class="mi">40</span><span class="p">})</span>
</pre></div>
<h2 data-content="1" id="d048be2ea4b8e3f56fffa8a0d76d5efb">2.12# 青云</h2>
<div class="highlight"><pre><span></span><span class="p">(</span><span class="n">QY</span><span class="p">[</span><span class="n">A</span><span class="o">-</span><span class="n">Za</span><span class="o">-</span><span class="n">z0</span><span class="o">-</span><span class="mi">9</span><span class="p">]{</span><span class="mi">10</span><span class="p">,</span><span class="mi">40</span><span class="p">})</span>
</pre></div>
<h2 data-content="1" id="eec60fe9039f1eb80a8380d403e52f77">2.13# 金山云</h2>
<div class="highlight"><pre><span></span><span class="p">(</span><span class="n">AKLT</span><span class="p">[</span><span class="n">a</span><span class="o">-</span><span class="n">zA</span><span class="o">-</span><span class="n">Z0</span><span class="o">-</span><span class="mi">9</span><span class="o">-</span><span class="n">_</span><span class="p">]{</span><span class="mi">16</span><span class="p">,</span><span class="mi">28</span><span class="p">})</span>
</pre></div>
<h2 data-content="1" id="fa79a68f31591e2a84e6184ad994ebf4">2.14# 联通云</h2>
<div class="highlight"><pre><span></span><span class="p">(</span><span class="n">LTC</span><span class="p">[</span><span class="n">A</span><span class="o">-</span><span class="n">Za</span><span class="o">-</span><span class="n">z0</span><span class="o">-</span><span class="mi">9</span><span class="p">]{</span><span class="mi">10</span><span class="p">,</span><span class="mi">60</span><span class="p">})</span>
</pre></div>
<h2 data-content="1" id="33501c168e74c4f38fcf4a2f8e138bac">2.15# 移动云</h2>
<div class="highlight"><pre><span></span><span class="p">(</span><span class="n">YD</span><span class="p">[</span><span class="n">A</span><span class="o">-</span><span class="n">Za</span><span class="o">-</span><span class="n">z0</span><span class="o">-</span><span class="mi">9</span><span class="p">]{</span><span class="mi">10</span><span class="p">,</span><span class="mi">60</span><span class="p">})</span>
</pre></div>
<h2 data-content="1" id="529dabb914e997c4676db44a3d6c98e9">2.16# 电信云</h2>
<div class="highlight"><pre><span></span><span class="p">(</span><span class="n">CTC</span><span class="p">[</span><span class="n">A</span><span class="o">-</span><span class="n">Za</span><span class="o">-</span><span class="n">z0</span><span class="o">-</span><span class="mi">9</span><span class="p">]{</span><span class="mi">10</span><span class="p">,</span><span class="mi">60</span><span class="p">})</span>
</pre></div>
<h2 data-content="1" id="108aa916ddee3920a4b4b0a9664fb06b">2.17# 一云通</h2>
<div class="highlight"><pre><span></span><span class="p">(</span><span class="n">YYT</span><span class="p">[</span><span class="n">A</span><span class="o">-</span><span class="n">Za</span><span class="o">-</span><span class="n">z0</span><span class="o">-</span><span class="mi">9</span><span class="p">]{</span><span class="mi">10</span><span class="p">,</span><span class="mi">60</span><span class="p">})</span>
</pre></div>
<h2 data-content="1" id="2a38880010b3389e30f2677e0c8efad6">2.18# 用友云</h2>
<div class="highlight"><pre><span></span><span class="p">(</span><span class="n">YY</span><span class="p">[</span><span class="n">A</span><span class="o">-</span><span class="n">Za</span><span class="o">-</span><span class="n">z0</span><span class="o">-</span><span class="mi">9</span><span class="p">]{</span><span class="mi">10</span><span class="p">,</span><span class="mi">40</span><span class="p">})</span>
</pre></div>
<h2 data-content="1" id="8a01f713ddb7673db336840774831b32">2.19# 南大通用云</h2>
<div class="highlight"><pre><span></span><span class="p">(</span><span class="n">CI</span><span class="p">[</span><span class="n">A</span><span class="o">-</span><span class="n">Za</span><span class="o">-</span><span class="n">z0</span><span class="o">-</span><span class="mi">9</span><span class="p">]{</span><span class="mi">10</span><span class="p">,</span><span class="mi">40</span><span class="p">})</span>
</pre></div>
<h2 data-content="1" id="c36d4839102d2f728c7874aebd382154">2.20# G-Core Labs</h2>
<div class="highlight"><pre><span></span><span class="p">(</span><span class="n">gcore</span><span class="p">[</span><span class="n">A</span><span class="o">-</span><span class="n">Za</span><span class="o">-</span><span class="n">z0</span><span class="o">-</span><span class="mi">9</span><span class="p">]{</span><span class="mi">10</span><span class="p">,</span><span class="mi">30</span><span class="p">})</span>
</pre></div>
<p>你以为这样就结束里了吗？NoNoNo</p>
<h1 data-content="1" id="0d4deabb38b728913fb54bb4746e52a8">3# 三条影响你一生的HaE规则</h1>
<p>上面只是开胃小菜，和朋友 <code>@NaTsUk0</code> 一起研究了一下，又写出三条集合的规则：</p>
<p>AccessKey泄露匹配式1：</p>
<div class="highlight"><pre><span></span><span class="p">((</span><span class="err">?</span><span class="n">i</span><span class="p">)((</span><span class="n">access_key</span><span class="o">|</span><span class="n">access_token</span><span class="o">|</span><span class="n">admin_pass</span><span class="o">|</span><span class="n">admin_user</span><span class="o">|</span><span class="n">algolia_admin_key</span><span class="o">|</span><span class="n">algolia_api_key</span><span class="o">|</span><span class="n">alias_pass</span><span class="o">|</span><span class="n">alicloud_access_key</span><span class="o">|</span><span class="n">amazon_secret_access_key</span><span class="o">|</span><span class="n">amazonaws</span><span class="o">|</span><span class="n">ansible_vault_password</span><span class="o">|</span><span class="n">aos_key</span><span class="o">|</span><span class="n">api_key</span><span class="o">|</span><span class="n">api_key_secret</span><span class="o">|</span><span class="n">api_key_sid</span><span class="o">|</span><span class="n">api_secret</span><span class="o">|</span><span class="n">api</span><span class="o">.</span><span class="n">googlemaps</span> <span class="n">AIza</span><span class="o">|</span><span class="n">apidocs</span><span class="o">|</span><span class="n">apikey</span><span class="o">|</span><span class="n">apiSecret</span><span class="o">|</span><span class="n">app_debug</span><span class="o">|</span><span class="n">app_id</span><span class="o">|</span><span class="n">app_key</span><span class="o">|</span><span class="n">app_log_level</span><span class="o">|</span><span class="n">app_secret</span><span class="o">|</span><span class="n">appkey</span><span class="o">|</span><span class="n">appkeysecret</span><span class="o">|</span><span class="n">application_key</span><span class="o">|</span><span class="n">appsecret</span><span class="o">|</span><span class="n">appspot</span><span class="o">|</span><span class="n">auth_token</span><span class="o">|</span><span class="n">authorizationToken</span><span class="o">|</span><span class="n">authsecret</span><span class="o">|</span><span class="n">aws_access</span><span class="o">|</span><span class="n">aws_access_key_id</span><span class="o">|</span><span class="n">aws_bucket</span><span class="o">|</span><span class="n">aws_key</span><span class="o">|</span><span class="n">aws_secret</span><span class="o">|</span><span class="n">aws_secret_key</span><span class="o">|</span><span class="n">aws_token</span><span class="o">|</span><span class="n">AWSSecretKey</span><span class="o">|</span><span class="n">b2_app_key</span><span class="o">|</span><span class="n">bashrc</span> <span class="n">password</span><span class="o">|</span><span class="n">bintray_apikey</span><span class="o">|</span><span class="n">bintray_gpg_password</span><span class="o">|</span><span class="n">bintray_key</span><span class="o">|</span><span class="n">bintraykey</span><span class="o">|</span><span class="n">bluemix_api_key</span><span class="o">|</span><span class="n">bluemix_pass</span><span class="o">|</span><span class="n">browserstack_access_key</span><span class="o">|</span><span class="n">bucket_password</span><span class="o">|</span><span class="n">bucketeer_aws_access_key_id</span><span class="o">|</span><span class="n">bucketeer_aws_secret_access_key</span><span class="o">|</span><span class="n">built_branch_deploy_key</span><span class="o">|</span><span class="n">bx_password</span><span class="o">|</span><span class="n">cache_driver</span><span class="o">|</span><span class="n">cache_s3_secret_key</span><span class="o">|</span><span class="n">cattle_access_key</span><span class="o">|</span><span class="n">cattle_secret_key</span><span class="o">|</span><span class="n">certificate_password</span><span class="o">|</span><span class="n">ci_deploy_password</span><span class="o">|</span><span class="n">client_secret</span><span class="o">|</span><span class="n">client_zpk_secret_key</span><span class="o">|</span><span class="n">clojars_password</span><span class="o">|</span><span class="n">cloud_api_key</span><span class="o">|</span><span class="n">cloud_watch_aws_access_key</span><span class="o">|</span><span class="n">cloudant_password</span><span class="o">|</span><span class="n">cloudflare_api_key</span><span class="o">|</span><span class="n">cloudflare_auth_key</span><span class="o">|</span><span class="n">cloudinary_api_secret</span><span class="o">|</span><span class="n">cloudinary_name</span><span class="o">|</span><span class="n">codecov_token</span><span class="o">|</span><span class="n">config</span><span class="o">|</span><span class="n">conn</span><span class="o">.</span><span class="n">login</span><span class="o">|</span><span class="n">connectionstring</span><span class="o">|</span><span class="n">consumer_key</span><span class="o">|</span><span class="n">consumer_secret</span><span class="o">|</span><span class="n">credentials</span><span class="o">|</span><span class="n">cypress_record_key</span><span class="o">|</span><span class="n">database_password</span><span class="o">|</span><span class="n">database_schema_test</span><span class="o">|</span><span class="n">datadog_api_key</span><span class="o">|</span><span class="n">datadog_app_key</span><span class="o">|</span><span class="n">db_password</span><span class="o">|</span><span class="n">db_server</span><span class="o">|</span><span class="n">db_username</span><span class="o">|</span><span class="n">dbpasswd</span><span class="o">|</span><span class="n">dbpassword</span><span class="o">|</span><span class="n">dbuser</span><span class="o">|</span><span class="n">deploy_password</span><span class="o">|</span><span class="n">digitalocean_ssh_key_body</span><span class="o">|</span><span class="n">digitalocean_ssh_key_ids</span><span class="o">|</span><span class="n">docker_hub_password</span><span class="o">|</span><span class="n">docker_key</span><span class="o">|</span><span class="n">docker_pass</span><span class="o">|</span><span class="n">docker_passwd</span><span class="o">|</span><span class="n">docker_password</span><span class="o">|</span><span class="n">dockerhub_password</span><span class="o">|</span><span class="n">dockerhubpassword</span><span class="o">|</span><span class="n">dot</span><span class="o">-</span><span class="n">files</span><span class="o">|</span><span class="n">dotfiles</span><span class="o">|</span><span class="n">droplet_travis_password</span><span class="o">|</span><span class="n">dynamoaccesskeyid</span><span class="o">|</span><span class="n">dynamosecretaccesskey</span><span class="o">|</span><span class="n">elastica_host</span><span class="o">|</span><span class="n">elastica_port</span><span class="o">|</span><span class="n">elasticsearch_password</span><span class="o">|</span><span class="n">encryption_key</span><span class="o">|</span><span class="n">encryption_password</span><span class="o">|</span><span class="n">env</span><span class="o">.</span><span class="n">heroku_api_key</span><span class="o">|</span><span class="n">env</span><span class="o">.</span><span class="n">sonatype_password</span><span class="o">|</span><span class="n">eureka</span><span class="o">.</span><span class="n">awssecretkey</span><span class="p">)[</span><span class="n">a</span><span class="o">-</span><span class="n">z0</span><span class="o">-</span><span class="mi">9</span><span class="n">_</span> <span class="o">.</span>\<span class="o">-</span><span class="p">,]{</span><span class="mi">0</span><span class="p">,</span><span class="mi">25</span><span class="p">})(</span><span class="o">=|&gt;|</span><span class="p">:</span><span class="o">=|</span>\<span class="o">|</span>\<span class="o">|</span><span class="p">:</span><span class="o">|&lt;=|=&gt;|</span><span class="p">:)</span><span class="o">.</span><span class="p">{</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">}[</span><span class="s1">'</span><span class="se">\"</span><span class="s1">\ ]([0-9a-zA-Z\-_=]{8,64})['</span>\<span class="s2">"\ ])</span>
</pre></div>
<p>AccessKey泄露匹配式2：</p>
<div class="highlight"><pre><span></span><span class="p">([</span><span class="s1">'</span><span class="se">\"</span><span class="s1">\ ](GOOG[\w\W]{10,30})['</span>\<span class="s2">"\ ]|(['</span><span class="se">\"</span><span class="s2">\ ]AZ[A-Za-z0-9]{34,40}['</span><span class="se">\"</span><span class="s2">\ ])|(['</span><span class="se">\"</span><span class="s2">\ ]AKID[A-Za-z0-9]{13,20}['</span><span class="se">\"</span><span class="s2">\ ])|(['</span><span class="se">\"</span><span class="s2">\ ]AKIA[A-Za-z0-9]{16}['</span><span class="se">\"</span><span class="s2">\ ])|(['</span><span class="se">\"</span><span class="s2">\ ][a-zA-Z0-9]{8}(-[a-zA-Z0-9]{4}){3}-[a-zA-Z0-9]{12}['</span><span class="se">\"</span><span class="s2">\ ])|(['</span><span class="se">\"</span><span class="s2">\ ]OCID[A-Za-z0-9]{10,40}['</span><span class="se">\"</span><span class="s2">\ ])|(['</span><span class="se">\"</span><span class="s2">\ ]LTAI[A-Za-z0-9]{12,20}['</span><span class="se">\"</span><span class="s2">\ ])|(['</span><span class="se">\"</span><span class="s2">\ ][A-Z0-9]{20}$['</span><span class="se">\"</span><span class="s2">\ ])|(['</span><span class="se">\"</span><span class="s2">\ ]JDC_[A-Z0-9]{28,32}['</span><span class="se">\"</span><span class="s2">\ ])|(['</span><span class="se">\"</span><span class="s2">\ ]AK[A-Za-z0-9]{10,40}['</span><span class="se">\"</span><span class="s2">\ ])|(['</span><span class="se">\"</span><span class="s2">\ ]UC[A-Za-z0-9]{10,40}['</span><span class="se">\"</span><span class="s2">\ ])|(['</span><span class="se">\"</span><span class="s2">\ ]QY[A-Za-z0-9]{10,40}['</span><span class="se">\"</span><span class="s2">\ ])|(['</span><span class="se">\"</span><span class="s2">\ ]AKLT[a-zA-Z0-9-_]{16,28}['</span><span class="se">\"</span><span class="s2">\ ])|(['</span><span class="se">\"</span><span class="s2">\ ]LTC[A-Za-z0-9]{10,60}['</span><span class="se">\"</span><span class="s2">\ ])|(['</span><span class="se">\"</span><span class="s2">\ ]YD[A-Za-z0-9]{10,60}['</span><span class="se">\"</span><span class="s2">\ ])|(['</span><span class="se">\"</span><span class="s2">\ ]CTC[A-Za-z0-9]{10,60}['</span><span class="se">\"</span><span class="s2">\ ])|(['</span><span class="se">\"</span><span class="s2">\ ]YYT[A-Za-z0-9]{10,60}['</span><span class="se">\"</span><span class="s2">\ ])|(['</span><span class="se">\"</span><span class="s2">\ ]YY[A-Za-z0-9]{10,40}['</span><span class="se">\"</span><span class="s2">\ ])|(['</span><span class="se">\"</span><span class="s2">\ ]CI[A-Za-z0-9]{10,40}['</span><span class="se">\"</span><span class="s2">\ ])|(['</span><span class="se">\"</span><span class="s2">\ ]gcore[A-Za-z0-9]{10,30}['</span><span class="se">\"</span><span class="s2">\ ]))</span>
</pre></div>
<p>敏感信息泄漏匹配式：</p>
<div class="highlight"><pre><span></span><span class="p">((</span><span class="err">?</span><span class="n">i</span><span class="p">)((</span><span class="n">access_key</span><span class="o">|</span><span class="n">appsecret</span><span class="o">|</span><span class="n">app_secret</span><span class="o">|</span><span class="n">access_token</span><span class="o">|</span><span class="n">password</span><span class="o">|</span><span class="n">secretkey</span><span class="o">|</span><span class="n">accesskey</span><span class="o">|</span><span class="n">accesskeyid</span><span class="o">|</span><span class="n">accesskeysecret</span><span class="o">|</span><span class="n">secret_key</span><span class="o">|</span><span class="n">pwd</span><span class="o">|</span><span class="n">test_user</span><span class="o">|</span><span class="n">admin_pass</span><span class="o">|</span><span class="n">admin_user</span><span class="o">|</span><span class="n">algolia_admin_key</span><span class="o">|</span><span class="n">algolia_api_key</span><span class="o">|</span><span class="n">alias_pass</span><span class="o">|</span><span class="n">alicloud_access_key</span><span class="o">|</span><span class="n">amazon_secret_access_key</span><span class="o">|</span><span class="n">amazonaws</span><span class="o">|</span><span class="n">ansible_vault_password</span><span class="o">|</span><span class="n">aos_key</span><span class="o">|</span><span class="n">api_key</span><span class="o">|</span><span class="n">api_key_secret</span><span class="o">|</span><span class="n">api_key_sid</span><span class="o">|</span><span class="n">api_secret</span><span class="o">|</span><span class="n">api</span><span class="o">.</span><span class="n">googlemaps</span> <span class="n">AIza</span><span class="o">|</span><span class="n">apidocs</span><span class="o">|</span><span class="n">apikey</span><span class="o">|</span><span class="n">apiSecret</span><span class="o">|</span><span class="n">app_debug</span><span class="o">|</span><span class="n">app_id</span><span class="o">|</span><span class="n">app_key</span><span class="o">|</span><span class="n">app_log_level</span><span class="o">|</span><span class="n">app_secret</span><span class="o">|</span><span class="n">appkey</span><span class="o">|</span><span class="n">appkeysecret</span><span class="o">|</span><span class="n">application_key</span><span class="o">|</span><span class="n">appsecret</span><span class="o">|</span><span class="n">appspot</span><span class="o">|</span><span class="n">auth_token</span><span class="o">|</span><span class="n">authorizationToken</span><span class="o">|</span><span class="n">authsecret</span><span class="o">|</span><span class="n">aws_access</span><span class="o">|</span><span class="n">aws_access_key_id</span><span class="o">|</span><span class="n">aws_bucket</span><span class="o">|</span><span class="n">aws_key</span><span class="o">|</span><span class="n">aws_secret</span><span class="o">|</span><span class="n">aws_secret_key</span><span class="o">|</span><span class="n">aws_token</span><span class="o">|</span><span class="n">AWSSecretKey</span><span class="o">|</span><span class="n">b2_app_key</span><span class="o">|</span><span class="n">bashrc</span> <span class="n">password</span><span class="o">|</span><span class="n">bintray_apikey</span><span class="o">|</span><span class="n">bintray_gpg_password</span><span class="o">|</span><span class="n">bintray_key</span><span class="o">|</span><span class="n">bintraykey</span><span class="o">|</span><span class="n">bluemix_api_key</span><span class="o">|</span><span class="n">bluemix_pass</span><span class="o">|</span><span class="n">browserstack_access_key</span><span class="o">|</span><span class="n">bucket_password</span><span class="o">|</span><span class="n">bucketeer_aws_access_key_id</span><span class="o">|</span><span class="n">bucketeer_aws_secret_access_key</span><span class="o">|</span><span class="n">built_branch_deploy_key</span><span class="o">|</span><span class="n">bx_password</span><span class="o">|</span><span class="n">cache_driver</span><span class="o">|</span><span class="n">cache_s3_secret_key</span><span class="o">|</span><span class="n">cattle_access_key</span><span class="o">|</span><span class="n">cattle_secret_key</span><span class="o">|</span><span class="n">certificate_password</span><span class="o">|</span><span class="n">ci_deploy_password</span><span class="o">|</span><span class="n">client_secret</span><span class="o">|</span><span class="n">client_zpk_secret_key</span><span class="o">|</span><span class="n">clojars_password</span><span class="o">|</span><span class="n">cloud_api_key</span><span class="o">|</span><span class="n">cloud_watch_aws_access_key</span><span class="o">|</span><span class="n">cloudant_password</span><span class="o">|</span><span class="n">cloudflare_api_key</span><span class="o">|</span><span class="n">cloudflare_auth_key</span><span class="o">|</span><span class="n">cloudinary_api_secret</span><span class="o">|</span><span class="n">cloudinary_name</span><span class="o">|</span><span class="n">codecov_token</span><span class="o">|</span><span class="n">config</span><span class="o">|</span><span class="n">conn</span><span class="o">.</span><span class="n">login</span><span class="o">|</span><span class="n">connectionstring</span><span class="o">|</span><span class="n">consumer_key</span><span class="o">|</span><span class="n">consumer_secret</span><span class="o">|</span><span class="n">credentials</span><span class="o">|</span><span class="n">cypress_record_key</span><span class="o">|</span><span class="n">database_password</span><span class="o">|</span><span class="n">database_schema_test</span><span class="o">|</span><span class="n">datadog_api_key</span><span class="o">|</span><span class="n">datadog_app_key</span><span class="o">|</span><span class="n">db_password</span><span class="o">|</span><span class="n">db_server</span><span class="o">|</span><span class="n">db_username</span><span class="o">|</span><span class="n">dbpasswd</span><span class="o">|</span><span class="n">dbpassword</span><span class="o">|</span><span class="n">dbuser</span><span class="o">|</span><span class="n">deploy_password</span><span class="o">|</span><span class="n">digitalocean_ssh_key_body</span><span class="o">|</span><span class="n">digitalocean_ssh_key_ids</span><span class="o">|</span><span class="n">docker_hub_password</span><span class="o">|</span><span class="n">docker_key</span><span class="o">|</span><span class="n">docker_pass</span><span class="o">|</span><span class="n">docker_passwd</span><span class="o">|</span><span class="n">docker_password</span><span class="o">|</span><span class="n">dockerhub_password</span><span class="o">|</span><span class="n">dockerhubpassword</span><span class="o">|</span><span class="n">dot</span><span class="o">-</span><span class="n">files</span><span class="o">|</span><span class="n">dotfiles</span><span class="o">|</span><span class="n">droplet_travis_password</span><span class="o">|</span><span class="n">dynamoaccesskeyid</span><span class="o">|</span><span class="n">dynamosecretaccesskey</span><span class="o">|</span><span class="n">elastica_host</span><span class="o">|</span><span class="n">elastica_port</span><span class="o">|</span><span class="n">elasticsearch_password</span><span class="o">|</span><span class="n">encryption_key</span><span class="o">|</span><span class="n">encryption_password</span><span class="o">|</span><span class="n">env</span><span class="o">.</span><span class="n">heroku_api_key</span><span class="o">|</span><span class="n">env</span><span class="o">.</span><span class="n">sonatype_password</span><span class="o">|</span><span class="n">eureka</span><span class="o">.</span><span class="n">awssecretkey</span><span class="p">)[</span><span class="n">a</span><span class="o">-</span><span class="n">z0</span><span class="o">-</span><span class="mi">9</span><span class="n">_</span><span class="o">.</span><span class="p">]{</span><span class="mi">0</span><span class="p">,</span><span class="mi">25</span><span class="p">})(</span><span class="o">=|&gt;|</span><span class="p">:</span><span class="o">=|</span><span class="p">:</span><span class="o">|&lt;=|=&gt;|</span><span class="p">:)</span><span class="o">.</span><span class="p">{</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">}[</span><span class="s1">'</span><span class="se">\"</span><span class="s1">\ ]([0-9a-zA-Z-_=]{12,64})['</span>\<span class="s2">"\ ])</span>
</pre></div>
<p>希望这三条 <code>HaE</code> 规则能帮助到你~</p>
<h1 data-content="1" id="15c67ed4a6e7141103a23e621f36c87d">4# 总结</h1>
<p>随着企业上云和云业务的上升趋势和业务指向性，在日常的渗透测试过程中，Web暴露面的敏感信息泄露频率和利用姿势越来越多，利用 <code>HaE</code> 插件，可快速从BurpSuite接受的数据包当中匹配出对应的敏感信息，能更快将目标“斩于马下”</p>
<p>本篇主要分享了 <code>HaE</code> 插件的使用和相关规则的拓展，如果师傅们有更好、更新的 <code>HaE</code> 插件规则，欢迎和我交流和学习哈哈~</p>
</div>
</div>